<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>RedstoneDist</title>
  
  
  <link href="https://redstone6835.github.io/atom.xml" rel="self"/>
  
  <link href="https://redstone6835.github.io/"/>
  <updated>2025-11-18T08:23:24.417Z</updated>
  <id>https://redstone6835.github.io/</id>
  
  <author>
    <name>Redstone6835</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ·±å…¥æµ…å‡ºï¼šç¬¬ä¹ç« </title>
    <link href="https://redstone6835.github.io/2025/11/18/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%EF%BC%9A%E7%AC%AC%E4%B9%9D%E7%AB%A0/"/>
    <id>https://redstone6835.github.io/2025/11/18/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA%EF%BC%9A%E7%AC%AC%E4%B9%9D%E7%AB%A0/</id>
    <published>2025-11-18T08:22:25.000Z</published>
    <updated>2025-11-18T08:23:24.417Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h1><p>å¾…æ’åºæ•°ç»„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;<span class="type">int</span>&gt; target = &#123;<span class="number">123</span>, <span class="number">4354</span>, <span class="number">123</span>, <span class="number">454</span>, <span class="number">876</span>, <span class="number">2</span>, <span class="number">5464</span>&#125;;</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h2><p>ä»å¾…æ’åºé˜Ÿåˆ—ä¸­é€‰å‡ºç›®æ ‡å€¼ï¼ˆæœ€å¤§ &#x2F; æœ€å°å€¼ï¼‰ï¼Œæ”¾åœ¨å¾…æ’åºé˜Ÿåˆ—æœ€å‰é¢ï¼Œå¹¶å°†è¯¥å€¼å‰”é™¤å‡ºå¾…æ’åºé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—å‰é¢çš„é˜Ÿåˆ—è¢«è§†ä¸ºå·²æ’åºé˜Ÿåˆ—ï¼›é€’å½’ &#x2F; è¿­ä»£æ‰§è¡Œè¯¥æ“ä½œï¼Œç›´åˆ°å¾…æ’åºé˜Ÿåˆ—é•¿åº¦ä¸º 0ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sort::choose</span><span class="params">(std::vector&lt;T&gt; &amp;arr, Comp cmp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="type">int</span> max = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; arr.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">cmp</span>(arr[j], arr[max])) std::<span class="built_in">swap</span>(arr[j], arr[max]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><p>ä»å¾…æ’åºé˜Ÿåˆ—ä¸­å–ä¸¤ä¸ªç›¸é‚»å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªè¾ƒå¤§ï¼ˆè¾ƒå°ï¼‰ï¼Œäº¤æ¢äºŒè€…ä½ç½®ã€‚é€’å½’ &#x2F; è¿­ä»£æ‰§è¡Œï¼Œç›´åˆ°éå†è‡³æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sort::bubble</span><span class="params">(std::vector&lt;T&gt; &amp;arr, Comp cmp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; arr.<span class="built_in">size</span>() - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">cmp</span>(arr[j], arr[j + <span class="number">1</span>])) &#123;</span><br><span class="line">                std::<span class="built_in">swap</span>(arr[j], arr[j + <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><p>å–å¾…æ’åºé˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ’å…¥è‡³å·²æ’åºé˜Ÿåˆ—çš„æŸä¸¤ä¸ªå…ƒç´ ä¹‹é—´ï¼Œå…¶ä¸­è¿™ä¸¤ä¸ªå…ƒç´ æ»¡è¶³ä¸€ä¸ªå¤§äºç­‰äºç›®æ ‡å…ƒç´ ï¼Œå¦ä¸€ä¸ªå°äºç­‰äºç›®æ ‡å…ƒç´ ï¼Œå¹¶ä»å¾…æ’åºé˜Ÿåˆ—ä¸­å‰”é™¤ç›®æ ‡å…ƒç´ ã€‚é€’å½’ &#x2F; è¿­ä»£æ‰§è¡Œè¯¥æ“ä½œï¼Œç›´è‡³å¾…æ’åºé˜Ÿåˆ—é•¿åº¦ä¸º 0ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sort::insert</span><span class="params">(std::vector&lt;T&gt; &amp;arr, Comp cmp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; arr.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="type">int</span> now = arr[i], j = i - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> ( ; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">cmp</span>(arr[j], now)) arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[j + <span class="number">1</span>] = now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><p>é€’å½’è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ol><li>å–åºåˆ—ä¸­çš„â€œå“¨å…µâ€æ•°<code>pivot</code>ï¼ˆé€šå¸¸ä¸ºä¸­é—´çš„é‚£ä¸ªå€¼ï¼‰</li><li>å°†åºåˆ—ä¸­æ¯”â€œå“¨å…µâ€å°ï¼ˆå¤§ï¼‰çš„å…¨éƒ¨æ”¾åœ¨å…¶å·¦è¾¹ï¼Œåä¹‹æ”¾åœ¨å³è¾¹ï¼›</li><li>å°†å·¦å³ä¸¤ä¸ªåºåˆ—åˆ†åˆ«è§†ä¸ºå­åºåˆ—ï¼Œç»§ç»­é€’å½’è¿›è¡Œè¿™äº›æ“ä½œã€‚</li></ol><p>ç›´åˆ°å­åºåˆ—é•¿åº¦ä¸º 1ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Comp&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sort::quick</span><span class="params">(std::vector&lt;T&gt; &amp;arr, Comp cmp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> s = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">        <span class="type">int</span> pivot = arr[(r + l) / <span class="number">2</span>];</span><br><span class="line">        <span class="type">int</span> i = l, j = r;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="built_in">cmp</span>(arr[i], pivot)) i++;</span><br><span class="line">            <span class="keyword">while</span> (<span class="built_in">cmp</span>(pivot, arr[j])) j--;</span><br><span class="line">            <span class="keyword">if</span> (i &lt;= j) &#123;</span><br><span class="line">                std::<span class="built_in">swap</span>(arr[i], arr[j]);</span><br><span class="line">                i++, j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (i &lt;= j);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r) <span class="built_in">self</span>(self, i, r);</span><br><span class="line">        <span class="keyword">if</span> (l &lt; j) <span class="built_in">self</span>(self, l, j);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">s</span>(s, <span class="number">0</span>, arr.<span class="built_in">size</span>() - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h1><h2 id="ä¹ é¢˜-9-1"><a href="#ä¹ é¢˜-9-1" class="headerlink" title="ä¹ é¢˜ 9 - 1"></a>ä¹ é¢˜ 9 - 1</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, b;</span><br><span class="line">    std::cin &gt;&gt; n &gt;&gt; b;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">h</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) std::cin &gt;&gt; h[i];</span><br><span class="line">    std::<span class="built_in">sort</span>(h.<span class="built_in">begin</span>(), h.<span class="built_in">end</span>(), [](<span class="keyword">auto</span> &amp;a, <span class="keyword">auto</span> &amp;b) &#123; <span class="keyword">return</span> a &gt; b; &#125;);</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( ; i &lt; n; ++i) &#123;</span><br><span class="line">        sum += h[i];</span><br><span class="line">        <span class="keyword">if</span> (sum &gt;= b) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; i + <span class="number">1</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-2"><a href="#ä¹ é¢˜-9-2" class="headerlink" title="ä¹ é¢˜ 9 - 2"></a>ä¹ é¢˜ 9 - 2</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::cin &gt;&gt; n;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) std::cin &gt;&gt; arr[i];</span><br><span class="line">    <span class="type">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> bubble = [&amp;] &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; arr.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; arr.<span class="built_in">size</span>() - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                    std::<span class="built_in">swap</span>(arr[j], arr[j + <span class="number">1</span>]);</span><br><span class="line">                    a++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">bubble</span>();</span><br><span class="line">    std::cout &lt;&lt; a &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-3"><a href="#ä¹ é¢˜-9-3" class="headerlink" title="ä¹ é¢˜ 9 - 3"></a>ä¹ é¢˜ 9 - 3</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::cin &gt;&gt; n;</span><br><span class="line">    <span class="function">std::vector&lt;<span class="type">int</span>&gt; <span class="title">arr</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) std::cin &gt;&gt; arr[i];</span><br><span class="line">    std::set&lt;<span class="type">int</span>&gt; set;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        set.<span class="built_in">insert</span>(std::<span class="built_in">abs</span>(arr[i] - arr[i + <span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (set.<span class="built_in">find</span>(i) == set.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            std::cout &lt;&lt; <span class="string">&quot;Not jolly&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Jolly&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-4"><a href="#ä¹ é¢˜-9-4" class="headerlink" title="ä¹ é¢˜ 9 - 4"></a>ä¹ é¢˜ 9 - 4</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m, n;</span><br><span class="line">    std::cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    std::vector&lt;std::pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; people;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v;</span><br><span class="line">        std::cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        people.<span class="built_in">emplace_back</span>(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    std::<span class="built_in">sort</span>(people.<span class="built_in">begin</span>(), people.<span class="built_in">end</span>(), [](<span class="keyword">auto</span> p1, <span class="keyword">auto</span> p2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p<span class="number">1.</span>second != p<span class="number">2.</span>second) <span class="keyword">return</span> p<span class="number">1.</span>second &gt; p<span class="number">2.</span>second;</span><br><span class="line">        <span class="keyword">return</span> p<span class="number">1.f</span>irst &lt; p<span class="number">2.f</span>irst;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">int</span> zz = std::<span class="built_in">floor</span>(m * <span class="number">1.5</span>);</span><br><span class="line">    <span class="type">int</span> fl = people[zz - <span class="number">1</span>].second;</span><br><span class="line">    <span class="keyword">for</span> ( ; zz &lt; people.<span class="built_in">size</span>(); zz++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (people[zz - <span class="number">1</span>].second != fl) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    zz--;</span><br><span class="line">    std::cout &lt;&lt; people[zz - <span class="number">1</span>].second &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; zz &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; zz; i++) std::cout &lt;&lt; people[i].first &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; people[i].second &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-5"><a href="#ä¹ é¢˜-9-5" class="headerlink" title="ä¹ é¢˜ 9 - 5"></a>ä¹ é¢˜ 9 - 5</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Point</span> &#123;<span class="type">int</span> x; <span class="type">int</span> y; <span class="type">int</span> z;&#125;;</span><br><span class="line">    <span class="function">std::vector&lt;Point&gt; <span class="title">arr</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) std::cin &gt;&gt; arr[i].x &gt;&gt; arr[i].y &gt;&gt; arr[i].z;</span><br><span class="line">    std::<span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), [](<span class="keyword">auto</span> &amp;a, <span class="keyword">auto</span> &amp;b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a.z &lt; b.z;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">double</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> D = [](Point&amp; a, Point&amp; b) &#123;</span><br><span class="line">        <span class="keyword">return</span> std::<span class="built_in">sqrt</span>((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y) + (a.z - b.z) * (a.z - b.z));</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        d += <span class="built_in">D</span>(arr[i], arr[i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    std::cout &lt;&lt; std::fixed &lt;&lt; std::<span class="built_in">setprecision</span>(<span class="number">3</span>) &lt;&lt; d &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-6"><a href="#ä¹ é¢˜-9-6" class="headerlink" title="ä¹ é¢˜ 9 - 6"></a>ä¹ é¢˜ 9 - 6</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Birthday</span> &#123;<span class="type">int</span> year; <span class="type">int</span> month; <span class="type">int</span> day;&#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        std::string name;</span><br><span class="line">        Birthday b;</span><br><span class="line">        <span class="type">int</span> idx;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::vector&lt;Person&gt; <span class="title">people</span><span class="params">(n)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        std::cin &gt;&gt; people[i].name </span><br><span class="line">                 &gt;&gt; people[i].b.year </span><br><span class="line">                 &gt;&gt; people[i].b.month </span><br><span class="line">                 &gt;&gt; people[i].b.day;</span><br><span class="line">        people[i].idx = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    std::<span class="built_in">sort</span>(people.<span class="built_in">begin</span>(), people.<span class="built_in">end</span>(),</span><br><span class="line">        [](<span class="type">const</span> Person &amp;a, <span class="type">const</span> Person &amp;b) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a.b.year != b.b.year) <span class="keyword">return</span> a.b.year &lt; b.b.year;</span><br><span class="line">            <span class="keyword">if</span> (a.b.month != b.b.month) <span class="keyword">return</span> a.b.month &lt; b.b.month;</span><br><span class="line">            <span class="keyword">if</span> (a.b.day != b.b.day) <span class="keyword">return</span> a.b.day &lt; b.b.day;</span><br><span class="line">            <span class="keyword">return</span> a.idx &gt; b.idx;</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;p : people)</span><br><span class="line">        std::cout &lt;&lt; p.name &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä¹ é¢˜-9-7"><a href="#ä¹ é¢˜-9-7" class="headerlink" title="ä¹ é¢˜ 9 - 7"></a>ä¹ é¢˜ 9 - 7</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    std::cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    std::cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::cin &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    <span class="function">std::vector&lt;std::string&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        std::cin &gt;&gt; a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sort</span>(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), [](<span class="type">const</span> std::string &amp;x, <span class="type">const</span> std::string &amp;y) &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y &gt; y + x;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">0</span>] == <span class="string">&quot;0&quot;</span>) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;s : a) std::cout &lt;&lt; s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ’åº&quot;&gt;&lt;a href=&quot;#æ’åº&quot; class=&quot;headerlink&quot; title=&quot;æ’åº&quot;&gt;&lt;/a&gt;æ’åº&lt;/h1&gt;&lt;p&gt;å¾…æ’åºæ•°ç»„ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;</summary>
      
    
    
    
    
    <category term="Algorithm" scheme="https://redstone6835.github.io/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Rust è¯­è¨€ç¼–å†™åŸºäº STM32 çš„æ™ºèƒ½è½¦ç¨‹åº</title>
    <link href="https://redstone6835.github.io/2025/11/16/%E4%BD%BF%E7%94%A8-Rust-%E8%AF%AD%E8%A8%80%E7%BC%96%E5%86%99%E5%9F%BA%E4%BA%8E-STM32-%E7%9A%84%E6%99%BA%E8%83%BD%E8%BD%A6%E7%A8%8B%E5%BA%8F/"/>
    <id>https://redstone6835.github.io/2025/11/16/%E4%BD%BF%E7%94%A8-Rust-%E8%AF%AD%E8%A8%80%E7%BC%96%E5%86%99%E5%9F%BA%E4%BA%8E-STM32-%E7%9A%84%E6%99%BA%E8%83%BD%E8%BD%A6%E7%A8%8B%E5%BA%8F/</id>
    <published>2025-11-15T18:57:31.000Z</published>
    <updated>2025-11-15T18:58:10.919Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡ Blog å°†ç€é‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust è¯­è¨€å·¥å…·é“¾é…ç½® STM32 åµŒå…¥å¼å¼€å‘ç¯å¢ƒï¼Œå¹¶å°†æŒ‡å¯¼æ‚¨ä½¿ç”¨ Rust ç¼–å†™ä¸€ä¸ªç®€æ˜“çš„ã€åŸºäºç”µç£ä¼ æ„Ÿå™¨å¾ªè¿¹çš„æ™ºèƒ½è½¦ç¨‹åºã€‚</p><blockquote><p>ğŸ’¡ è¿™é‡Œæ‰€ä½¿ç”¨çš„å•ç‰‡æœºèŠ¯ç‰‡ä¸º <code>STM32F103RCT6</code>ã€‚ä¸åŒçš„èŠ¯ç‰‡å¯èƒ½äº§ç”Ÿç»†å¾®ä½†ä¸å¤§çš„å·®åˆ«ã€‚</p></blockquote><h2 id="å®‰è£…-Rust-STM32-å·¥å…·é“¾"><a href="#å®‰è£…-Rust-STM32-å·¥å…·é“¾" class="headerlink" title="å®‰è£… Rust STM32 å·¥å…·é“¾"></a>å®‰è£… Rust STM32 å·¥å…·é“¾</h2><p>è¿™é‡Œé»˜è®¤å·²ç»å®‰è£…å¥½äº†<code>rustup</code> ä¸<code>cargo</code> ç­‰å·¥å…·ï¼Œä»¥åŠ <code>openocd</code>è¿™ä¸€è°ƒè¯•å·¥å…·ã€‚</p><p>è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ³¨æ„ï¼šä¸åŒ STM32 èŠ¯ç‰‡å¯¹åº”çš„ç›®æ ‡å¯èƒ½ä¸åŒã€‚</span></span><br><span class="line"><span class="comment"># rustup target add thumbv7em-none-eabihf   # STM32F4xx / F7xx / L7xx / ...</span></span><br><span class="line">rustup target add thumbv7m-none-eabi        <span class="comment"># STM32F1xx / L1xx</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ è¿™é‡Œé™„ä¸Šä¸€å¼  MCU ä¸ä¸åŒ Rust æ„å»ºç›®æ ‡çš„å‚è€ƒè¡¨ã€‚</p><table><thead><tr><th>MCU ç³»åˆ—</th><th>Rust target</th></tr></thead><tbody><tr><td><strong><code>STM32F0/L0/G0</code></strong></td><td><code>thumbv6m-none-eabi</code></td></tr><tr><td><strong><code>STM32F1/L1</code></strong></td><td><code>thumbv7m-none-eabi</code></td></tr><tr><td><strong><code>STM32F2/F3/F4/F7/L4/H7</code></strong></td><td><code>thumbv7em-none-eabi</code> æˆ– <code>thumbv7em-none-eabihf</code>ï¼ˆç¡¬æµ®ç‚¹ï¼‰</td></tr></tbody></table></blockquote><p>ä¸ºäº†ä½¿å¾— Rust å¯ä»¥æ­£å¸¸å®Œæˆäº¤å‰ç¼–è¯‘ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦å®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·é“¾ã€‚</p><p>è¾“å…¥å‘½ä»¤ï¼ˆè¿™é‡Œä»¥ Debian ä¸ºä¾‹ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install gcc-arm-none-eabi gdb-multiarch</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ä½¿å¾—æˆ‘ä»¬å¯ä»¥è‡ªåŠ¨åŒ–çƒ§å½•ã€è¿è¡Œã€è°ƒè¯•è¿™ä¸€å…¨è¿‡ç¨‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£… <code>probe-rs</code> å·¥å…·ã€‚</p><p>è¿è¡Œå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo install probe-rs</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨ç®€æ˜“æ¨¡æ¿æ–¹å¼åˆ›å»º-STM32-å·¥ç¨‹"><a href="#ä½¿ç”¨ç®€æ˜“æ¨¡æ¿æ–¹å¼åˆ›å»º-STM32-å·¥ç¨‹" class="headerlink" title="ä½¿ç”¨ç®€æ˜“æ¨¡æ¿æ–¹å¼åˆ›å»º STM32 å·¥ç¨‹"></a>ä½¿ç”¨ç®€æ˜“æ¨¡æ¿æ–¹å¼åˆ›å»º STM32 å·¥ç¨‹</h2><h3 id="å…‹éš†æ¨¡æ¿ä»“åº“"><a href="#å…‹éš†æ¨¡æ¿ä»“åº“" class="headerlink" title="å…‹éš†æ¨¡æ¿ä»“åº“"></a>å…‹éš†æ¨¡æ¿ä»“åº“</h3><p>è¿™é‡Œæœ‰ä¸€ä¸ª Rust çš„ä»“åº“æ¨¡æ¿ï¼Œå°¤å…¶é€‚ç”¨äºåŸºäº VSCode çš„å¼€å‘ã€‚</p><p>è¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/redstone6835/example-rust-stm32</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ä¸ºå™è¿°æ–¹ä¾¿ï¼Œå°†è½¯ä»¶ä»“åº“æ ¹ç›®å½•è§†ä¸º<code>/</code> ç›®å½•ã€‚</p><p>è¿™é‡Œä½¿ç”¨ VSCode å¯ä»¥ç›´æ¥æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹ã€‚åœ¨æ‰“å¼€æ–‡ä»¶å¤¹ä¹‹å‰ï¼Œè¯·å®‰è£… <code>rust-analyzer</code> ä¸<code>Dependi</code>æ’ä»¶ä»¥ç¡®ä¿æ›´åŠ å®Œç¾çš„ Coding ä½“éªŒã€‚</p><blockquote><p>ğŸ’¡ å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å…¶ä»–ç¼–è¾‘å™¨ï¼Œç†è®ºä¸Šå¯ä»¥åœ¨é…ç½®å¥½ Rust å¼€å‘ç¯å¢ƒä¹‹åç›´æ¥ä»¥æ‰“å¼€ä»»ä½•ä¸€ä¸ª Rust å·¥ç¨‹çš„å½¢å¼æ‰“å¼€æœ¬æ¨¡æ¿ã€‚</p><p>æ³¨æ„ï¼šæœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ <code>openocd</code> è¿›è¡Œçƒ§å½•ã€è°ƒè¯•ã€‚ä½¿ç”¨å…¶ä»–æ–¹æ³•çƒ§å½•å¯èƒ½äº§ç”Ÿå…¶ä»–é—®é¢˜ã€‚</p><p>å…·ä½“ç»†èŠ‚è¯·å‚è€ƒé¡¹ç›®ä¸­çš„ <code>/.vscode/launch.json</code> ä¸ <code>/.vscode/tasks.json</code>ã€‚</p></blockquote><h3 id="ä¿®æ”¹æœ‰å…³é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹æœ‰å…³é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹æœ‰å…³é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹æœ‰å…³é…ç½®æ–‡ä»¶</h3><p>æ‰“å¼€ <code>/Cargo.toml</code> ï¼š</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;example-rust-stm32&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">edition</span> = <span class="string">&quot;2024&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">cortex-m</span> = <span class="string">&quot;0.7&quot;</span></span><br><span class="line"><span class="attr">cortex-m-rt</span> = <span class="string">&quot;0.7&quot;</span></span><br><span class="line"><span class="attr">embedded-hal</span> = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"><span class="attr">panic-halt</span> = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stm32f1xx-hal</span> = &#123; version = <span class="string">&quot;0.11.0&quot;</span>, features = [<span class="string">&quot;stm32f103&quot;</span>, <span class="string">&quot;medium&quot;</span>] &#125;</span><br><span class="line"></span><br><span class="line"><span class="section">[profile.dev]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">lto</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">codegen-units</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">strip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[profile.release]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="string">&quot;z&quot;</span></span><br><span class="line"><span class="attr">lto</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">codegen-units</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">strip</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">panic</span> = <span class="string">&quot;abort&quot;</span></span><br></pre></td></tr></table></figure><p>å°† <code>package</code> ä¸­çš„ <code>name</code> é¡¹ä¿®æ”¹ä¸ºæœ¬å·¥ç¨‹é¡¹ç›®çš„åç§°ã€‚</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;car&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">edition</span> = <span class="string">&quot;2024&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">cortex-m</span> = <span class="string">&quot;0.7&quot;</span></span><br><span class="line"><span class="attr">cortex-m-rt</span> = <span class="string">&quot;0.7&quot;</span></span><br><span class="line"><span class="attr">embedded-hal</span> = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"><span class="attr">panic-halt</span> = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">stm32f1xx-hal</span> = &#123; version = <span class="string">&quot;0.11.0&quot;</span>, features = [<span class="string">&quot;stm32f103&quot;</span>, <span class="string">&quot;medium&quot;</span>] &#125;</span><br><span class="line"></span><br><span class="line"><span class="section">[profile.dev]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">lto</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">codegen-units</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">strip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="section">[profile.release]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="string">&quot;z&quot;</span></span><br><span class="line"><span class="attr">lto</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">codegen-units</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">strip</span> = <span class="literal">true</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">panic</span> = <span class="string">&quot;abort&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ æ³¨æ„ï¼šåœ¨æœ¬æ¬¡ä¿®æ”¹é¡¹ç›®åç§°ä¹‹åï¼Œè¯·åŒæ­¥ä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•æ–‡ä»¶å¤¹çš„åç§°ï¼Œä»¥ç¡®ä¿ VSCode å¯ä»¥æ­£å¸¸æ‰¾åˆ°å¯æ‰§è¡Œæ–‡ä»¶å¹¶æ‰§è¡Œç›¸å…³æ“ä½œï¼Œå¹¶ä¾¿äºç®¡ç†å„ä¸ªä¸åŒé¡¹ç›®ã€‚</p></blockquote><h3 id="ä¿®æ”¹é“¾æ¥è„šæœ¬ä¸-MCU-å‹å·"><a href="#ä¿®æ”¹é“¾æ¥è„šæœ¬ä¸-MCU-å‹å·" class="headerlink" title="ä¿®æ”¹é“¾æ¥è„šæœ¬ä¸ MCU å‹å·"></a>ä¿®æ”¹é“¾æ¥è„šæœ¬ä¸ MCU å‹å·</h3><blockquote><p>ğŸ’¡ æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æå‰è·çŸ¥æ‚¨æ‰€æ­£åœ¨å¼€å‘çš„ MCU çš„å®é™…æƒ…å†µï¼ˆå¦‚ Flash å¤§å°ï¼ŒRAM å¤§å°ç­‰å‚æ•°ï¼‰ï¼Œå¦‚æœæ‚¨å¹¶ä¸çŸ¥æ™“ï¼Œè¯·æŸ¥é˜… STM32 å®˜æ–¹æä¾›çš„ç›¸å…³æ•°æ®æ‰‹å†Œè·çŸ¥æƒ…å†µï¼Œå¦åˆ™å¾ˆå¯èƒ½å¯¼è‡´çƒ§å½•å¤±è´¥ç”šè‡³ç¨‹åºæ— æ³•æ­£å¸¸é€šè¿‡ç¼–è¯‘çš„åæœã€‚</p></blockquote><p>æ‰“å¼€ <code>/memory.x</code> ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/* memory.x */</span><br><span class="line">MEMORY</span><br><span class="line">&#123;</span><br><span class="line">  FLASH : ORIGIN = 0x08000000, LENGTH = 512K</span><br><span class="line">  RAM   : ORIGIN = 0x20000000, LENGTH = 64K</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_stack_start = ORIGIN(RAM) + LENGTH(RAM);</span><br></pre></td></tr></table></figure><p>å°†è¿™é‡Œçš„ FLASH ä¸ RAM çš„ LENGTH æ®µæ”¹ä¸ºç›¸åº” MCU çš„å‚æ•°ï¼Œå¦‚ <code>STM32F103RCT6</code> :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/* memory.x */</span><br><span class="line">MEMORY</span><br><span class="line">&#123;</span><br><span class="line">  FLASH : ORIGIN = 0x08000000, LENGTH = 256K</span><br><span class="line">  RAM   : ORIGIN = 0x20000000, LENGTH = 48K</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_stack_start = ORIGIN(RAM) + LENGTH(RAM);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨äº† <code>xpack</code> æ–¹å¼è¿›è¡Œè¾…åŠ©ç¼–è¯‘ã€‚ä¿®æ”¹é“¾æ¥è„šæœ¬ä¹‹åï¼Œä»ç„¶éœ€è¦ä¿®æ”¹ <code>xpack</code> çš„ç›¸åº”é…ç½®ã€‚æ‰“å¼€ <code>/xpack/src/main.rs</code> ï¼Œ<code>40 - 43</code> è¡Œå¤„ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡ºå ç”¨ç‡</span></span><br><span class="line"><span class="comment">// STM32F103ZET6: Flash 512KB, RAM 64KB</span></span><br><span class="line"><span class="keyword">const</span> FLASH_TOTAL: <span class="type">f64</span> = <span class="number">512.0</span> * <span class="number">1024.0</span>;</span><br><span class="line"><span class="keyword">const</span> RAM_TOTAL: <span class="type">f64</span> = <span class="number">64.0</span> * <span class="number">1024.0</span>;</span><br></pre></td></tr></table></figure><p>å°†è¿™é‡Œçš„ Flash å’Œ RAM å­—æ®µåŒæ­¥è¿›è¡Œä¿®æ”¹ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡ºå ç”¨ç‡</span></span><br><span class="line"><span class="comment">// STM32F103ZET6: Flash 256KB, RAM 48KB</span></span><br><span class="line"><span class="keyword">const</span> FLASH_TOTAL: <span class="type">f64</span> = <span class="number">256.0</span> * <span class="number">1024.0</span>;</span><br><span class="line"><span class="keyword">const</span> RAM_TOTAL: <span class="type">f64</span> = <span class="number">48.0</span> * <span class="number">1024.0</span>;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <strong>å¯é€‰ï¼šä¿®æ”¹è¿è¡Œé…ç½®</strong></p><p>æ‰“å¼€ <code>/.cargo/config.toml</code> ï¼š</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build]</span></span><br><span class="line"><span class="attr">target</span> = <span class="string">&quot;thumbv7m-none-eabi&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[target.thumbv7m-none-eabi]</span></span><br><span class="line"><span class="attr">runner</span> = <span class="string">&quot;probe-rs run --chip STM32F103ZE&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rustflags</span> = [</span><br><span class="line">  <span class="string">&quot;-C&quot;</span>, <span class="string">&quot;link-arg=-Tlink.x&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>å°†<code>runner</code> å­—æ®µçš„ <code>chip</code> å‚æ•°æ”¹ä¸ºå…·ä½“çš„ MCU å‹å·ã€‚</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build]</span></span><br><span class="line"><span class="attr">target</span> = <span class="string">&quot;thumbv7m-none-eabi&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[target.thumbv7m-none-eabi]</span></span><br><span class="line"><span class="attr">runner</span> = <span class="string">&quot;probe-rs run --chip STM32F103RC&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rustflags</span> = [</span><br><span class="line">  <span class="string">&quot;-C&quot;</span>, <span class="string">&quot;link-arg=-Tlink.x&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure></blockquote><h2 id="Start-coding"><a href="#Start-coding" class="headerlink" title="Start coding !!!"></a>Start coding !!!</h2><p>å®Œæˆä¸Šè¿°é…ç½®ä¹‹åï¼Œå¯ä»¥å¼€å§‹æ­£å¼å¼€å‘æ™ºèƒ½è½¦é¡¹ç›®äº†ã€‚æˆ‘ä»¬é¦–å…ˆç ”ç©¶ä¸€ä¸‹ MCU å„å¼•è„šçš„ç”¨æ³•ã€‚</p><h3 id="å¼•è„šå®šä¹‰"><a href="#å¼•è„šå®šä¹‰" class="headerlink" title="å¼•è„šå®šä¹‰"></a>å¼•è„šå®šä¹‰</h3><table><thead><tr><th>å¼•è„š</th><th>å¤ç”¨å¤–è®¾&#x2F;åŠŸèƒ½</th><th>ç¨‹åºä¸­çš„ç”¨é€”</th></tr></thead><tbody><tr><td><strong>PA4</strong></td><td>ADC1_CH4</td><td>å³ä¾§ç”µæ„Ÿ ADC é‡‡æ ·</td></tr><tr><td><strong>PC5</strong></td><td>ADC1_CH15</td><td>å·¦ä¾§ç”µæ„Ÿ ADC é‡‡æ ·</td></tr><tr><td><strong>PA8</strong></td><td>GPIO</td><td>æ‹¨ç å¼€å…³ 1</td></tr><tr><td><strong>PC9</strong></td><td>GPIO</td><td>æ‹¨ç å¼€å…³ 2</td></tr><tr><td><strong>PC8</strong></td><td>GPIO</td><td>æ‹¨ç å¼€å…³ 3</td></tr><tr><td><strong>PC7</strong></td><td>GPIO</td><td>æ‹¨ç å¼€å…³ 4</td></tr><tr><td><strong>PA11</strong></td><td>GPIO</td><td>LED1</td></tr><tr><td><strong>PA15</strong></td><td>GPIO</td><td>LED2</td></tr><tr><td><strong>PC12</strong></td><td>GPIO</td><td>LED3</td></tr><tr><td><strong>PB3</strong></td><td>GPIO</td><td>LED4</td></tr><tr><td><strong>PA12</strong></td><td>GPIO</td><td>æ€»ä½¿èƒ½å¼€å…³ï¼ˆEnableï¼‰è¾“å…¥</td></tr><tr><td><strong>PC13</strong></td><td>GPIO</td><td>ä½¿èƒ½è¾“å‡ºè‡³é©±åŠ¨æ¿</td></tr><tr><td><strong>PB0</strong></td><td>TIM3_CH3</td><td>èˆµæœº PWM è¾“å‡º</td></tr><tr><td><strong>PB8</strong></td><td>GPIO</td><td>å·¦è½®æ§åˆ¶æ¨æŒ½è¾“å‡º</td></tr><tr><td><strong>PB9</strong></td><td>GPIO</td><td>å³è½®æ§åˆ¶æ¨æŒ½è¾“å‡º</td></tr><tr><td><strong>PB6</strong></td><td>TIM4_CH1</td><td>å·¦è½® PWM è¾“å‡º</td></tr><tr><td><strong>PB7</strong></td><td>TIM4_CH2</td><td>å³è½® PWM è¾“å‡º</td></tr><tr><td><strong>PA9</strong></td><td>USART1_TX</td><td>è°ƒè¯•ç”¨ä¸²å£</td></tr><tr><td><strong>PA10</strong></td><td>USART1_RX</td><td>è°ƒè¯•ç”¨ä¸²å£</td></tr></tbody></table><h3 id="æ¨¡æ¿åŸç”Ÿä»£ç åŠç›¸å…³å¥æŸ„çš„æ„ä¹‰"><a href="#æ¨¡æ¿åŸç”Ÿä»£ç åŠç›¸å…³å¥æŸ„çš„æ„ä¹‰" class="headerlink" title="æ¨¡æ¿åŸç”Ÿä»£ç åŠç›¸å…³å¥æŸ„çš„æ„ä¹‰"></a>æ¨¡æ¿åŸç”Ÿä»£ç åŠç›¸å…³å¥æŸ„çš„æ„ä¹‰</h3><p>æ‰“å¼€ <code>/src/main.rs</code> ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#![no_std]</span></span><br><span class="line"><span class="meta">#![no_main]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> cortex_m_rt::entry;</span><br><span class="line"><span class="keyword">use</span> panic_halt <span class="keyword">as</span> _;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> stm32f1xx_hal::&#123;pac, prelude::*&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[entry]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> ! &#123;</span><br><span class="line">    <span class="comment">// è·å–å¤–è®¾è®¿é—®æ¥å£</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">dp</span> = pac::Peripherals::<span class="title function_ invoke__">take</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">cp</span> = cortex_m::Peripherals::<span class="title function_ invoke__">take</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="comment">// é…ç½®æ—¶é’Ÿ</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rcc</span> = dp.RCC.<span class="title function_ invoke__">constrain</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">delay</span> = cp.SYST.<span class="title function_ invoke__">delay</span>(&amp;rcc.clocks);</span><br><span class="line">    <span class="comment">// GPIOB æ—¶é’Ÿå¼€å¯</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpiob</span> = dp.GPIOB.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// PB5 è¿æ¥æ¿è½½ LED</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led</span> = gpiob.pb5.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        led.<span class="title function_ invoke__">toggle</span>(); <span class="comment">// ç¿»è½¬ç”µå¹³</span></span><br><span class="line">        delay.<span class="title function_ invoke__">delay_ms</span>(<span class="number">1000_u32</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç¨‹åºå®šä¹‰äº† PB5 å¼•è„šçš„å¤ç”¨ï¼ˆæ¨æŒ½è¾“å‡ºï¼‰ï¼Œå¹¶ç”¨ PB5 æ¥æ§åˆ¶ä¸€ä¸ª LED çš„é—ªçƒï¼Œæ¯æ¬¡çŠ¶æ€æŒç»­ 1s ä¹‹åç¿»è½¬ç”µå¹³çŠ¶æ€ã€‚</p><blockquote><p>ğŸ’¡ <strong>ç›¸åº”å¥æŸ„çš„æ„ä¹‰</strong></p><table><thead><tr><th>å¥æŸ„</th><th>æŠ½è±¡å±‚</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>dp</code></td><td>PAC</td><td>æ‹¿åˆ°æ‰€æœ‰ç¡¬ä»¶å¯„å­˜å™¨çš„æ‰€æœ‰æƒï¼ˆå¤–è®¾çº§ï¼‰</td></tr><tr><td><code>cp</code></td><td>æ ¸å¿ƒ PAC</td><td>æ‹¿åˆ° Cortex-M å†…æ ¸å¤–è®¾ï¼ˆSysTickã€NVICï¼‰</td></tr><tr><td><code>rcc</code></td><td>HAL</td><td>å°†ä¸å®‰å…¨çš„ RCC å˜æˆæ˜“ç”¨çš„æ—¶é’Ÿé…ç½®å¯¹è±¡</td></tr><tr><td><code>delay</code></td><td>HAL</td><td>ä½¿ç”¨ SysTick ç”Ÿæˆå»¶æ—¶åŠŸèƒ½</td></tr></tbody></table></blockquote><blockquote><p>ğŸ’¡ ä¸‹æ–‡ä¸­ï¼Œè‹¥æœªæ˜ç¡®æŒ‡å®šï¼Œé»˜è®¤å°†æåŠ Rust ä»£ç è§†ä½œ <code>/src/main.rs</code> çš„ä¸€éƒ¨åˆ†ã€‚</p></blockquote><h3 id="é…ç½®-GPIO-å¤ç”¨å¹¶ç¦ç”¨-JTAG"><a href="#é…ç½®-GPIO-å¤ç”¨å¹¶ç¦ç”¨-JTAG" class="headerlink" title="é…ç½® GPIO å¤ç”¨å¹¶ç¦ç”¨ JTAG"></a>é…ç½® GPIO å¤ç”¨å¹¶ç¦ç”¨ JTAG</h3><p>ç„¶è€Œæˆ‘ä»¬çš„ç¨‹åºè§„æ¨¡ç›¸è¾ƒäºç®€å•çš„ LED é—ªçƒç¨‹åºè¦å¤§å¤šäº†ï¼Œä¸€ä¸ª GPIOB é€šé“å®Œå…¨æ— æ³•æ»¡è¶³ï¼Œæˆ‘ä»¬éœ€è¦å¼€è¾Ÿæ›´å¤šé€šé“ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpioa</span> = dp.GPIOA.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpiob</span> = dp.GPIOB.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpioc</span> = dp.GPIOC.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼ å…¥<code>rcc</code> ä½œä¸ºå‚æ•°ï¼Œé¿å…äº†å¦‚åŒåœ¨ C è¯­è¨€çš„ STM32 å¼€å‘ä¸­ä»ç„¶éœ€è¦å•ç‹¬å¯ç”¨ GPIO æ—¶é’Ÿï¼Œå¤§å¹…æé«˜äº†ä»£ç å¯è¯»æ€§ã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒPA15 ä¸ PB3 ä¸¤ä¸ªå¼•è„šé»˜è®¤è¢«å¤ç”¨ä¸ºäº† JTAG è°ƒè¯•ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥å°†å…¶å¤ç”¨ä¸ºæ¨æŒ½è¾“å‡ºï¼Œéœ€è¦ç¦ç”¨ JTAG è°ƒè¯•ï¼Œé‡Šæ”¾è¿™ä¸¤ä¸ªå¼•è„šï¼Œæ‰èƒ½å¤Ÿå°†å…¶ç‰©ç†å¼•è„šæ­£å¸¸å¤ç”¨ã€‚è¿™é‡Œè¿˜éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„æŠ½è±¡å±‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">afio</span> = dp.AFIO.<span class="title function_ invoke__">constrain</span>(&amp;<span class="keyword">mut</span> rcc);</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ <code>afio</code> å¥æŸ„æä¾›äº†é‡æ˜ å°„ã€JTAG é…ç½®ç­‰å®‰å…¨ APIã€‚</p></blockquote><p>è¿™é‡Œå°±å¯ä»¥å°†ä¸¤ä¸ªæˆ‘ä»¬æ‰€éœ€è¦çš„ JTAG å¼•è„šæ­£å¸¸é‡Šæ”¾ï¼Œå¹¶è·å¾—ç›¸åº”å¥æŸ„ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> (pa15_released, pb3_released, _) = afio.mapr.<span class="title function_ invoke__">disable_jtag</span>(gpioa.pa15, gpiob.pb3, gpiob.pb4);</span><br></pre></td></tr></table></figure><h3 id="é…ç½®åŸºæœ¬è¾“å…¥è¾“å‡º"><a href="#é…ç½®åŸºæœ¬è¾“å…¥è¾“å‡º" class="headerlink" title="é…ç½®åŸºæœ¬è¾“å…¥è¾“å‡º"></a>é…ç½®åŸºæœ¬è¾“å…¥è¾“å‡º</h3><p>æ ¹æ®ä¸»æ¿çš„è®¾è®¡ï¼Œæ‹¨ç å¼€å…³å„ä¸ªå¼€å…³ä¸ä½¿èƒ½å¼€å…³å½“å¤„äºä½ç”µå¹³æ—¶è§†ä¸ºæ‰“å¼€ï¼Œå¤„äºé«˜ç”µå¹³æ—¶è§†ä¸ºå…³é—­ï¼Œå› æ­¤æˆ‘ä»¬å°†è¿™å‡ ä¸ªå¼•è„šé…ç½®ä¸ºä¸Šæ‹‰è¾“å…¥ã€‚å››ä¸ª LED ç¯ä¸ä½¿èƒ½è¾“å‡ºå¯ä»¥ä½¿ç”¨æ¨æŒ½è¾“å‡ºè¿›è¡Œæ§åˆ¶ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">switch1</span> = gpioa.pa8.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">switch2</span> = gpioc.pc9.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">switch3</span> = gpioc.pc8.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">switch4</span> = gpioc.pc7.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crl);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led1_pa11</span> = gpioa.pa11.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led2_pa15</span> = pa15_released.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led3_pc12</span> = gpioc.pc12.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led4_pb3</span> = pb3_released.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">enable_switch_pa12</span> = gpioa.pa12.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">enable_out_pc13</span> = gpioc.pc13.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œ <code>&amp;mut gpioa.crh</code> ç­‰ç±»ä¼¼å­—æ®µå¯æ ¹æ®å¼•è„šæ‰€åœ¨é¢‘é“ä¸ç¼–å·æ˜¯å¦ä¸ºé«˜å…«ä½æˆ–ä½å…«ä½è·çŸ¥ã€‚å¦‚ <code>pa8</code> ä½äº <code>gpioa</code> é€šé“çš„é«˜å…«ä½ï¼ˆ<code>8 - 15</code>ä½è§†ä¸ºé«˜å…«ä½ï¼Œ<code>0 - 7</code>ä½è§†ä¸ºä½å…«ä½ï¼‰ï¼Œåˆ™ä¼ å…¥ <code>&amp;mut gpioa.crh</code> ï¼Œè‹¥ä½äºä½å…«ä½ï¼ˆå¦‚ <code>pc7</code>ï¼‰ï¼Œåˆ™ä¼ å…¥ <code>&amp;mut gpioc.crl</code> ã€‚</p><blockquote><p>ğŸ’¡ æ³¨æ„ï¼šè¿™é‡Œ <code>pa15</code> ä¸<code>pb3</code> å¥æŸ„çš„è·å–éœ€è¦é€šè¿‡ä¹‹å‰è·å–çš„ <code>pa15_released</code> ä¸<code>pb3_released</code> å¥æŸ„è¿›è¡Œå®ç°ã€‚å¦‚<code>pb3</code>ï¼Œè‹¥ä½¿ç”¨ <code>gpioa.pb3</code> ç­‰åŸç”Ÿå¥æŸ„ï¼Œç”±äºå…¶ç±»å‹ä¸º<code>Pin&lt;&#39;B&#39;, 3, Debugger&gt;</code> ï¼Œè€Œéæˆ‘ä»¬æ‰€é¢„æœŸçš„ <code>Pin&lt;&#39;B&#39;, 3, Input&lt;Floating&gt;&gt;</code> ï¼Œå…¶ä¸å…·æœ‰ <code>into_push_pull_output</code> æ–¹æ³•ï¼Œæ— æ³•æˆåŠŸè·å– <code>led4_pb3</code> å¥æŸ„ã€‚è€Œ <code>pb3_released</code> å¥æŸ„çš„ç±»å‹ä¸º<code>Pin&lt;&#39;B&#39;, 3&gt;</code> ï¼Œæ˜¯é€šè¿‡ JTAG çš„é‡Šæ”¾æ‰€è·å–çš„æ–°å¥æŸ„ï¼Œå…·æœ‰è¯¥æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥æˆåŠŸè·å–<code>led4_pb3</code>å¥æŸ„ã€‚</p></blockquote><h3 id="é…ç½®-ADC-é¢‘é“å¥æŸ„"><a href="#é…ç½®-ADC-é¢‘é“å¥æŸ„" class="headerlink" title="é…ç½® ADC é¢‘é“å¥æŸ„"></a>é…ç½® ADC é¢‘é“å¥æŸ„</h3><p>ä¸ºäº†è·å– PA4 å’Œ PC5 è¾“å…¥è¿›æ¥çš„ä¼ æ„Ÿå™¨ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦æå‰é…ç½® ADC1 é€šé“çš„å¥æŸ„ï¼Œå¹¶å°† PA4 å’Œ PC5 é…ç½®ä¸ºæ¨¡æ‹Ÿä¿¡å·è¾“å…¥ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1</span> = adc::Adc::<span class="title function_ invoke__">new</span>(dp.ADC1, &amp;<span class="keyword">mut</span> rcc);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1_ch4_pa4</span> = gpioa.pa4.<span class="title function_ invoke__">into_analog</span>(&amp;<span class="keyword">mut</span> gpioa.crl);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1_ch15_pc5</span> = gpioc.pc5.<span class="title function_ invoke__">into_analog</span>(&amp;<span class="keyword">mut</span> gpioc.crl);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>adc1.read(&amp;mut adc1_ch4_pa4).unwrap()</code> çš„æ–¹å¼è¯»å– ADC é‡‡é›†è·å–çš„å€¼ï¼Œå¹¶ç”±è¿™ä¸ªå€¼æ¨ç†å¾—åˆ°è½¬å‘ç­–ç•¥ã€‚</p><h3 id="é…ç½®èˆµæœº-PWM-è¾“å‡º"><a href="#é…ç½®èˆµæœº-PWM-è¾“å‡º" class="headerlink" title="é…ç½®èˆµæœº PWM è¾“å‡º"></a>é…ç½®èˆµæœº PWM è¾“å‡º</h3><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰æŸä¸€ PWM ä¸­å€¼ï¼Œä½¿å¾—èˆµæœºæ¥å—åˆ°è¯¥å ç©ºæ¯”çš„ PWM æ³¢æ—¶ï¼Œèˆµæœºè§’åº¦èƒ½å¤Ÿåˆšå¥½æœå‘æ­£å‰æ–¹ã€‚ä½†æ˜¯ä¸ºäº†é€‚åº” C è¯­è¨€çš„æŸä¸ªä¾‹ç¨‹ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯è®¤ä¸ºå ç©ºæ¯”æœ€å¤§å€¼ä¸º 9999 æ—¶çš„å ç©ºæ¯”è®¾ç½®ï¼Œæˆ‘ä»¬æš‚ä¸”ç§°å…¶ä¸ºç­‰æ•ˆå ç©ºæ¯”ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">steer_pwm_duty_center</span>: <span class="type">u16</span> = <span class="number">750</span> - <span class="number">5</span>; <span class="comment">// èˆµæœº PWM ä¸­å€¼</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">steer_pwm_duty_max</span> = steer_pwm_duty_center + <span class="number">60</span>; <span class="comment">// èˆµæœº PWM æœ€å¤§å€¼</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">steer_pwm_duty_min</span> = steer_pwm_duty_center - <span class="number">60</span>; <span class="comment">// èˆµæœº PWM æœ€å°å€¼</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°† PB0 é…ç½®ä¸ºå¤ç”¨æ¨æŒ½è¾“å‡ºï¼Œå¹¶é…ç½®ç›¸åº” PWM é¢‘é“ã€‚è¿™é‡Œæ˜¯ TIM3ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°† PB0 é…ç½®ä¸º TIM3_CH3 å¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">tim3_ch3</span> = gpiob.pb0.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"><span class="comment">// é…ç½® TIM3 ä¸º PWM è¾“å‡ºï¼Œé¢‘ç‡ 1kHz</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">steer_pwm</span> = </span><br><span class="line">dp.TIM3.pwm_hz::&lt;Tim3NoRemap, _, _&gt;(</span><br><span class="line">    tim3_ch3,</span><br><span class="line">    &amp;<span class="keyword">mut</span> afio.mapr,</span><br><span class="line">    <span class="number">1</span>.<span class="title function_ invoke__">kHz</span>(),</span><br><span class="line">    &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">);</span><br><span class="line"><span class="comment">// è®¾ç½®å ç©ºæ¯”ä¸º èˆµæœº PWM ä¸­å€¼</span></span><br><span class="line">steer_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C3, (steer_pwm_duty_center / <span class="number">9999</span>) * steer_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line"><span class="comment">// ä½¿èƒ½èˆµæœº PWM è¾“å‡º</span></span><br><span class="line">steer_pwm.<span class="title function_ invoke__">enable</span>(Channel::C3);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œæˆ‘ä»¬æŒ‡å®š TIM3 é¢‘é“çš„é¢‘ç‡ä¸º 1kHzï¼Œå¹¶é€šè¿‡ç­‰æ•ˆå ç©ºæ¯”å°†å ç©ºæ¯”è®¾ç½®ä¸ºçœŸæ­£çš„ä¸­å€¼ã€‚</p><h3 id="é…ç½®å·¦å³è½®æ§åˆ¶æµè¾“å‡º"><a href="#é…ç½®å·¦å³è½®æ§åˆ¶æµè¾“å‡º" class="headerlink" title="é…ç½®å·¦å³è½®æ§åˆ¶æµè¾“å‡º"></a>é…ç½®å·¦å³è½®æ§åˆ¶æµè¾“å‡º</h3><p>å› ä¸ºå·¦å³è½®çš„é€Ÿåº¦æ§åˆ¶æ˜¯ PWM æ§åˆ¶çš„ï¼Œå› æ­¤æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨åŒæ ·çš„ä¸€ç§æ–¹å¼æ¥é…ç½®ç›¸åº”çš„å¥æŸ„ã€‚è€Œä¸åŒçš„æ˜¯ï¼Œå·¦å³è½®çš„è½¬å‘æ§åˆ¶æ˜¯é€šè¿‡ç»™é«˜ç”µå¹³æˆ–ä½ç”µå¹³å®ç°çš„ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦é…ç½®ä¸¤ä¸ªæ¨æŒ½è¾“å‡ºçš„å¼•è„šè¿›è¡Œè½¬å‘çš„æ§åˆ¶ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">left_wheel_pb8</span> = gpiob.pb8.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">right_wheel_pb9</span> = gpiob.pb9.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">tim4_ch1</span> = gpiob.pb6.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">tim4_ch2</span> = gpiob.pb7.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheels_pwm</span> = </span><br><span class="line">dp.TIM4.pwm_hz::&lt;Tim4NoRemap, _, _&gt;(</span><br><span class="line">    (tim4_ch1, tim4_ch2),</span><br><span class="line">    &amp;<span class="keyword">mut</span> afio.mapr,</span><br><span class="line">    <span class="number">1</span>.<span class="title function_ invoke__">kHz</span>(),</span><br><span class="line">    &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">);</span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C2, <span class="number">0</span>);</span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C1, <span class="number">0</span>);</span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">enable</span>(Channel::C2);</span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">enable</span>(Channel::C1);</span><br></pre></td></tr></table></figure><h3 id="é…ç½®è°ƒè¯•ä¿¡æ¯è¾“å‡º"><a href="#é…ç½®è°ƒè¯•ä¿¡æ¯è¾“å‡º" class="headerlink" title="é…ç½®è°ƒè¯•ä¿¡æ¯è¾“å‡º"></a>é…ç½®è°ƒè¯•ä¿¡æ¯è¾“å‡º</h3><p>åœ¨æ¯”èµ›çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦éœ€è¦è·çŸ¥ä¸€ä¸ªç‚¹å¤„å…·ä½“çš„ä¼ æ„Ÿå™¨è¾“å‡ºï¼Œä»è€Œå¯¹è½¦æœ¬èº«è¿›è¡Œç¡¬ä»¶æ–¹é¢çš„è°ƒè¯•ã€‚ä¸ºäº†å‡†ç¡®è·çŸ¥è½¯ä»¶æ–¹é¢çš„ä¼ æ„Ÿå™¨å€¼ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä¸²å£æ¥ç›´æ¥è¯»å–ã€‚è¿™é‡Œé…ç½®äº† USART1 ä¸²å£ï¼Œå®æ—¶å‘é€è¿™äº›ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘ä»¬è¿›è¡Œè°ƒè¯•ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">usart1_tx</span> = gpioa.pa9.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">usart1_rx</span> = gpioa.pa10;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">serial</span> = dp.USART1</span><br><span class="line">    .<span class="title function_ invoke__">serial</span>(</span><br><span class="line">        (usart1_tx, usart1_rx),</span><br><span class="line">        Config::<span class="title function_ invoke__">default</span>().<span class="title function_ invoke__">baudrate</span>(<span class="number">115200</span>.<span class="title function_ invoke__">bps</span>()),</span><br><span class="line">        &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">    );</span><br></pre></td></tr></table></figure><blockquote><p>ğŸ’¡ è¿™é‡Œä½¿ç”¨äº† <code>VOFA+</code> çš„ <code>JustFloat</code> åè®®è¿›è¡Œå‘é€ã€‚<code>VOFA+</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä¸Šä½æœºè½¯ä»¶ã€‚</p></blockquote><h2 id="è¿›å…¥ä¸»å¾ªç¯"><a href="#è¿›å…¥ä¸»å¾ªç¯" class="headerlink" title="è¿›å…¥ä¸»å¾ªç¯"></a>è¿›å…¥ä¸»å¾ªç¯</h2><p>Rust STM32 ç¨‹åºçš„ä¸»å¾ªç¯é€šå¸¸ä½¿ç”¨ <code>loop</code> æ­»å¾ªç¯ï¼Œå½¢å¦‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">    <span class="comment">// ä»£ç ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤„ç†ä¼ æ„Ÿå™¨è¾“å‡ºæ—¶é‡åˆ°çš„å›°éš¾"><a href="#å¤„ç†ä¼ æ„Ÿå™¨è¾“å‡ºæ—¶é‡åˆ°çš„å›°éš¾" class="headerlink" title="å¤„ç†ä¼ æ„Ÿå™¨è¾“å‡ºæ—¶é‡åˆ°çš„å›°éš¾"></a>å¤„ç†ä¼ æ„Ÿå™¨è¾“å‡ºæ—¶é‡åˆ°çš„å›°éš¾</h3><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™æ ·çš„ä»£ç è¯»å–ä¼ æ„Ÿå™¨çš„è¾“å‡ºï¼Œå¹¶è¿›è¡Œç›¸å…³çš„è¿ç®—ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">adc_value_right</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch4_pa4).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line"><span class="keyword">let</span> <span class="variable">adc_value_left</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch15_pc5).<span class="title function_ invoke__">unwrap</span>();</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œåœ¨å®é™…çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼šè¿™æ ·ç›´æ¥è¯»å–å‡ºæ¥çš„ ADC å€¼å­˜åœ¨ç€é«˜è¾¾ 100 çš„å™ªå£°ã€‚ä¸ºäº†æ¶ˆé™¤å™ªå£°å¸¦æ¥çš„å½±å“ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹æ•°æ®è¿›è¡Œåˆ†æï¼Œå°½å¯èƒ½é™ä½è¯¯å·®ã€‚</p><h3 id="ä¸€ç§åŸºäºæ­£æ€åˆ†å¸ƒæ‹Ÿåˆçš„æ»¤æ³¢ç®—æ³•-gauss-filter"><a href="#ä¸€ç§åŸºäºæ­£æ€åˆ†å¸ƒæ‹Ÿåˆçš„æ»¤æ³¢ç®—æ³•-gauss-filter" class="headerlink" title="ä¸€ç§åŸºäºæ­£æ€åˆ†å¸ƒæ‹Ÿåˆçš„æ»¤æ³¢ç®—æ³• gauss_filter"></a>ä¸€ç§åŸºäºæ­£æ€åˆ†å¸ƒæ‹Ÿåˆçš„æ»¤æ³¢ç®—æ³• <code>gauss_filter</code></h3><p>æˆ‘ä»¬é¦–å…ˆè€ƒè™‘å®ç°å¿«é€Ÿæ’åºç®—æ³•ï¼Œå¯¹æŸä¸€ç›®æ ‡æ•°ç»„è¿›è¡Œæ’åºã€‚</p><p>åˆ›å»ºå¹¶æ‰“å¼€<code>/src/utils.rs</code> ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[inline(always)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">quicksort</span>(arr: &amp;<span class="keyword">mut</span> [<span class="type">i32</span>]) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">len</span> = arr.<span class="title function_ invoke__">len</span>();</span><br><span class="line">    <span class="keyword">if</span> len &lt;= <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pivot</span> = arr[len - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">i</span> = <span class="number">0</span>;    </span><br><span class="line">    <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> <span class="number">0</span>..len - <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> arr[j] &lt;= pivot &#123;</span><br><span class="line">            arr.<span class="title function_ invoke__">swap</span>(i, j);</span><br><span class="line">            i += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    arr.<span class="title function_ invoke__">swap</span>(i, len - <span class="number">1</span>);   </span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> arr[<span class="number">0</span>..i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> i + <span class="number">1</span> &lt; len &#123;</span><br><span class="line">        <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> arr[i+<span class="number">1</span>..]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºå¿«é€Ÿæ’åºç®—æ³•çš„åŸç†ï¼Œè¿™é‡Œä¸è¿‡å¤šèµ˜è¿°ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä¸€ç»„æµ‹å¾—çš„æ•°æ®è¿›è¡Œæ­£æ€åˆ†å¸ƒæ›²çº¿çš„æ‹Ÿåˆï¼Œå°†<code>e</code>çš„æŒ‡æ•°è§†ä¸ºå„ä¸ªæ•°æ®çš„æƒé‡ï¼Œè®¡ç®—å‡ºåŠ æƒå‡å€¼ï¼Œä»¥è¯¥å€¼ä½œä¸ºçœŸå®å€¼çš„é¢„ä¼°ã€‚</p><p>ä¸ºäº†èƒ½å¤Ÿè¿›è¡Œæ­£æ€åˆ†å¸ƒæ›²çº¿çš„æ‹Ÿåˆï¼Œæˆ‘ä»¬å¿…é¡»å¼•å…¥ä¸€ä¸ªæ•°å­¦å‡½æ•°åº“ã€‚åœ¨åµŒå…¥å¼å¹³å°ï¼Œ<code>libm</code> æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚æ‰“å¼€<code>/Cargo.toml</code> ï¼Œåœ¨<code>dependencies</code> ä¸­å†™å…¥ï¼š</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">libm</span> = <span class="string">&quot;0.2.15â€</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºå¹¶æ‰“å¼€ <code>/src/gauss.rs</code> ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> crate::utils::quicksort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">gauss_filter</span>(x: &amp;[<span class="type">i32</span>], n: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x[<span class="number">0</span>] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ•°ç»„æ¥å­˜å‚¨æ’åºåçš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sorted</span> = [<span class="number">0i32</span>; <span class="number">64</span>]; <span class="comment">// å‡è®¾æœ€å¤§é•¿åº¦ä¸º64ï¼Œæ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        sorted[i] = x[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> sorted[<span class="number">0</span>..n]);</span><br><span class="line">    <span class="comment">// --- åˆå§‹ä¼°è®¡ ---</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        sum += sorted[i] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">mu</span> = sum / (n <span class="keyword">as</span> <span class="type">f64</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">var</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">diff</span> = sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu;</span><br><span class="line">        var += diff * diff;</span><br><span class="line">    &#125;</span><br><span class="line">    var /= (n - <span class="number">1</span>) <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sigma</span>: <span class="type">f64</span> = libm::<span class="title function_ invoke__">sqrt</span>(var);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sigma &lt; <span class="number">1e-6</span> &#123;</span><br><span class="line">        sigma = <span class="number">1e-6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- è¿­ä»£æ›´æ–° ---</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">max_iter</span> = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tol</span> = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_iter</span> <span class="keyword">in</span> <span class="number">0</span>..max_iter &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_w</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_wx</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">diff</span>: <span class="type">f64</span> = (sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu) / sigma;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">exponent</span>: <span class="type">f64</span> = -<span class="number">0.5</span> * diff * diff;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">weight</span> = libm::<span class="title function_ invoke__">exp</span>(exponent);</span><br><span class="line">            <span class="keyword">if</span> weight &lt; <span class="number">1e-10</span> &#123;</span><br><span class="line">                weight = <span class="number">1e-10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            sum_w += weight;</span><br><span class="line">            sum_wx += weight * sorted[i] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">new_mu</span> = sum_wx / sum_w;</span><br><span class="line">        <span class="keyword">if</span> libm::<span class="title function_ invoke__">fabs</span>(new_mu - mu) &lt; tol &#123;</span><br><span class="line">            mu = new_mu;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mu = new_mu;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›´æ–° sigma</span></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_var</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_var_w</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">diff</span> = sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">exponent</span> = -<span class="number">0.5</span> * (diff / sigma) * (diff / sigma);</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">weight</span> = libm::<span class="title function_ invoke__">exp</span>(exponent);</span><br><span class="line">            <span class="keyword">if</span> weight &lt; <span class="number">1e-10</span> &#123;</span><br><span class="line">                weight = <span class="number">1e-10</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sum_var += weight * diff * diff;</span><br><span class="line">            sum_var_w += weight;</span><br><span class="line">        &#125;</span><br><span class="line">        sigma = libm::<span class="title function_ invoke__">sqrt</span>(sum_var / sum_var_w);</span><br><span class="line">        <span class="keyword">if</span> sigma &lt; <span class="number">1e-6</span> &#123;</span><br><span class="line">            sigma = <span class="number">1e-6</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mu;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç†è®ºä¸Šè®¤ä¸ºï¼Œæˆ‘ä»¬åªè¦æœ‰äº†ä¸€ç»„<strong>åŠæ—¶</strong>æµ‹å¾—çš„ ADC å€¼æ•°æ®ï¼Œé€šè¿‡è¯¥æ»¤æ³¢ç®—æ³•ï¼Œå¯ä»¥è·å–ä¸€ä¸ªç›¸è¾ƒäºç›´æ¥è®¡ç®—å‡å€¼æ›´åŠ æ¥è¿‘çœŸå®å€¼çš„ä¼°è®¡å€¼ã€‚</p><h3 id="å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®å¹¶æ§åˆ¶è½¬å‘"><a href="#å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®å¹¶æ§åˆ¶è½¬å‘" class="headerlink" title="å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®å¹¶æ§åˆ¶è½¬å‘"></a>å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®å¹¶æ§åˆ¶è½¬å‘</h3><p>ä¸ºäº†æŒç»­åŒ–å­˜å‚¨æ¯æ¬¡ä¼ æ„Ÿå™¨è¯»å–çš„æ•°æ®ï¼Œåœ¨æ•´ä¸ªä¸»å¾ªç¯å‰é¢ï¼Œæˆ‘ä»¬åŠ å…¥ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc_value_right_buffer</span> = [<span class="number">0_i32</span>; <span class="number">33</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc_value_left_buffer</span> = [<span class="number">0_i32</span>; <span class="number">33</span>];</span><br></pre></td></tr></table></figure><p>ä½œä¸ºä¼ æ„Ÿå™¨å€¼çš„ç¼“å†²åŒºã€‚ä¸ºäº†èƒ½å¤ŸçœŸæ­£åšåˆ°<strong>åŠæ—¶</strong>è¯»å–æ•°æ®ï¼Œæˆ‘ä»¬åœ¨ä¸»å¾ªç¯ä¸­å†åŠ å…¥ä¸€ä¸ªå¾ªç¯ï¼Œä½¿å¾—åœ¨ä¸»å¾ªç¯çš„ä¸€æ¬¡å¾ªç¯ä¹‹ä¸‹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥è·çŸ¥æœ€æ–°çš„æ•°æ®ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">33</span>).<span class="title function_ invoke__">rev</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">adc_value_right</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch4_pa4).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">adc_value_left</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch15_pc5).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    adc_value_right_buffer[i] = adc_value_right;</span><br><span class="line">    adc_value_left_buffer[i] = adc_value_left;</span><br><span class="line">    <span class="title function_ invoke__">send_adc</span>(&amp;<span class="keyword">mut</span> serial, adc_value_right <span class="keyword">as</span> <span class="type">f64</span>, adc_value_left <span class="keyword">as</span> <span class="type">f64</span>);</span><br><span class="line">    delay.<span class="title function_ invoke__">delay_us</span>(<span class="number">33_u32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¡ç®—é«˜æ–¯æ»¤æ³¢åçš„å€¼</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">filtered_right</span> = gauss::<span class="title function_ invoke__">gauss_filter</span>(&amp;adc_value_right_buffer, <span class="number">16</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">filtered_left</span> = gauss::<span class="title function_ invoke__">gauss_filter</span>(&amp;adc_value_left_buffer, <span class="number">16</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>send_adc</code> å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨<code>/src/utils.rs</code> ä¸­ç»™å‡ºäº†å®šä¹‰ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">send_adc</span>&lt;W&gt;(serial : &amp;<span class="keyword">mut</span> W, adc_right : <span class="type">f64</span>, adc_left : <span class="type">f64</span>)</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    W: _embedded_hal_serial_Write&lt;<span class="type">u8</span>&gt; + core::fmt::Write</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tail</span> : [<span class="type">u8</span>; <span class="number">4</span>]  = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x7f</span>];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> adc_left.<span class="title function_ invoke__">to_le_bytes</span>().<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> adc_right.<span class="title function_ invoke__">to_le_bytes</span>().<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> tail.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨äºå‘è°ƒè¯•ä¸²å£å‘é€æ¯ä¸€æ¬¡è¯»å–çš„ ADC å€¼æ•°æ®ï¼Œä»¥ä¾¿è°ƒè¯•ã€‚</p><p>é€šè¿‡å®é™…æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°ï¼šç”µæ„Ÿè·ç¦»èµ›é“ä¸­å¿ƒè¶Šè¿‘ï¼ŒADC å€¼è¶Šå¤§ï¼Œåä¹‹è¶Šå°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å·¦å³ ADC å€¼çš„å·®å€¼æ¥è¿‘ä¼¼æè¿°å°è½¦ç›¸å¯¹äºèµ›é“çš„åè½¬ç¨‹åº¦ï¼Œå†åˆ©ç”¨è¿™ä¸ª ADC å€¼å¯¹èˆµæœºçš„ç›¸å¯¹ä¸­å€¼å–ä¸€ä¸ªç‰¹æ®Šçš„åå·®ï¼Œä»è€Œå®ç°å°è½¦çš„æ•´ä½“è½¬å‘ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">diff</span> = (filtered_right - filtered_left) <span class="keyword">as</span> <span class="type">i32</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">steer_pwm_diff</span> = <span class="title function_ invoke__">data_limit</span>(diff <span class="keyword">as</span> <span class="type">f64</span> * <span class="number">0.3</span>, steer_pwm_duty_min <span class="keyword">as</span> <span class="type">f64</span>, steer_pwm_duty_max <span class="keyword">as</span> <span class="type">f64</span>) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">steer_pwm_duty</span> = steer_pwm_duty_center - steer_pwm_diff; </span><br><span class="line"><span class="comment">// è®¾ç½®èˆµæœº PWM å ç©ºæ¯”</span></span><br><span class="line">steer_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C3, (steer_pwm_duty / <span class="number">9999</span>) * steer_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>data_limit</code> å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå€¼é™å®šäºæŸä¸¤ä¸ªå€¼ä¹‹é—´ã€‚å…¶åœ¨<code>/src/utils.rs</code> ä¸­å®šä¹‰ä¸ºï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">data_limit</span>(x: <span class="type">f64</span>, min: <span class="type">f64</span>, max: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x &lt; min &#123;</span><br><span class="line">        min</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> x &gt; max &#123;</span><br><span class="line">        max</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        x</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ§åˆ¶å·¦å³è½®çš„è½¬é€Ÿ"><a href="#æ§åˆ¶å·¦å³è½®çš„è½¬é€Ÿ" class="headerlink" title="æ§åˆ¶å·¦å³è½®çš„è½¬é€Ÿ"></a>æ§åˆ¶å·¦å³è½®çš„è½¬é€Ÿ</h3><p>åœ¨æˆ‘ä»¬çš„åŸºæœ¬è®¾è®¡ä¸­ï¼Œä½¿èƒ½å¼€å…³ç”¨äºæ§åˆ¶å·¦å³è½®æ˜¯å¦è½¬åŠ¨ã€‚æˆ‘ä»¬è¯•å›¾å»ºç«‹ä¸€ä¸ªæ–°çš„â€œç›¸å¯¹è½¬é€Ÿâ€ï¼Œä½¿å¾—å·¦å³è½®çš„é€Ÿåº¦èƒ½å¤Ÿä»¥ä¸€ç§ç›´è§‚çš„æ•°å­—è¢«æè¿°å‡ºæ¥ï¼Œä¸ºæ­£æ—¶åˆ™æ­£è½¬ï¼Œåä¹‹åˆ™åè½¬ï¼Œä¸”è¿™ä¸ªæ•°å­—ä¸è¾“å‡ºçš„ PWM å€¼å¯ä»¥ä¸€ä¸€å¯¹åº”ã€‚æˆ‘ä»¬ä»¤ç›¸å¯¹è½¬é€Ÿçš„ç»å¯¹å€¼çš„æœ€å¤§å€¼ä¸º 4800ï¼Œè¡¨ç¤ºæœ€å¤§è½¬é€Ÿï¼›0 åˆ™è¡¨ç¤ºåœè½¬ã€‚å½“ä½¿èƒ½å¼€å…³æ‰“åˆ°äº†é«˜ç”µå¹³æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå°è½¦å¼€æœºï¼Œè½®å­åº”å½“è½¬èµ·æ¥ï¼›åä¹‹å°è½¦å…³æœºï¼Œè½®å­åœè½¬ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheel_speed_left</span> = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheel_speed_right</span> = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// æ ¹æ®ä½¿èƒ½å¼€å…³çŠ¶æ€æ§åˆ¶è¾“å‡º</span></span><br><span class="line"><span class="keyword">if</span> enable_switch_pa12.<span class="title function_ invoke__">is_high</span>() &#123;</span><br><span class="line">    wheel_speed_left = <span class="number">800</span>;</span><br><span class="line">    wheel_speed_right = <span class="number">800</span>;</span><br><span class="line">    enable_out_pc13.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    enable_out_pc13.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸”æˆ‘ä»¬å‘ç°ï¼Œä¸¤è½®çš„ç”µæœºè½¬å‘æ˜¯ç”±ä¸€ä¸ªâ€œå¼€å…³çŠ¶æ€â€æ¥æ§åˆ¶çš„ï¼Œå½“è¾“å…¥ä½ç”µå¹³æ—¶ä¸ºæ­£è½¬ï¼Œåä¹‹ä¸ºåè½¬ï¼Œä¸”åè½¬æ—¶çš„ç›¸å¯¹è½¬é€Ÿçš„ç»å¯¹å€¼ä¸æ­£è½¬æ—¶çš„äº’è¡¥ï¼ˆå³å’Œä¸º4800ï¼‰ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">wheel_left_pwm</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">wheel_right_pwm</span>;</span><br><span class="line"><span class="keyword">if</span> wheel_speed_left &gt;= <span class="number">0</span> &#123;</span><br><span class="line">    wheel_left_pwm = wheel_speed_left <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">    left_wheel_pb8.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    wheel_left_pwm = (<span class="number">4800</span> + wheel_speed_left) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">    left_wheel_pb8.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> wheel_speed_right &gt;= <span class="number">0</span> &#123;</span><br><span class="line">    wheel_right_pwm = wheel_speed_right <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">    right_wheel_pb9.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    wheel_right_pwm = (<span class="number">4800</span> + wheel_speed_right) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">    right_wheel_pb9.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¾ç½®å·¦å³è½® PWM å ç©ºæ¯”</span></span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C2, (wheel_left_pwm / <span class="number">4800</span>) * wheels_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line">wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C1, (wheel_right_pwm / <span class="number">4800</span>) * wheels_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æ‹¨ç å¼€å…³æ§åˆ¶æ¿è½½-LED"><a href="#ä½¿ç”¨æ‹¨ç å¼€å…³æ§åˆ¶æ¿è½½-LED" class="headerlink" title="ä½¿ç”¨æ‹¨ç å¼€å…³æ§åˆ¶æ¿è½½ LED"></a>ä½¿ç”¨æ‹¨ç å¼€å…³æ§åˆ¶æ¿è½½ LED</h3><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥è¯»å–æ‹¨ç å¼€å…³çš„ç”µå¹³å€¼ï¼Œä»è€Œå†³å®š LED çš„ç”µå¹³å€¼ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡æ‹¨ç å¼€å…³è°ƒæ•´æ¿å­ä¸Š LED ç¯çš„äº®ç­</span></span><br><span class="line"><span class="keyword">if</span> switch1.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">    led1_pa11.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    led1_pa11.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> switch2.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">    led2_pa15.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    led2_pa15.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> switch3.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">    led3_pc12.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    led3_pc12.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> switch4.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">    led4_pb3.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    led4_pb3.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤§åŠŸå‘Šæˆï¼"><a href="#å¤§åŠŸå‘Šæˆï¼" class="headerlink" title="å¤§åŠŸå‘Šæˆï¼"></a>å¤§åŠŸå‘Šæˆï¼</h2><p>æ•´ä¸ªå·¥ç¨‹çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><p><code>/src/main.rs</code> </p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#![no_std]</span></span><br><span class="line"><span class="meta">#![no_main]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">mod</span> gauss;</span><br><span class="line"><span class="keyword">mod</span> utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> cortex_m_rt::entry;</span><br><span class="line"><span class="keyword">use</span> panic_halt <span class="keyword">as</span> _;</span><br><span class="line"><span class="keyword">use</span> stm32f1xx_hal::&#123;adc, pac::&#123;<span class="keyword">self</span>&#125;, prelude::*, serial::Config, timer::&#123;Channel, Tim3NoRemap, Tim4NoRemap&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> crate::utils::&#123;data_limit, send_adc&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[entry]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() <span class="punctuation">-&gt;</span> ! &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">steer_pwm_duty_center</span>: <span class="type">u16</span> = <span class="number">750</span> - <span class="number">5</span>; <span class="comment">// èˆµæœº PWM ä¸­å€¼</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">steer_pwm_duty_max</span> = steer_pwm_duty_center + <span class="number">60</span>; <span class="comment">// èˆµæœº PWM æœ€å¤§å€¼</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">steer_pwm_duty_min</span> = steer_pwm_duty_center - <span class="number">60</span>; <span class="comment">// èˆµæœº PWM æœ€å°å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹¿åˆ°ç¡¬ä»¶å¤–è®¾æŠ½è±¡å±‚å¥æŸ„</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">dp</span> = pac::Peripherals::<span class="title function_ invoke__">take</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">cp</span> = cortex_m::Peripherals::<span class="title function_ invoke__">take</span>().<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="comment">// æ‹¿åˆ°RCCæ—¶é’Ÿå¥æŸ„</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">rcc</span> = dp.RCC.<span class="title function_ invoke__">constrain</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">afio</span> = dp.AFIO.<span class="title function_ invoke__">constrain</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line">    <span class="comment">// æ‹¿åˆ°å»¶æ—¶å®šæ—¶å™¨å¥æŸ„</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">delay</span> = cp.SYST.<span class="title function_ invoke__">delay</span>(&amp;rcc.clocks);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GPIO å¼€å¯</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpioa</span> = dp.GPIOA.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpiob</span> = dp.GPIOB.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">gpioc</span> = dp.GPIOC.<span class="title function_ invoke__">split</span>(&amp;<span class="keyword">mut</span> rcc);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Release PB3 from JTAG to use it as GPIO</span></span><br><span class="line">    <span class="keyword">let</span> (pa15_released, pb3_released, _) =</span><br><span class="line">        afio.mapr.<span class="title function_ invoke__">disable_jtag</span>(gpioa.pa15, gpiob.pb3, gpiob.pb4);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1</span> = adc::Adc::<span class="title function_ invoke__">new</span>(dp.ADC1, &amp;<span class="keyword">mut</span> rcc);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1_ch4_pa4</span> = gpioa.pa4.<span class="title function_ invoke__">into_analog</span>(&amp;<span class="keyword">mut</span> gpioa.crl);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc1_ch15_pc5</span> = gpioc.pc5.<span class="title function_ invoke__">into_analog</span>(&amp;<span class="keyword">mut</span> gpioc.crl);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®å››ä¸ªæ‹¨ç å¼€å…³ä¸ºæ¨æŒ½è¾“å…¥</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">switch1</span> = gpioa.pa8.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">switch2</span> = gpioc.pc9.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">switch3</span> = gpioc.pc8.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">switch4</span> = gpioc.pc7.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioc.crl);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led1_pa11</span> = gpioa.pa11.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led2_pa15</span> = pa15_released.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led3_pc12</span> = gpioc.pc12.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">led4_pb3</span> = pb3_released.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®ä½¿èƒ½å¼€å…³ä¸ºæ¨æŒ½è¾“å…¥</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">enable_switch_pa12</span> = gpioa.pa12.<span class="title function_ invoke__">into_pull_up_input</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">enable_out_pc13</span> = gpioc.pc13.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpioc.crh);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°† PB0 é…ç½®ä¸º TIM3_CH3 å¤ç”¨æ¨æŒ½è¾“å‡º</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tim3_ch3</span> = gpiob.pb0.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line">    <span class="comment">// é…ç½® TIM3 ä¸º PWM è¾“å‡ºï¼Œé¢‘ç‡ 1kHz</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">steer_pwm</span> = </span><br><span class="line">    dp.TIM3.pwm_hz::&lt;Tim3NoRemap, _, _&gt;(</span><br><span class="line">        tim3_ch3,</span><br><span class="line">        &amp;<span class="keyword">mut</span> afio.mapr,</span><br><span class="line">        <span class="number">1</span>.<span class="title function_ invoke__">kHz</span>(),</span><br><span class="line">        &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// è®¾ç½®å ç©ºæ¯”ä¸º èˆµæœº PWM ä¸­å€¼</span></span><br><span class="line">    steer_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C3, (steer_pwm_duty_center / <span class="number">9999</span>) * steer_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line">    <span class="comment">// ä½¿èƒ½èˆµæœº PWM è¾“å‡º</span></span><br><span class="line">    steer_pwm.<span class="title function_ invoke__">enable</span>(Channel::C3);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½®å·¦å³è½®æ§åˆ¶æµè¾“å‡º</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">left_wheel_pb8</span> = gpiob.pb8.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">right_wheel_pb9</span> = gpiob.pb9.<span class="title function_ invoke__">into_push_pull_output</span>(&amp;<span class="keyword">mut</span> gpiob.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tim4_ch1</span> = gpiob.pb6.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tim4_ch2</span> = gpiob.pb7.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpiob.crl);</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheels_pwm</span> = </span><br><span class="line">    dp.TIM4.pwm_hz::&lt;Tim4NoRemap, _, _&gt;(</span><br><span class="line">        (tim4_ch1, tim4_ch2),</span><br><span class="line">        &amp;<span class="keyword">mut</span> afio.mapr,</span><br><span class="line">        <span class="number">1</span>.<span class="title function_ invoke__">kHz</span>(),</span><br><span class="line">        &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">    );</span><br><span class="line">    wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C2, <span class="number">0</span>);</span><br><span class="line">    wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C1, <span class="number">0</span>);</span><br><span class="line">    wheels_pwm.<span class="title function_ invoke__">enable</span>(Channel::C2);</span><br><span class="line">    wheels_pwm.<span class="title function_ invoke__">enable</span>(Channel::C1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…ç½® USART ä¸²å£é€šè¿‡ JustFloat åè®®è¾“å‡º ADC å€¼ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">usart1_tx</span> = gpioa.pa9.<span class="title function_ invoke__">into_alternate_push_pull</span>(&amp;<span class="keyword">mut</span> gpioa.crh);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">usart1_rx</span> = gpioa.pa10;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">serial</span> = dp.USART1</span><br><span class="line">        .<span class="title function_ invoke__">serial</span>(</span><br><span class="line">            (usart1_tx, usart1_rx),</span><br><span class="line">            Config::<span class="title function_ invoke__">default</span>().<span class="title function_ invoke__">baudrate</span>(<span class="number">115200</span>.<span class="title function_ invoke__">bps</span>()),</span><br><span class="line">            &amp;<span class="keyword">mut</span> rcc</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc_value_right_buffer</span> = [<span class="number">0_i32</span>; <span class="number">33</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">adc_value_left_buffer</span> = [<span class="number">0_i32</span>; <span class="number">33</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="comment">// è¯»å– ADC å€¼å…¥ç¼“å†²åŒº</span></span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> (<span class="number">1</span>..<span class="number">33</span>).<span class="title function_ invoke__">rev</span>() &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">adc_value_right</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch4_pa4).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">adc_value_left</span> = adc1.<span class="title function_ invoke__">read</span>(&amp;<span class="keyword">mut</span> adc1_ch15_pc5).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">            adc_value_right_buffer[i] = adc_value_right;</span><br><span class="line">            adc_value_left_buffer[i] = adc_value_left;</span><br><span class="line">            <span class="title function_ invoke__">send_adc</span>(&amp;<span class="keyword">mut</span> serial, adc_value_right <span class="keyword">as</span> <span class="type">f64</span>, adc_value_left <span class="keyword">as</span> <span class="type">f64</span>);</span><br><span class="line">            delay.<span class="title function_ invoke__">delay_us</span>(<span class="number">33_u32</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¡ç®—é«˜æ–¯æ»¤æ³¢åçš„å€¼</span></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">filtered_right</span> = gauss::<span class="title function_ invoke__">gauss_filter</span>(&amp;adc_value_right_buffer, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">filtered_left</span> = gauss::<span class="title function_ invoke__">gauss_filter</span>(&amp;adc_value_left_buffer, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">diff</span> = (filtered_right - filtered_left) <span class="keyword">as</span> <span class="type">i32</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">steer_pwm_diff</span> = </span><br><span class="line">        <span class="title function_ invoke__">data_limit</span>(diff <span class="keyword">as</span> <span class="type">f64</span> * <span class="number">0.3</span>, steer_pwm_duty_min <span class="keyword">as</span> <span class="type">f64</span>, steer_pwm_duty_max <span class="keyword">as</span> <span class="type">f64</span>) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">steer_pwm_duty</span> = steer_pwm_duty_center - steer_pwm_diff; </span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®èˆµæœº PWM å ç©ºæ¯”</span></span><br><span class="line">        steer_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C3, (steer_pwm_duty / <span class="number">9999</span>) * steer_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheel_speed_left</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">wheel_speed_right</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// æ ¹æ®ä½¿èƒ½å¼€å…³çŠ¶æ€æ§åˆ¶è¾“å‡º</span></span><br><span class="line">        <span class="keyword">if</span> enable_switch_pa12.<span class="title function_ invoke__">is_high</span>() &#123;</span><br><span class="line">            wheel_speed_left = <span class="number">800</span>;</span><br><span class="line">            wheel_speed_right = <span class="number">800</span>;</span><br><span class="line">            enable_out_pc13.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            enable_out_pc13.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">wheel_left_pwm</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">wheel_right_pwm</span>;</span><br><span class="line">        <span class="keyword">if</span> wheel_speed_left &gt;= <span class="number">0</span> &#123;</span><br><span class="line">            wheel_left_pwm = wheel_speed_left <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">            left_wheel_pb8.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            wheel_left_pwm = (<span class="number">4800</span> + wheel_speed_left) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">            left_wheel_pb8.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> wheel_speed_right &gt;= <span class="number">0</span> &#123;</span><br><span class="line">            wheel_right_pwm = wheel_speed_right <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">            right_wheel_pb9.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            wheel_right_pwm = (<span class="number">4800</span> + wheel_speed_right) <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">            right_wheel_pb9.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®¾ç½®å·¦å³è½® PWM å ç©ºæ¯”</span></span><br><span class="line">        wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C2, (wheel_left_pwm / <span class="number">4800</span>) * wheels_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line">        wheels_pwm.<span class="title function_ invoke__">set_duty</span>(Channel::C1, (wheel_right_pwm / <span class="number">4800</span>) * wheels_pwm.<span class="title function_ invoke__">get_max_duty</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡æ‹¨ç å¼€å…³è°ƒæ•´æ¿å­ä¸Š LED ç¯çš„äº®ç­</span></span><br><span class="line">        <span class="keyword">if</span> switch1.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">            led1_pa11.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            led1_pa11.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> switch2.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">            led2_pa15.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            led2_pa15.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> switch3.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">            led3_pc12.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            led3_pc12.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> switch4.<span class="title function_ invoke__">is_low</span>() &#123;</span><br><span class="line">            led4_pb3.<span class="title function_ invoke__">set_high</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            led4_pb3.<span class="title function_ invoke__">set_low</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>/src/utils.rs</code> </p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> cortex_m::prelude::_embedded_hal_serial_Write;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">data_limit</span>(x: <span class="type">f64</span>, min: <span class="type">f64</span>, max: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x &lt; min &#123;</span><br><span class="line">        min</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> x &gt; max &#123;</span><br><span class="line">        max</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        x</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[inline(always)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">quicksort</span>(arr: &amp;<span class="keyword">mut</span> [<span class="type">i32</span>]) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">len</span> = arr.<span class="title function_ invoke__">len</span>();</span><br><span class="line">    <span class="keyword">if</span> len &lt;= <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">pivot</span> = arr[len - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">i</span> = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> <span class="variable">j</span> <span class="keyword">in</span> <span class="number">0</span>..len - <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> arr[j] &lt;= pivot &#123;</span><br><span class="line">            arr.<span class="title function_ invoke__">swap</span>(i, j);</span><br><span class="line">            i += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    arr.<span class="title function_ invoke__">swap</span>(i, len - <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> arr[<span class="number">0</span>..i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> i + <span class="number">1</span> &lt; len &#123;</span><br><span class="line">        <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> arr[i+<span class="number">1</span>..]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">send_adc</span>&lt;W&gt;(serial : &amp;<span class="keyword">mut</span> W, adc_right : <span class="type">f64</span>, adc_left : <span class="type">f64</span>)</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    W: _embedded_hal_serial_Write&lt;<span class="type">u8</span>&gt; + core::fmt::Write</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tail</span> : [<span class="type">u8</span>; <span class="number">4</span>]  = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x7f</span>];</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> adc_left.<span class="title function_ invoke__">to_le_bytes</span>().<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> adc_right.<span class="title function_ invoke__">to_le_bytes</span>().<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">byte</span> <span class="keyword">in</span> tail.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">        serial.<span class="title function_ invoke__">write</span>(*byte).<span class="title function_ invoke__">ok</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>/src/gauss.rs</code> </p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> crate::utils::quicksort;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">gauss_filter</span>(x: &amp;[<span class="type">i32</span>], n: <span class="type">usize</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x[<span class="number">0</span>] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ•°ç»„æ¥å­˜å‚¨æ’åºåçš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sorted</span> = [<span class="number">0i32</span>; <span class="number">64</span>]; <span class="comment">// å‡è®¾æœ€å¤§é•¿åº¦ä¸º64ï¼Œæ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´</span></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        sorted[i] = x[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">quicksort</span>(&amp;<span class="keyword">mut</span> sorted[<span class="number">0</span>..n]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- åˆå§‹ä¼°è®¡ ---</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        sum += sorted[i] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">mu</span> = sum / (n <span class="keyword">as</span> <span class="type">f64</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">var</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">diff</span> = sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu;</span><br><span class="line">        var += diff * diff;</span><br><span class="line">    &#125;</span><br><span class="line">    var /= (n - <span class="number">1</span>) <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sigma</span>: <span class="type">f64</span> = libm::<span class="title function_ invoke__">sqrt</span>(var);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sigma &lt; <span class="number">1e-6</span> &#123;</span><br><span class="line">        sigma = <span class="number">1e-6</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- è¿­ä»£æ›´æ–° ---</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">max_iter</span> = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tol</span> = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_iter</span> <span class="keyword">in</span> <span class="number">0</span>..max_iter &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_w</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_wx</span>: <span class="type">f64</span> = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">diff</span>: <span class="type">f64</span> = (sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu) / sigma;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">exponent</span>: <span class="type">f64</span> = -<span class="number">0.5</span> * diff * diff;</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">weight</span> = libm::<span class="title function_ invoke__">exp</span>(exponent);</span><br><span class="line">            <span class="keyword">if</span> weight &lt; <span class="number">1e-10</span> &#123;</span><br><span class="line">                weight = <span class="number">1e-10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            sum_w += weight;</span><br><span class="line">            sum_wx += weight * sorted[i] <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> <span class="variable">new_mu</span> = sum_wx / sum_w;</span><br><span class="line">        <span class="keyword">if</span> libm::<span class="title function_ invoke__">fabs</span>(new_mu - mu) &lt; tol &#123;</span><br><span class="line">            mu = new_mu;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mu = new_mu;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ›´æ–° sigma</span></span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_var</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">sum_var_w</span> = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">0</span>..n &#123;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">diff</span> = sorted[i] <span class="keyword">as</span> <span class="type">f64</span> - mu;</span><br><span class="line">            <span class="keyword">let</span> <span class="variable">exponent</span> = -<span class="number">0.5</span> * (diff / sigma) * (diff / sigma);</span><br><span class="line">            <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">weight</span> = libm::<span class="title function_ invoke__">exp</span>(exponent);</span><br><span class="line">            <span class="keyword">if</span> weight &lt; <span class="number">1e-10</span> &#123;</span><br><span class="line">                weight = <span class="number">1e-10</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sum_var += weight * diff * diff;</span><br><span class="line">            sum_var_w += weight;</span><br><span class="line">        &#125;</span><br><span class="line">        sigma = libm::<span class="title function_ invoke__">sqrt</span>(sum_var / sum_var_w);</span><br><span class="line">        <span class="keyword">if</span> sigma &lt; <span class="number">1e-6</span> &#123;</span><br><span class="line">            sigma = <span class="number">1e-6</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> mu;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±è¿™ä¸ªå·¥ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šä½¿ç”¨ Rust å¼€å‘çš„å•ç‰‡æœºç¨‹åºï¼Œåœ¨æºä»£ç æ–¹é¢ï¼Œå¤§å¤§æå‡äº†ä»£ç çš„å¯è¯»æ€§ã€‚Rust çš„ HAL åº“çš„æŠ½è±¡ç¨‹åº¦è¿œé«˜äº C çš„ HAL åº“ï¼Œå› æ­¤ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ Rust æ— ç–‘æ˜¯æå…¶æ–¹ä¾¿çš„ã€‚ä¸” Rust çš„å„ä¸ªåµŒå…¥å¼åº“æ—¥è¶‹æˆç†Ÿï¼Œæ ‘è“æ´¾ Pico å·²ç»å°† Rust åˆ—ä¸ºäº†å’Œ C&#x2F;C++ï¼Œ MicroPython ç­‰åŒçº§çš„è¯­è¨€ã€‚åœ¨åµŒå…¥å¼æ–¹é¢ï¼ŒRust çš„å‘å±•æ— ç–‘æ˜¯å¦‚æ—¥ä¸­å¤©çš„ã€‚ä½†æ˜¯ï¼Œåœ¨é…ç½®æ–¹é¢ï¼ŒRust çš„é…ç½®ä»ç„¶ç›¸å¯¹è¾ƒä¸ºéº»çƒ¦ï¼Œæ²¡æœ‰ç±»ä¼¼äº CubeMX çš„å·¥å…·ï¼Œåœ¨è¿™æ–¹é¢ï¼ŒRust ä»ç„¶æ˜¯å…·æœ‰å¾ˆå¤§çš„çªç ´ç©ºé—´çš„ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>[1] <a href="https://github.com/stm32-rs/stm32f1xx-hal/tree/master/examples">stm32f1xx-hal&#x2F;examples</a> Rust åµŒå…¥å¼å®˜æ–¹ä¾‹ç¨‹ï¼›</p><p>[2] <a href="https://doc.rust-lang.net.cn/stable/embedded-book/intro/index.html">doc.rust-lang.net&#x2F;stable&#x2F;embedded-book</a> åµŒå…¥å¼ Rust Book</p><p>[3] <a href="https://zhuanlan.zhihu.com/p/416497709">zhuanlan.zhihu.com</a> Rust åµŒå…¥å¼å¼€å‘ STM32 &amp; RISC-V</p><p>[4] <a href="https://kaisery.github.io/trpl-zh-cn/">kaisery.github.io</a> Rust ç¨‹åºè®¾è®¡è¯­è¨€ - ç®€ä½“ä¸­æ–‡ç‰ˆ</p><p>[5] ChatGPTã€Geminiã€GitHub Copilot ç­‰ AI å·¥å…·ğŸ˜‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™ç¯‡ Blog å°†ç€é‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Rust è¯­è¨€å·¥å…·é“¾é…ç½® STM32 åµŒå…¥å¼å¼€å‘ç¯å¢ƒï¼Œå¹¶å°†æŒ‡å¯¼æ‚¨ä½¿ç”¨ Rust ç¼–å†™ä¸€ä¸ªç®€æ˜“çš„ã€åŸºäºç”µç£ä¼ æ„Ÿå™¨å¾ªè¿¹çš„æ™ºèƒ½è½¦ç¨‹åºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ğŸ’¡ è¿™é‡Œæ‰€ä½¿ç”¨çš„å•ç‰‡æœºèŠ¯ç‰‡ä¸º &lt;code&gt;STM32F103RCT</summary>
      
    
    
    
    
    <category term="Rust" scheme="https://redstone6835.github.io/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>sys_brk</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-brk/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-brk/</id>
    <published>2025-11-12T14:30:14.000Z</published>
    <updated>2025-11-16T16:21:53.447Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_brk</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>12</code>çš„<code>brk</code>ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯Linuxä¸­ä¸€ä¸ªç”¨äºåŠ¨æ€å†…å­˜ç®¡ç†çš„æ ¸å¿ƒç³»ç»Ÿè°ƒç”¨ã€‚å®ƒç›´æ¥æ“ä½œè¿›ç¨‹çš„<strong>ç¨‹åºä¸­æ–­ç‚¹ï¼ˆprogram breakï¼‰</strong>ï¼Œå³å †ï¼ˆheapï¼‰çš„ç»“æŸåœ°å€ã€‚é€šè¿‡æ”¹å˜è¿™ä¸ªä¸­æ–­ç‚¹çš„ä½ç½®ï¼Œç¨‹åºå¯ä»¥åŠ¨æ€åœ°å¢åŠ æˆ–å‡å°‘å…¶æ•°æ®æ®µçš„å¤§å°ã€‚å°½ç®¡ç°ä»£Cåº“ï¼ˆå¦‚<code>glibc</code>ï¼‰é€šå¸¸ä½¿ç”¨<code>mmap</code>æ¥å®ç°æ›´çµæ´»çš„å†…å­˜åˆ†é…ï¼ˆå¦‚<code>malloc</code>ï¼‰ï¼Œä½†åœ¨åº•å±‚ï¼Œ<code>sys_brk</code>ä»ç„¶æ˜¯æ‰©å±•å †ç©ºé—´çš„åŸºæœ¬æœºåˆ¶ã€‚äº†è§£<code>sys_brk</code>æœ‰åŠ©äºç†è§£è¿›ç¨‹åœ°å€ç©ºé—´çš„å¸ƒå±€ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿå¦‚ä½•ä¸ºç¨‹åºæä¾›å¯å˜å¤§å°çš„å†…å­˜åŒºåŸŸã€‚</p><ul><li><p><code>sys_brk</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">brk</span><span class="params">(<span class="type">void</span> *addr)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>addr</code>: æ–°çš„ç¨‹åºä¸­æ–­ç‚¹åœ°å€ã€‚å¦‚æœè¯¥åœ°å€æ¯”å½“å‰ä¸­æ–­ç‚¹é«˜ï¼Œåˆ™æ‰©å¤§å †ï¼›å¦‚æœæ¯”å½“å‰ä¸­æ–­ç‚¹ä½ï¼Œåˆ™ç¼©å°å †ã€‚å¦‚æœä¼ å…¥<code>0</code>ï¼Œç³»ç»Ÿè°ƒç”¨ä¼šè¿”å›å½“å‰ç¨‹åºä¸­æ–­ç‚¹çš„åœ°å€ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›æ–°ç¨‹åºä¸­æ–­ç‚¹åœ°å€ï¼ˆå³å‚æ•°<code>addr</code>ï¼‰ã€‚ä½†å¯¹äºç°ä»£<code>x86_64 Linux</code>ï¼Œä¸ºäº†ä¸æ—§ç‰ˆå†…æ ¸å…¼å®¹ï¼Œè¿”å›å€¼åœ¨<code>rax</code>ä¸­ä¼šæ˜¯<code>0</code>ï¼Œå¤±è´¥æ—¶ä¼šæ˜¯<code>1</code>ã€‚</li><li>å¤±è´¥æ—¶è¿”å›<code>-1</code>ï¼Œå¹¶è®¾ç½®<code>errno</code>ï¼ˆå¦‚<code>ENOMEM</code>ï¼‰ã€‚</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">.equ SYS_BRK, 12</span><br><span class="line">.equ SYS_WRITE, 1</span><br><span class="line">.equ SYS_EXIT, 60</span><br><span class="line">.equ STDOUT, 1</span><br><span class="line">.equ PAGE_SIZE, 4096</span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">initial_brk:</span><br><span class="line">.quad 0x0</span><br><span class="line"></span><br><span class="line">message:</span><br><span class="line">.ascii &quot;New memory allocated with sys_brk.\n\0&quot;</span><br><span class="line">msg_len = . - message</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"># è·å–å½“å‰ç¨‹åºä¸­æ–­ç‚¹åœ°å€</span><br><span class="line">mov $SYS_BRK, %rax</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># æ£€æŸ¥è¿”å›å€¼ä»¥ç¡®ä¿æˆåŠŸ</span><br><span class="line">cmp $0, %rax</span><br><span class="line">je exit_error</span><br><span class="line"></span><br><span class="line"># å°†å½“å‰ä¸­æ–­ç‚¹åœ°å€ä¿å­˜èµ·æ¥</span><br><span class="line">mov %rax, initial_brk(%rip)</span><br><span class="line"></span><br><span class="line"># è®¡ç®—æ–°çš„ä¸­æ–­ç‚¹åœ°å€ï¼ˆå¢åŠ ä¸€ä¸ªé¡µå¤§å°ï¼‰</span><br><span class="line">add $PAGE_SIZE, %rax</span><br><span class="line"></span><br><span class="line"># è°ƒç”¨ sys_brk æ‰©å±•å †</span><br><span class="line">mov $SYS_BRK, %rax</span><br><span class="line">mov initial_brk(%rip), %rdi</span><br><span class="line">add $PAGE_SIZE, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># æ£€æŸ¥è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥åˆ™é€€å‡º</span><br><span class="line">cmp $0, %rax</span><br><span class="line">jne exit_error</span><br><span class="line"></span><br><span class="line"># å°†æ¶ˆæ¯å¤åˆ¶åˆ°æ–°åˆ†é…çš„å†…å­˜åŒºåŸŸ</span><br><span class="line">mov initial_brk(%rip), %rdi</span><br><span class="line">mov $message, %rsi</span><br><span class="line">mov $msg_len, %rcx</span><br><span class="line">cld</span><br><span class="line">rep movsb</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ sys_write æ‰“å°æ–°å†…å­˜ä¸­çš„æ¶ˆæ¯</span><br><span class="line">mov $SYS_WRITE, %rax</span><br><span class="line">mov $STDOUT, %rdi</span><br><span class="line">mov initial_brk(%rip), %rsi</span><br><span class="line">mov $msg_len, %rdx</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># é€€å‡ºç¨‹åº</span><br><span class="line">exit_success:</span><br><span class="line">mov $SYS_EXIT, %rax</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">exit_error:</span><br><span class="line">mov $SYS_EXIT, %rax</span><br><span class="line">mov $1, %rdi</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>sys_brk</code>ç³»ç»Ÿè°ƒç”¨æ¥åŠ¨æ€åœ°æ‰©å¤§å †å†…å­˜ã€‚</p><p>  é¦–å…ˆï¼Œç¨‹åºé€šè¿‡è°ƒç”¨<code>brk(0)</code>æ¥è·å–å½“å‰çš„ç¨‹åºä¸­æ–­ç‚¹åœ°å€ã€‚åœ¨æ±‡ç¼–ä¸­ï¼Œè¿™æ˜¯é€šè¿‡å°†ç³»ç»Ÿè°ƒç”¨å·<code>12</code>æ”¾å…¥<code>%rax</code>å¹¶å°†<code>%rdi</code>è®¾ç½®ä¸º<code>0</code>æ¥å®Œæˆçš„ã€‚è¿”å›çš„åœ°å€ä¼šä¿å­˜åœ¨<code>%rax</code>ä¸­ï¼Œç¨‹åºå°†å…¶å­˜å‚¨åœ¨<code>initial_brk</code>å˜é‡ä¸­ã€‚</p><p>  æ¥ç€ï¼Œç¨‹åºå°†<code>initial_brk</code>çš„å€¼å¢åŠ ä¸€ä¸ªé¡µé¢å¤§å°ï¼ˆ<code>4096</code>å­—èŠ‚ï¼‰ï¼Œå¾—åˆ°æ–°çš„ä¸­æ–­ç‚¹åœ°å€ã€‚ç„¶åï¼Œå®ƒå†æ¬¡è°ƒç”¨<code>sys_brk</code>ï¼Œå¹¶å°†è¿™ä¸ªæ–°çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ã€‚å¦‚æœè°ƒç”¨æˆåŠŸï¼Œå†…æ ¸ä¼šè°ƒæ•´å †çš„å¤§å°ï¼Œä½¿ç¨‹åºå¯ä»¥ä½¿ç”¨è¿™å—æ–°åˆ†é…çš„å†…å­˜ã€‚</p><p>  æœ€åï¼Œç¨‹åºå°†ä¸€ä¸ªå­—ç¬¦ä¸²æ¶ˆæ¯å¤åˆ¶åˆ°è¿™ä¸ªæ–°åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œå¹¶ä½¿ç”¨<code>sys_write</code>ç³»ç»Ÿè°ƒç”¨å°†å…¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºã€‚è¿™è¯æ˜äº†é€šè¿‡<code>sys_brk</code>åˆ†é…çš„å†…å­˜ç°åœ¨æ˜¯å¯è®¿é—®å’Œå¯å†™å…¥çš„ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_brk&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;12&lt;/code&gt;çš„&lt;code&gt;brk&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯Linuxä¸­ä¸€ä¸ªç”¨äºåŠ¨æ€å†…å­˜ç®¡ç†çš„æ ¸å¿ƒç³»ç»Ÿè°ƒç”¨ã€‚å®ƒç›´æ¥æ“ä½œè¿›ç¨‹çš„&lt;strong&gt;ç¨‹åºä¸­æ–­ç‚¹ï¼ˆprogram breakï¼‰&lt;/strong&gt;ï¼Œå³å †ï¼ˆ</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_mprotect</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-mprotect/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-mprotect/</id>
    <published>2025-11-12T14:30:09.000Z</published>
    <updated>2025-11-16T16:22:37.775Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_mprotect</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>10</code>çš„<code>mprotect</code>ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯Linuxå†…æ ¸æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå…è®¸ç¨‹åºåŠ¨æ€åœ°ä¿®æ”¹å…¶è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æŸä¸ªå†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚è¿™åœ¨å¾ˆå¤šåœºæ™¯ä¸­éƒ½è‡³å…³é‡è¦ï¼Œå¦‚å®ç°<code>JIT</code>ç¼–è¯‘å™¨ã€æ²™ç®±æœºåˆ¶ï¼Œæˆ–è€…é˜²æ­¢æŸäº›ç±»å‹çš„ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚é€šè¿‡è°ƒç”¨<code>sys_mprotect</code>ï¼Œç¨‹åºå¯ä»¥å°†ä¸€æ®µå†…å­˜è®¾ç½®ä¸ºåªè¯»ï¼Œä»¥ä¿æŠ¤é‡è¦æ•°æ®ä¸è¢«æ„å¤–ä¿®æ”¹ï¼›æˆ–è€…å°†ä¸€æ®µå†…å­˜è®¾ç½®ä¸ºå¯æ‰§è¡Œï¼Œä»¥å…è®¸åŠ¨æ€ç”Ÿæˆçš„ä»£ç è¿è¡Œã€‚ç†è§£è¿™ä¸ªç³»ç»Ÿè°ƒç”¨æœ‰åŠ©äºæ·±å…¥ç†è§£ç°ä»£æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†å’Œå®‰å…¨æœºåˆ¶ã€‚</p><ul><li><p><code>sys_mprotect</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mprotect</span><span class="params">(<span class="type">const</span> <span class="type">void</span> *addr, <span class="type">size_t</span> len, <span class="type">int</span> prot)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><p><code>addr</code>: è¦ä¿®æ”¹æƒé™çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ã€‚<strong>è¿™ä¸ªåœ°å€å¿…é¡»æ˜¯é¡µå¯¹é½çš„</strong>ï¼Œå¦åˆ™ç³»ç»Ÿè°ƒç”¨ä¼šå¤±è´¥å¹¶è¿”å›<code>EINVAL</code>é”™è¯¯ã€‚</p></li><li><p><code>len</code>: è¦ä¿®æ”¹æƒé™çš„å†…å­˜åŒºåŸŸçš„é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ã€‚<strong>è¿™ä¸ªé•¿åº¦ä¹Ÿå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€</strong>ã€‚</p></li><li><p><code>prot</code>ï¼šæ˜ å°„åŒºåŸŸçš„è®¿é—®æƒé™ï¼š</p><ul><li><code>PROT_NONE</code>ï¼šé¡µé¢ä¸å¯è®¿é—®</li><li><code>PROT_READ</code>ï¼šé¡µé¢å¯è¯»</li><li><code>PROT_WRITE</code>ï¼šé¡µé¢å¯å†™</li><li><code>PROT_EXEC</code>ï¼šé¡µé¢å¯æ‰§è¡Œ</li><li><code>PROT_SEM</code>ï¼šé¡µé¢å¯ç”¨äºåŸå­æ“ä½œåŒæ­¥ï¼ˆè‡ª Linux 2.5.7 èµ·æ”¯æŒï¼‰</li></ul>  <aside>  ğŸ’¡  <p>  å¤‡æ³¨ï¼š<code>prot</code> å–å€¼çš„å®å®šä¹‰å¦‚ä¸‹ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_NONE       0x0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_READ       0x1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_WRITE      0x2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_EXEC       0x4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_SEM        0x8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_GROWSDOWN  0x01000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_GROWSUP    0x02000000</span></span><br></pre></td></tr></table></figure><p>  å„ä¸ªå®ä¹‹é—´ä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦ <code>|</code> è¿›è¡Œè¿æ¥ã€‚</p>  </aside></li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›<code>0</code>ã€‚</li><li>å¤±è´¥æ—¶è¿”å›<code>-1</code>ï¼Œå¹¶è®¾ç½®<code>errno</code>ï¼ˆå¦‚<code>ENOMEM</code>, <code>EFAULT</code>, <code>EINVAL</code>, <code>EACCES</code>ï¼‰ã€‚</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">.equ SYS_MPROTECT, 10</span><br><span class="line">.equ SYS_EXIT, 60</span><br><span class="line">.equ PROT_READ, 0x01</span><br><span class="line">.equ PROT_READ_WRITE, 0x03</span><br><span class="line">.equ PAGE_SIZE, 4096</span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">.p2align 12  # å¼ºåˆ¶é¡µå¯¹é½</span><br><span class="line">my_page:</span><br><span class="line">.ascii &quot;This is a memory page to be protected.\\n&quot;</span><br><span class="line">.space (PAGE_SIZE - (. - my_page)) # å¡«å……åˆ°é¡µå¤§å°</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"># å°† my_page è®¾ç½®ä¸ºåªè¯»</span><br><span class="line">mov $SYS_MPROTECT, %rax</span><br><span class="line">lea my_page(%rip), %rdi    # addr = &amp;my_page</span><br><span class="line">mov $PAGE_SIZE, %rsi        # len = 4096</span><br><span class="line">mov $PROT_READ, %rdx        # prot = PROT_READ</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># æ£€æŸ¥è¿”å›å€¼ï¼ˆ%raxï¼‰ï¼Œå¦‚æœå¤±è´¥åˆ™é€€å‡º</span><br><span class="line">cmp $0, %rax</span><br><span class="line">jne exit_error</span><br><span class="line"></span><br><span class="line"># è¿™é‡Œå¯ä»¥å°è¯•å‘ my_page ä¸­å†™å…¥å†…å®¹</span><br><span class="line"># call write_page</span><br><span class="line"></span><br><span class="line"># ç°åœ¨å°è¯•å°† my_page è®¾ç½®ä¸ºå¯è¯»å†™</span><br><span class="line">mov $SYS_MPROTECT, %rax</span><br><span class="line">lea my_page(%rip), %rdi    # addr = &amp;my_page</span><br><span class="line">mov $PAGE_SIZE, %rsi        # len = 4096</span><br><span class="line">mov $PROT_READ_WRITE, %rdx  # prot = PROT_READ | PROT_WRITE</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># è¿™é‡Œå¯ä»¥å†æ¬¡å°è¯•å‘ my_page ä¸­å†™å…¥å†…å®¹</span><br><span class="line">call write_page</span><br><span class="line"></span><br><span class="line"># é€€å‡ºç¨‹åº</span><br><span class="line">exit_success:</span><br><span class="line">mov $SYS_EXIT, %rax</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">exit_error:</span><br><span class="line">mov $SYS_EXIT, %rax</span><br><span class="line">mov $1, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># å°è¯•ä¿®æ”¹ my_page è¿™æ®µå†…å­˜ä¸­ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å€¼</span><br><span class="line">write_page:</span><br><span class="line">lea my_page(%rip), %rdi</span><br><span class="line">mov $0, (%rdi)</span><br><span class="line">ret</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>sys_mprotect</code>æ¥åŠ¨æ€æ”¹å˜å†…å­˜åŒºåŸŸçš„æƒé™ã€‚</p><p>  ç¨‹åºé¦–å…ˆåœ¨<code>.data</code>æ®µå®šä¹‰äº†ä¸€ä¸ªåä¸º<code>my_page</code>çš„å†…å­˜åŒºåŸŸï¼Œå¹¶ä½¿ç”¨<code>.p2align 12</code>æŒ‡ä»¤ç¡®ä¿å…¶åœ°å€æ˜¯4096å­—èŠ‚ï¼ˆå³ä¸€ä¸ªå†…å­˜é¡µï¼‰çš„æ•´æ•°å€å¯¹é½ã€‚ç„¶åï¼Œå®ƒç”¨<code>.space</code>æŒ‡ä»¤å¡«å……å‰©ä½™ç©ºé—´ï¼Œä½¿è¯¥åŒºåŸŸæ°å¥½ä¸ºä¸€ä¸ªé¡µçš„å¤§å°ã€‚</p><p>  æ¥ä¸‹æ¥ï¼Œç¨‹åºè°ƒç”¨<code>sys_mprotect</code>ï¼Œå°†<code>my_page</code>çš„åœ°å€åŠ è½½åˆ°<code>%rdi</code>ï¼Œé•¿åº¦<code>PAGE_SIZE</code>åŠ è½½åˆ°<code>%rsi</code>ï¼Œå¹¶å°†æƒé™æ ‡å¿—<code>PROT_READ</code>ï¼ˆåªè¯»ï¼‰åŠ è½½åˆ°<code>%rdx</code>ã€‚æ‰§è¡Œ<code>syscall</code>åï¼Œ<code>my_page</code>è¿™å—å†…å­˜å°†å˜ä¸ºåªè¯»ã€‚</p><p>  å¦‚ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™å°è¯•<code>call write_page</code> ï¼Œä½†æ˜¯ç”±äºå‰é¢å·²ç»å°†è¿™å—ç›®æ ‡å†…å­˜è®¾ç½®ä¸ºåªè¯»ï¼Œä¿®æ”¹æ“ä½œä¸ä¼šç”Ÿæ•ˆï¼Œä¸”ä¼šè§¦å‘æ®µé”™è¯¯<code>SIGSEGV</code> é€ æˆæ•´ä¸ªç¨‹åºçš„å¼ºåˆ¶æ€§å´©æºƒã€‚åä¹‹ï¼Œå¦‚æœæˆ‘ä»¬åœ¨å‰é¢ä¸è°ƒç”¨<code>sys_mprotect</code> ï¼Œè€Œåœ¨è¿™é‡Œå°è¯•<code>call write_page</code> ï¼Œç¨‹åºå¹¶ä¸ä¼šæŠ¥é”™ï¼Œä¸”å¯ä»¥å®ç°å¯¹å†…å­˜çš„æ­£å¸¸ä¿®æ”¹ã€‚</p><p>  åœ¨è¿™ä¹‹åï¼Œç¨‹åºå†æ¬¡è°ƒç”¨<code>sys_mprotect</code>ï¼Œå°†æƒé™æ ‡å¿—æ›´æ–°ä¸º<code>PROT_READ | PROT_WRITE</code>ï¼Œä»è€Œå°†<code>my_page</code>çš„æƒé™ä»åªè¯»ä¿®æ”¹ä¸ºå¯è¯»å†™ã€‚æ­¤æ—¶å†å°è¯•<code>call write_page</code> ï¼Œå‘ç°å†…å­˜å¯ä»¥è¢«æ­£å¸¸ä¿®æ”¹ï¼Œä¸”ä¸ä¼šè§¦å‘æ®µé”™è¯¯ã€‚</p><p>  æ•´ä¸ªè¿‡ç¨‹å±•ç¤ºäº†<code>sys_mprotect</code>å¦‚ä½•çµæ´»åœ°æ§åˆ¶å†…å­˜æƒé™ï¼Œè¿™åœ¨åº•å±‚ç¼–ç¨‹ä¸­éå¸¸æœ‰ç”¨ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_mprotect&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;10&lt;/code&gt;çš„&lt;code&gt;mprotect&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯Linuxå†…æ ¸æä¾›çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œå®ƒå…è®¸ç¨‹åºåŠ¨æ€åœ°ä¿®æ”¹å…¶è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­æŸä¸ªå†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚è¿™åœ¨å¾ˆå¤šåœºæ™¯ä¸­éƒ½è‡³å…³é‡è¦ï¼Œå¦‚å®ç°</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_mmap ä¸ sys_munmap</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-mmap-%E4%B8%8E-sys-munmap/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-mmap-%E4%B8%8E-sys-munmap/</id>
    <published>2025-11-12T14:30:01.000Z</published>
    <updated>2025-11-16T16:22:24.707Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_mmap</code>ï¼ˆè°ƒç”¨å·ä¸º<code>9</code>ï¼‰å’Œ<code>sys_munmap</code> ï¼ˆè°ƒç”¨å·ä¸º<code>11</code>ï¼‰æ˜¯ Linux ä¸­åŠŸèƒ½æœ€å¼ºå¤§çš„å†…å­˜ç®¡ç†æ¥å£ä¹‹ä¸€ã€‚äºŒè€…åˆ†åˆ«å¯ç”¨äºå°†æ–‡ä»¶æˆ–åŒ¿åå†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„<strong>è™šæ‹Ÿåœ°å€ç©ºé—´</strong>ä»¥åŠå–æ¶ˆå‰è€…æ‰€å»ºç«‹çš„æ˜ å°„ï¼Œä»è€Œå®ç°æ–‡ä»¶ I&#x2F;O çš„å†…å­˜è¯­ä¹‰ã€å †å¤–å¤§å—å†…å­˜åˆ†é…ã€å…±äº«å†…å­˜ã€çº¿ç¨‹æ ˆç©ºé—´åˆ†é…ç­‰åŠŸèƒ½ã€‚</p><ul><li><p><code>sys_mmap</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *<span class="title function_">mmap</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> length, <span class="type">int</span> prot, <span class="type">int</span> flags, <span class="type">int</span> fd, <span class="type">off_t</span> offset)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>addr</code>ï¼šå»ºè®®çš„æ˜ å°„èµ·å§‹åœ°å€ï¼ˆé€šå¸¸ä¼  <code>NULL</code>ï¼Œå³è®©å†…æ ¸è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„åœ°å€ï¼‰ã€‚<br>  å¦‚æœä¸ <code>MAP_FIXED</code> æ ‡å¿—ä¸€èµ·ä½¿ç”¨ï¼Œåˆ™å¿…é¡»æ˜¯é¡µå¯¹é½åœ°å€ï¼Œä¸”ä¼šè¦†ç›–è¯¥å¤„åŸæœ‰æ˜ å°„ã€‚</li><li><code>length</code>ï¼šæ˜ å°„çš„å­—èŠ‚æ•°ã€‚å†…æ ¸ä¼šå‘ä¸Šå–æ•´åˆ°é¡µå¤§å°çš„å€æ•°ã€‚</li><li><code>prot</code>ï¼šæ˜ å°„åŒºåŸŸçš„è®¿é—®æƒé™ï¼ˆå¯æŒ‰ä½æˆ–ç»„åˆï¼‰ï¼š<ul><li><code>PROT_NONE</code>ï¼šé¡µé¢ä¸å¯è®¿é—®</li><li><code>PROT_READ</code>ï¼šé¡µé¢å¯è¯»</li><li><code>PROT_WRITE</code>ï¼šé¡µé¢å¯å†™</li><li><code>PROT_EXEC</code>ï¼šé¡µé¢å¯æ‰§è¡Œ</li><li><code>PROT_SEM</code>ï¼šé¡µé¢å¯ç”¨äºåŸå­æ“ä½œåŒæ­¥ï¼ˆè‡ª Linux 2.5.7 èµ·æ”¯æŒï¼‰</li></ul></li><li><code>flags</code>ï¼šæ˜ å°„çš„ç±»å‹å’Œå±æ€§ï¼ˆå¯æŒ‰ä½æˆ–ç»„åˆï¼‰ï¼š<ul><li><strong>åŸºæœ¬å±æ€§</strong><ul><li><code>MAP_SHARED</code>ï¼šä¿®æ”¹å…±äº«åˆ°æ–‡ä»¶æˆ–å…¶å®ƒè¿›ç¨‹</li><li><code>MAP_PRIVATE</code>ï¼šå†™æ—¶å¤åˆ¶ï¼ˆ<code>COW</code>ï¼‰ï¼Œä¿®æ”¹ä¸ä¼šå½±å“åº•å±‚æ–‡ä»¶</li></ul></li><li><strong>åœ°å€æ§åˆ¶</strong><ul><li><code>MAP_FIXED</code>ï¼šå¼ºåˆ¶åœ¨ <code>addr</code> æŒ‡å®šä½ç½®æ˜ å°„ï¼Œè‹¥å†²çªåˆ™è¦†ç›–ï¼ˆå±é™©ï¼‰</li><li><code>MAP_FIXED_NOREPLACE</code>ï¼šå¼ºåˆ¶æ˜ å°„ä½†ä¸è¦†ç›–å·²æœ‰åŒºåŸŸï¼ˆLinux 4.17+ï¼‰</li><li><code>MAP_32BIT</code>ï¼šå°†æ˜ å°„æ”¾åœ¨ä½ <code>2GB</code> åœ°å€ç©ºé—´</li><li><code>MAP_STACK</code>ï¼šæç¤ºå†…æ ¸å°†åŒºåŸŸå½“ä½œæ ˆï¼ˆè‡ªåŠ¨å¢é•¿ï¼‰</li></ul></li><li><strong>åŒ¿å&#x2F;ç‰¹æ®Š</strong><ul><li><code>MAP_ANONYMOUS</code>ï¼šåŒ¿åæ˜ å°„ï¼ˆä¸ä¾èµ–æ–‡ä»¶ï¼‰ï¼Œ<code>fd</code> å¿…é¡»ä¸º <code>1</code></li><li><code>MAP_GROWSDOWN</code>ï¼šå‘ä¸‹å¢é•¿ï¼ˆæ ˆä½¿ç”¨ï¼‰</li><li><code>MAP_HUGETLB</code>ï¼šä½¿ç”¨å¤§é¡µå†…å­˜ï¼ˆ<code>HugeTLB</code>ï¼‰</li></ul></li><li><strong>æ€§èƒ½&#x2F;æ§åˆ¶</strong><ul><li><code>MAP_POPULATE</code>ï¼šç«‹å³é¢„å–ï¼ˆè§¦å‘ç¼ºé¡µåŠ è½½ï¼‰</li><li><code>MAP_NONBLOCK</code>ï¼šç»“åˆ <code>MAP_POPULATE</code>ï¼Œåå°åŠ è½½</li><li><code>MAP_NORESERVE</code>ï¼šä¸ä¸ºäº¤æ¢åŒºé¢„ç•™ç©ºé—´</li><li><code>MAP_LOCKED</code>ï¼šå°†æ˜ å°„é”å®šåœ¨ç‰©ç†å†…å­˜ä¸­</li><li><code>MAP_SYNC</code>ï¼šä¸æŒä¹…åŒ–å­˜å‚¨åŒæ­¥ï¼ˆéœ€ <code>DAX</code> æ”¯æŒï¼‰</li><li><code>MAP_UNINITIALIZED</code>ï¼šå…è®¸è¿”å›æœªæ¸…é›¶å†…å­˜ï¼ˆä»…æŸäº›å†…æ ¸é…ç½®ï¼‰</li></ul></li></ul></li></ul>  <aside>  ğŸ’¡  <p>  å¤‡æ³¨ï¼š<code>prot</code> å’Œ <code>flags</code> çš„å®å®šä¹‰å¦‚ä¸‹ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_NONE       0x0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_READ       0x1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_WRITE      0x2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_EXEC       0x4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_SEM        0x8</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_GROWSDOWN  0x01000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PROT_GROWSUP    0x02000000</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_SHARED           0x01</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_PRIVATE          0x02</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_FIXED            0x10</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_ANONYMOUS        0x20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_32BIT            0x40</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_GROWSDOWN        0x0100</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_DENYWRITE        0x0800</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_EXECUTABLE       0x1000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_LOCKED           0x2000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_NORESERVE        0x4000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_POPULATE         0x8000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_NONBLOCK         0x10000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_STACK            0x20000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_HUGETLB          0x40000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_SYNC             0x80000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_FIXED_NOREPLACE  0x100000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAP_UNINITIALIZED    0x200000</span></span><br></pre></td></tr></table></figure><p>  åœ¨ C è¯­è¨€çš„ç¨‹åºå®ç°ä¸­ï¼Œå„ä¸ªå®ä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦ <code>|</code> è¿æ¥ã€‚</p>  </aside>  <ul><li><code>fd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦ã€‚å¦‚æœæ˜¯åŒ¿åæ˜ å°„ï¼Œåˆ™å¿…é¡»ä¸º <code>1</code>ã€‚</li><li><code>offset</code>ï¼šæ–‡ä»¶ä¸­æ˜ å°„çš„èµ·å§‹åç§»ï¼Œå¿…é¡»æ˜¯é¡µå¤§å°çš„æ•´æ•°å€ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›æ˜ å°„åŒºçš„èµ·å§‹åœ°å€ï¼ˆ<code>void *</code> æŒ‡é’ˆï¼‰ã€‚</li><li>å¤±è´¥æ—¶è¿”å›<code>-1</code> å¹¶è®¾ç½®<code>errno</code>ã€‚</li></ul></li></ul></li><li><p><code>sys_munmap</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">munmap</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> length)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>addr</code>ï¼šè¦å–æ¶ˆçš„æ˜ å°„åŒºçš„èµ·å§‹åœ°å€ã€‚</li><li><code>length</code>ï¼šæ˜ å°„çš„å­—èŠ‚æ•°ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›<code>0</code> ã€‚</li><li>å¤±è´¥æ—¶è¿”å›<code>-1</code> å¹¶è®¾ç½®<code>errno</code> ã€‚</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">.equ MAP_SHARED, 0x01</span><br><span class="line">.equ PROT_READ, 0x01</span><br><span class="line">.equ PROT_WRITE, 0x02</span><br><span class="line">.equ PROT_READ_WRITE, 0x03</span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">filename:</span><br><span class="line">.ascii &quot;/tmp/test.txt\0&quot;</span><br><span class="line">mmap_msg:</span><br><span class="line">.ascii &quot;Data from mmap\n\0&quot;</span><br><span class="line">mmap_msg_len = . - mmap_msg</span><br><span class="line">write_msg:</span><br><span class="line">.ascii &quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;</span><br><span class="line">write_msg_len = . - write_msg</span><br><span class="line">errmsg:</span><br><span class="line">.ascii &quot;Error\n\0&quot;</span><br><span class="line">errmsg_len = . - errmsg</span><br><span class="line"></span><br><span class="line">.section .bss</span><br><span class="line">.lcomm mapped_addr, 8      # å­˜å‚¨æ˜ å°„çš„åœ°å€</span><br><span class="line">.lcomm fd, 4</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"># å¼€å¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ %r12 è¯»å– /tmp/test.txt</span><br><span class="line">mov $2, %rax</span><br><span class="line">lea filename(%rip), %rdi</span><br><span class="line">mov $0x242, %rsi</span><br><span class="line">mov $0644, %rdx</span><br><span class="line">syscall</span><br><span class="line">mov %rax, fd(%rip)</span><br><span class="line"></span><br><span class="line"># è°ƒç”¨ write å¾€æ–‡ä»¶ä¸­å†™å…¥æ•°æ®</span><br><span class="line">mov $1, %rax</span><br><span class="line">mov fd(%rip), %rdi</span><br><span class="line">lea write_msg(%rip), %rsi</span><br><span class="line">mov $write_msg_len, %rdx</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># è°ƒç”¨ mmap å°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜</span><br><span class="line">mov $9, %rax</span><br><span class="line">xor %rdi, %rdi             # addr = NULL</span><br><span class="line">mov $mmap_msg_len, %rsi    # length = msg_len</span><br><span class="line">mov $PROT_READ_WRITE, %rdx # prot = PROT_READ | PROT_WRITE</span><br><span class="line">mov $MAP_SHARED, %r10      # flags = MAP_SHARED</span><br><span class="line">mov fd(%rip), %r8          # fd</span><br><span class="line">xor %r9, %r9               # offset = 0</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># æ£€æŸ¥ mmap æ˜¯å¦å‡ºé”™</span><br><span class="line">cmp $-1, %rax</span><br><span class="line">jle exit_error</span><br><span class="line"></span><br><span class="line"># å°† mmap è¿”å›çš„åœ°å€ä¿å­˜åˆ° mapped_addr</span><br><span class="line">mov %rax, mapped_addr(%rip)</span><br><span class="line"></span><br><span class="line"># å°†æ•°æ®ä» msg å¤åˆ¶åˆ°æ˜ å°„çš„å†…å­˜åŒºåŸŸ</span><br><span class="line">mov mapped_addr(%rip), %rdi # ç›®æ ‡åœ°å€ (dst) = mapped_addr</span><br><span class="line">lea mmap_msg(%rip), %rsi    # æºåœ°å€ (src) = message</span><br><span class="line">mov $mmap_msg_len, %rcx     # å¤åˆ¶é•¿åº¦ (count) = msg_len</span><br><span class="line">cld                         # æ¸…é™¤æ–¹å‘æ ‡å¿—</span><br><span class="line">rep movsb                   # å¾ªç¯å¤åˆ¶å­—èŠ‚</span><br><span class="line"></span><br><span class="line"># å…³é—­æ˜ å°„</span><br><span class="line">mov $11, %rax</span><br><span class="line">mov mapped_addr(%rip), %rdi</span><br><span class="line">mov $mmap_msg_len, %rsi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># å…³é—­æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">mov $3, %rax</span><br><span class="line">mov fd(%rip), %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># é€€å‡ºç¨‹åº</span><br><span class="line">mov $60, %rax</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">exit_error:</span><br><span class="line">mov %rax, %r12</span><br><span class="line">mov $1, %rax</span><br><span class="line">mov $2, %rdi</span><br><span class="line">lea errmsg(%rip), %rsi</span><br><span class="line">mov $errmsg_len, %rdx</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">mov $60, %rax</span><br><span class="line">mov %r12, %rdi</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>sys_mmap</code> ä¸<code>sys_munmap</code> å°†ä¸€ä¸ªæ–‡ä»¶æ˜ å°„åˆ°è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€‚</p><p>  ç¨‹åºæœ€å¼€å§‹é€šè¿‡è°ƒç”¨<code>open</code> å’Œ<code>write</code> ï¼Œå…ˆæ˜¯åˆ›å»ºäº†ç›®æ ‡æ–‡ä»¶ï¼Œç„¶åå‘è¯¥æ–‡ä»¶ä¸­å†™å…¥äº†ä¸€æ®µè¾ƒé•¿çš„å­—ç¬¦ä¸²ï¼Œå†…å®¹ä¸ºåå››ä¸ªç©ºä½<code>\0</code> ï¼Œç›®çš„æ˜¯ä¸ºäº†å…ˆå¡«å……æ–‡ä»¶å¤§å°è‡³<code>14</code>ä¸ªå­—èŠ‚ï¼Œä»¥é˜²æ­¢çˆ†å‡ºæ€»çº¿é”™è¯¯<code>SIGBUS</code>ã€‚</p><p>  ç¨‹åºåœ¨è°ƒç”¨<code>mmap</code> æ—¶å°†ç³»ç»Ÿè°ƒç”¨å·<code>9</code>ï¼ˆ<code>sys_mmap</code>ï¼‰å­˜å…¥<code>%rax</code>ã€‚ç„¶åï¼Œå®ƒä¾æ¬¡å°†å„ä¸ªå‚æ•°åŠ è½½åˆ°ç›¸åº”çš„å¯„å­˜å™¨ï¼š<code>addr</code> (<code>%rdi</code>)è®¾ä¸º<code>0</code>ï¼ˆ<code>NULL</code>ï¼‰ï¼Œè®©å†…æ ¸è‡ªåŠ¨é€‰æ‹©åœ°å€ï¼›<code>length</code> (<code>%rsi</code>)è®¾ä¸º<code>msg_len</code>ï¼›<code>prot</code> (<code>%rdx</code>)è®¾ä¸ºå¯è¯»å†™æƒé™ï¼›<code>flags</code> (<code>%r10</code>)è®¾ä¸º<code>MAP_SHARED</code>ï¼›<code>fd</code> (<code>%r8</code>)è®¾ç½®ä¸ºå…ˆå‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼›<code>offset</code> (<code>%r9</code>)è®¾ä¸º<code>0</code>ã€‚ç­‰æ•ˆä¸ºï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> * mapped_addr = mmap(<span class="literal">NULL</span>, msg_len, PROT_READ|PROT_WRITE, MAP_SHARED, fd, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>  æ‰§è¡Œ<code>syscall</code>åï¼Œå¦‚æœæˆåŠŸï¼Œ<code>%rax</code>ä¸­å°†åŒ…å«æ˜ å°„åŒºåŸŸçš„èµ·å§‹åœ°å€ã€‚ç¨‹åºå°†è¿™ä¸ªåœ°å€ä¿å­˜èµ·æ¥ï¼Œç„¶åå¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å†™æ–‡ä»¶ï¼Œå°±åƒè¯»å†™æ™®é€šå†…å­˜ä¸€æ ·ã€‚</p><p>  åœ¨æ‰§è¡Œå®Œä¸Šè¿°æ“ä½œä¹‹åï¼Œç¨‹åºåˆè°ƒç”¨äº†<code>munmap</code> å…³é—­äº†å‰é¢å»ºç«‹çš„æ˜ å°„ï¼Œå¹¶å…³é—­äº†æ•´ä¸ªç¨‹åºã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_mmap&lt;/code&gt;ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;9&lt;/code&gt;ï¼‰å’Œ&lt;code&gt;sys_munmap&lt;/code&gt; ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;11&lt;/code&gt;ï¼‰æ˜¯ Linux ä¸­åŠŸèƒ½æœ€å¼ºå¤§çš„å†…å­˜ç®¡ç†æ¥å£ä¹‹ä¸€ã€‚äºŒè€…åˆ†åˆ«å¯ç”¨äºå°†æ–‡ä»¶æˆ–åŒ¿åå†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„&lt;stro</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_lseek</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-lseek/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-lseek/</id>
    <published>2025-11-12T14:29:44.000Z</published>
    <updated>2025-11-16T16:22:10.343Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_lseek</code> ï¼ˆè°ƒç”¨å·ä¸º<code>8</code>ï¼‰æ˜¯ Linux ä¸­ä¸€ä¸ªç”¨äºæ“ä½œæ–‡ä»¶æè¿°ç¬¦è¯»å†™ä½ç½®çš„ç³»ç»Ÿè°ƒç”¨ã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é‡æ–°å®šä½ï¼ˆç§»åŠ¨ï¼‰ä¸€ä¸ªå·²æ‰“å¼€æ–‡ä»¶çš„è¯»å†™åç§»é‡ï¼ˆ<code>offset</code>ï¼‰ã€‚è¿™ä¸ªåç§»é‡å†³å®šäº†ä¸‹ä¸€æ¬¡è¯»æˆ–å†™æ“ä½œå°†ä»æ–‡ä»¶çš„ä»€ä¹ˆä½ç½®å¼€å§‹ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ–‡ä»¶çš„éšæœºè®¿é—®ï¼ˆå³è·³è½¬åˆ°æ–‡ä»¶ä»»æ„ä½ç½®è¿›è¡Œè¯»å†™ï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯é¡ºåºè¯»å†™ã€‚</p><ul><li><p><code>sys_lseek</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">off_t</span> <span class="title function_">lseek</span><span class="params">(<span class="type">int</span> fd, <span class="type">off_t</span> offset, <span class="type">int</span> whence)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼ŒæŒ‡å‘ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚</li><li><code>offset</code>: ç›¸å¯¹äº <code>whence</code> å‚æ•°çš„åç§»é‡ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</li><li><code>whence</code>: å†³å®šåç§»é‡è®¡ç®—èµ·ç‚¹çš„ä½ç½®ï¼Œå¯å–ä»¥ä¸‹å€¼ï¼š<ul><li><code>SEEK_SET</code> (<code>0</code>): å°†åç§»é‡è®¾ç½®ä¸ºä»<strong>æ–‡ä»¶å¼€å§‹</strong>ç®—èµ·çš„ <code>offset</code> å­—èŠ‚ã€‚</li><li><code>SEEK_CUR</code> (<code>1</code>): å°†åç§»é‡è®¾ç½®ä¸ºä»<strong>å½“å‰ä½ç½®</strong>ç®—èµ·åŠ ä¸Š <code>offset</code> å­—èŠ‚ï¼ˆ<code>offset</code> å¯ä¸ºè´Ÿæ•°ï¼Œè¡¨ç¤ºå‘å‰ç§»åŠ¨ï¼‰ã€‚</li><li><code>SEEK_END</code> (<code>2</code>): å°†åç§»é‡è®¾ç½®ä¸ºä»<strong>æ–‡ä»¶æœ«å°¾</strong>ç®—èµ·åŠ ä¸Š <code>offset</code> å­—èŠ‚ï¼ˆ<code>offset</code> å¯ä¸ºè´Ÿæ•°ï¼Œè¡¨ç¤ºå‘å‰ç§»åŠ¨ï¼‰ã€‚</li></ul></li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›<strong>æ–°çš„ã€ç§»åŠ¨åçš„æ–‡ä»¶åç§»é‡</strong>ï¼ˆä»æ–‡ä»¶å¼€å¤´è®¡ç®—çš„å­—èŠ‚æ•°ï¼‰ã€‚</li><li>å¤±è´¥æ—¶è¿”å› <code>-errno</code>ï¼ˆå¦‚ <code>EBADF</code> ï¼Œ<code>EINVAL</code> ï¼‰ã€‚</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">.section .data</span><br><span class="line">filename:</span><br><span class="line">.ascii &quot;/tmp/text.txt\0&quot;</span><br><span class="line">content:</span><br><span class="line">.ascii &quot;HelloWorld\0&quot;   # æ–‡ä»¶å†…å®¹</span><br><span class="line">len = . - content</span><br><span class="line">buffer:</span><br><span class="line">.space 5                 # ç”¨äºè¯»å–æ•°æ®çš„ç¼“å†²åŒº</span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line">_start:</span><br><span class="line"># 1. æ‰“å¼€æ–‡ä»¶ (sys_open)</span><br><span class="line">mov $2, %rax             # ç³»ç»Ÿè°ƒç”¨å· (2 = sys_open)</span><br><span class="line">lea filename(%rip), %rdi # æ–‡ä»¶å</span><br><span class="line">mov $0101, %si           # æ ‡å¿—ä½ (O_CREAT | O_WRONLY)</span><br><span class="line">mov $0666, %dx           # æ¨¡å¼</span><br><span class="line">syscall</span><br><span class="line">mov %rax, %r8            # ä¿å­˜æ–‡ä»¶æè¿°ç¬¦åˆ° %r8</span><br><span class="line"></span><br><span class="line"># 2. å†™å…¥å†…å®¹ content (sys_write)</span><br><span class="line">mov $1, %rax           # ç³»ç»Ÿè°ƒç”¨å· (1 = sys_write)</span><br><span class="line">mov %r8, %rdi          # æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">lea content(%rip), %rsi # è¦å†™å…¥çš„æ•°æ®</span><br><span class="line">mov $len, %rdx         # æ•°æ®é•¿åº¦</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># 3. å…³é—­æ–‡ä»¶ (sys_close)</span><br><span class="line">mov $3, %rax           # ç³»ç»Ÿè°ƒç”¨å· (3 = sys_close)</span><br><span class="line">mov %r8, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># 4. é‡æ–°ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ (sys_open)</span><br><span class="line">mov $2, %rax</span><br><span class="line">lea filename(%rip), %rdi</span><br><span class="line">xor %rsi, %rsi         # æ ‡å¿—ä½ (O_RDONLY)</span><br><span class="line">syscall</span><br><span class="line">mov %rax, %r8          # ä¿å­˜æ–°çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line"></span><br><span class="line"># 5. ä½¿ç”¨ sys_lseek è·³è½¬åˆ°ç¬¬6ä¸ªå­—èŠ‚ï¼ˆ&#x27;W&#x27;çš„ä½ç½®ï¼‰</span><br><span class="line">mov $8, %rax           # ç³»ç»Ÿè°ƒç”¨å· (8 = sys_lseek)</span><br><span class="line">mov %r8, %rdi          # æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">mov $5, %rsi           # offset = 5 (ä»èµ·ç‚¹åç¬¬5ä¸ªå­—èŠ‚ï¼Œå³ç¬¬6ä¸ª)</span><br><span class="line">mov $0, %rdx           # whence = SEEK_SET (0)</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># 6. ä»æ–°ä½ç½®è¯»å–5ä¸ªå­—èŠ‚ (sys_read)</span><br><span class="line">mov $0, %rax           # ç³»ç»Ÿè°ƒç”¨å· (0 = sys_read)</span><br><span class="line">mov %r8, %rdi</span><br><span class="line">lea buffer(%rip), %rsi # è¯»å–ç¼“å†²åŒº</span><br><span class="line">mov $5, %rdx           # è¯»å–5ä¸ªå­—èŠ‚</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># 7. å°†è¯»å–åˆ°çš„å†…å®¹è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º (sys_write)</span><br><span class="line">mov $1, %rax</span><br><span class="line">mov $1, %rdi           # æ–‡ä»¶æè¿°ç¬¦ (1 = stdout)</span><br><span class="line">lea buffer(%rip), %rsi</span><br><span class="line">mov $5, %rdx</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># 8. å…³é—­æ–‡ä»¶å¹¶é€€å‡º</span><br><span class="line">mov $3, %rax           # sys_close</span><br><span class="line">mov %r8, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">mov $60, %rax          # sys_exit</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº† <code>sys_lseek</code> çš„ä¸€ä¸ªå…¸å‹ç”¨æ³•ï¼šè·³è½¬åˆ°æ–‡ä»¶ä¸­é—´è¿›è¡Œè¯»å–ã€‚</p><p>  ç¨‹åºé¦–å…ˆåˆ›å»ºå¹¶æ‰“å¼€ä¸€ä¸ªåä¸º <code>test.txt</code> çš„æ–‡ä»¶ï¼Œå†™å…¥å­—ç¬¦ä¸² <code>&quot;HelloWorld&quot;</code>ï¼ˆå…± 10 å­—èŠ‚ï¼‰ï¼Œç„¶åå…³é—­å®ƒã€‚ç„¶åï¼Œé‡æ–°ä»¥åªè¯»æ¨¡å¼æ‰“å¼€è¯¥æ–‡ä»¶ã€‚æ­¤æ—¶æ–‡ä»¶åç§»é‡åœ¨å¼€å¤´ (<code>0</code>)ã€‚æ­¤æ—¶ï¼Œç¨‹åºå¼€å§‹è°ƒç”¨ <code>sys_lseek</code>ã€‚æˆ‘ä»¬é¦–å…ˆå°†ï¼Œç³»ç»Ÿè°ƒç”¨å· <code>8</code> å­˜å…¥ <code>%rax</code> ï¼Œæ–‡ä»¶æè¿°ç¬¦å­˜å…¥ <code>%rdi</code> ï¼Œåç§»é‡ <code>5</code> å­˜å…¥ <code>%rsi</code>ï¼ˆæˆ‘ä»¬å¸Œæœ›è·³è¿‡å‰5ä¸ªå­—èŠ‚ <code>&quot;Hello&quot;</code>ï¼‰ï¼Œ<code>whence</code> å‚æ•° <code>SEEK_SET</code> (<code>0</code>) å­˜å…¥ <code>%rdx</code>ï¼Œè¡¨ç¤ºä»æ–‡ä»¶å¼€å¤´è®¡ç®—åç§»ã€‚</p><p>  æ‰§è¡Œåï¼Œæ–‡ä»¶åç§»é‡è¢«è®¾ç½®ä¸º <code>5</code>ã€‚ç´§æ¥ç€è°ƒç”¨ <code>sys_read</code>ï¼Œå®ƒä¼šä»æ–°çš„åç§»é‡ï¼ˆç¬¬ 5 å­—èŠ‚åï¼Œå³ç¬¬ 6 ä¸ªå­—èŠ‚ï¼‰å¼€å§‹è¯»å–ã€‚è¿™é‡Œè¯»å–äº† 5 ä¸ªå­—èŠ‚ï¼Œå†…å®¹å°†æ˜¯ <code>&quot;World&quot;</code>ã€‚éšåï¼Œç¨‹åºå¼€å§‹å°†è¿™ä¸ªç»“æœ <code>&quot;World&quot;</code> å†™å…¥æ ‡å‡†è¾“å‡ºã€‚æœ€ç»ˆæ•ˆæœæ˜¯ï¼Œç¨‹åºæ²¡æœ‰è¯»å–æ–‡ä»¶çš„å¼€å¤´ï¼Œè€Œæ˜¯ç›´æ¥è¯»å–å¹¶è¾“å‡ºäº†æ–‡ä»¶çš„ååŠéƒ¨åˆ†ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_lseek&lt;/code&gt; ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;8&lt;/code&gt;ï¼‰æ˜¯ Linux ä¸­ä¸€ä¸ªç”¨äºæ“ä½œæ–‡ä»¶æè¿°ç¬¦è¯»å†™ä½ç½®çš„ç³»ç»Ÿè°ƒç”¨ã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é‡æ–°å®šä½ï¼ˆç§»åŠ¨ï¼‰ä¸€ä¸ªå·²æ‰“å¼€æ–‡ä»¶çš„è¯»å†™åç§»é‡ï¼ˆ&lt;code&gt;offset&lt;/code&gt;ï¼‰ã€‚è¿™ä¸ªåç§»é‡å†³å®šäº†ä¸‹ä¸€æ¬¡è¯»æˆ–å†™</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_poll</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-poll/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-poll/</id>
    <published>2025-11-12T14:29:39.000Z</published>
    <updated>2025-11-16T16:23:03.963Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_poll</code> ï¼ˆå³è°ƒç”¨å·ä¸º<code>7</code>çš„pollç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºæ£€æµ‹å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œçœ‹å®ƒä»¬æ˜¯å¦å‡†å¤‡å¥½å»è¿›è¡ŒæŸç§ç±»å‹çš„ I&#x2F;O æ“ä½œï¼ˆæ¯”å¦‚æ˜¯å¦å¯è¯»ã€å¯å†™ç­‰ï¼‰ã€‚å®ƒæ˜¯ä¸€ç§å®ç° I&#x2F;O å¤šè·¯å¤ç”¨çš„é«˜æ•ˆæ–¹æ³•ï¼Œå…è®¸ä¸€ä¸ªç¨‹åºåŒæ—¶ç­‰å¾…å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œä¸éœ€è¦ä¸ºæ¯ä¸ªæ–‡ä»¶æè¿°ç¬¦åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ã€‚</p><ul><li><p><code>sys_poll</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">poll</span><span class="params">(<span class="keyword">struct</span> pollfd *fds, <span class="type">nfds_t</span> nfds, <span class="type">int</span> timeout)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><p><code>fds</code>: æŒ‡å‘ <code>struct pollfd</code> æ•°ç»„çš„æŒ‡é’ˆï¼Œæ¯ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªç»“æ„ä½“æè¿°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦åŠå…¶å…³å¿ƒçš„äº‹ä»¶ã€‚è¿™ä¸ªç»“æ„ä½“æœ¬èº«è¢«å®šä¹‰ä¸ºï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pollfd</span> &#123;</span></span><br><span class="line"><span class="type">int</span>   fd;       <span class="comment">// è¦ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦</span></span><br><span class="line">*<span class="type">short</span> events;   <span class="comment">//* å…³æ³¨çš„äº‹ä»¶ä½æ©ç </span></span><br><span class="line">*<span class="type">short</span> revents;  <span class="comment">//* å†…æ ¸è¿”å›çš„äº‹ä»¶ä½æ©ç ï¼ˆç”±ç³»ç»Ÿè°ƒç”¨å¡«å†™ï¼‰</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>  å…¶ä¸­ï¼Œ<code>events</code> å¸¸å¸¸ä½¿ç”¨å®æ¥å¡«å†™ã€‚è¿™äº›è¡¨ç¤ºäº‹ä»¶çš„å®å®šä¹‰å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å®</th><th>å€¼ (16 è¿›åˆ¶)</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>POLLIN</code></td><td><code>0x0001</code></td><td>æ–‡ä»¶å¯è¯»ï¼ˆåŒ…æ‹¬æ™®é€šæ•°æ®æˆ–é«˜ä¼˜å…ˆçº§æ•°æ®ï¼‰</td></tr><tr><td><code>POLLPRI</code></td><td><code>0x0002</code></td><td>é«˜ä¼˜å…ˆçº§æ•°æ®å¯è¯»ï¼ˆä¾‹å¦‚å¸¦å¤–æ•°æ®ï¼‰</td></tr><tr><td><code>POLLOUT</code></td><td><code>0x0004</code></td><td>æ–‡ä»¶å¯å†™</td></tr><tr><td><code>POLLERR</code></td><td><code>0x0008</code></td><td>é”™è¯¯æ¡ä»¶å‘ç”Ÿï¼ˆç³»ç»Ÿè®¾ç½®ï¼‰</td></tr><tr><td><code>POLLHUP</code></td><td><code>0x0010</code></td><td>å¯¹ç«¯æŒ‚æ–­æˆ– FIFO æ–‡ä»¶å…³é—­</td></tr><tr><td><code>POLLNVAL</code></td><td><code>0x0020</code></td><td>æ–‡ä»¶æè¿°ç¬¦æ— æ•ˆ</td></tr><tr><td><code>POLLRDNORM</code></td><td><code>0x0040</code></td><td>æ™®é€šæ•°æ®å¯è¯»ï¼ˆç±»ä¼¼ <code>POLLIN</code>ï¼‰</td></tr><tr><td><code>POLLRDBAND</code></td><td><code>0x0080</code></td><td>å¸¦å¤–&#x2F;ä¼˜å…ˆçº§æ•°æ®å¯è¯»</td></tr><tr><td><code>POLLWRNORM</code></td><td><code>0x0100</code></td><td>æ™®é€šå¯å†™ï¼ˆç±»ä¼¼ <code>POLLOUT</code>ï¼‰</td></tr><tr><td><code>POLLWRBAND</code></td><td><code>0x0200</code></td><td>å¸¦å¤–&#x2F;ä¼˜å…ˆçº§æ•°æ®å¯å†™</td></tr><tr><td><code>POLLMSG</code></td><td><code>0x0400</code></td><td>æ¶ˆæ¯å¯ç”¨ï¼ˆä¸»è¦ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ï¼ŒPOSIXï¼‰</td></tr><tr><td><code>POLLREMOVE</code></td><td><code>0x1000</code></td><td>ç›‘æ§å¯¹è±¡è¢«ç§»é™¤ï¼ˆå†…æ ¸ä½¿ç”¨ï¼‰</td></tr><tr><td><code>POLLONESHOT</code></td><td><code>0x8000</code></td><td>ä»…è§¦å‘ä¸€æ¬¡äº‹ä»¶ï¼Œä¹‹åè‡ªåŠ¨æ¸…é™¤ï¼ˆå†…æ ¸ä½¿ç”¨ï¼‰</td></tr></tbody></table></li><li><p><code>nfds</code>: ä¼ å…¥çš„æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡</p></li><li><p><code>timeout</code>: ç­‰å¾…äº‹ä»¶çš„è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œ-1 è¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œ0 è¡¨ç¤ºç«‹å³è¿”å›</p></li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›å‘ç”Ÿäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦æ•°é‡ï¼ˆéè´Ÿæ•´æ•°ï¼‰</li><li>å¤±è´¥æ—¶è¿”å› <code>-errno</code>ï¼ˆå¦‚ <code>EINVAL</code>, <code>EFAULT</code>, <code>EBADF</code>ï¼‰</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">.equ POLLIN, 0x0001</span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">fds:</span><br><span class="line"># å®šä¹‰ä¸€ä¸ª pollfd æ•°ç»„ï¼Œç›‘æ§æ–‡ä»¶æè¿°ç¬¦ 0 (stdin) æ˜¯å¦å¯è¯»</span><br><span class="line">.long 0               # fd = 0 (stdin)</span><br><span class="line">.short POLLIN         # events = POLLIN (å¯è¯»äº‹ä»¶)</span><br><span class="line">.short 0x0000         # revents (å†…æ ¸å¡«å†™ï¼Œåˆå§‹ä¸º 0)</span><br><span class="line"></span><br><span class="line">timeout:</span><br><span class="line">.long 5000            # ç­‰å¾… 5000 æ¯«ç§’ï¼ˆ5 ç§’ï¼‰</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"># è°ƒç”¨ sys_poll ç›‘æ§ stdin æ˜¯å¦æœ‰å¯è¯»äº‹ä»¶</span><br><span class="line">mov $7, %rax              # ç³»ç»Ÿè°ƒç”¨å· (7 = sys_poll)</span><br><span class="line">lea fds(%rip), %rdi       # struct pollfd *fds</span><br><span class="line">mov $1, %rsi              # nfds = 1 (æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ )</span><br><span class="line">lea timeout(%rip), %rdx   # timeout = 5000 ms</span><br><span class="line">syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line"></span><br><span class="line"># é€€å‡ºç¨‹åº</span><br><span class="line">mov $60, %rax             # ç³»ç»Ÿè°ƒç”¨å· (60 = sys_exit)</span><br><span class="line">xor %rdi, %rdi            # return 0</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>sys_poll</code> ç›‘æ§æ ‡å‡†è¾“å…¥ï¼ˆ<code>stdin</code>ï¼Œæ–‡ä»¶æè¿°ç¬¦ <code>0</code>ï¼‰æ˜¯å¦å¯è¯»ã€‚</p><p>  ç¨‹åºé¦–å…ˆåœ¨ <code>.data</code> æ®µå®šä¹‰äº†ä¸€ä¸ª <code>struct pollfd</code> æ•°ç»„ <code>fds</code>ï¼š</p><ul><li><code>fd</code> å­—æ®µè®¾ä¸º <code>0</code>ï¼Œè¡¨ç¤ºæ ‡å‡†è¾“å…¥</li><li><code>events</code> å­—æ®µè®¾ä¸º <code>POLLIN</code>ï¼Œè¡¨ç¤ºå…³æ³¨å¯è¯»äº‹ä»¶</li><li><code>revents</code> å­—æ®µåˆå§‹åŒ–ä¸º <code>0</code>ï¼Œç³»ç»Ÿè°ƒç”¨è¿”å›æ—¶å†…æ ¸ä¼šå†™å…¥å®é™…å‘ç”Ÿçš„äº‹ä»¶</li></ul><p>  <code>timeout</code> å­—æ®µè¢«è®¾ä¸º <code>5000</code>ï¼Œè¡¨ç¤ºæœ€å¤šç­‰å¾… 5 ç§’ã€‚ç”±äºæˆ‘ä»¬åªå®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ï¼Œ<code>fds</code> ä»…ä»…æ˜¯ä¸€ä¸ªæŒ‡å‘ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œè€Œä¸æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ•°ç»„é•¿åº¦<code>nfds</code> è®¾ç½®ä¸º<code>1</code> ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿è¡Œåˆ°ç¬¬ä¸€ä¸ª<code>syscall</code> æ—¶ï¼Œç³»ç»Ÿè°ƒç”¨å¤§è‡´ä¸Šå¯ä»¥ç­‰æ•ˆä¸ºï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poll(&amp;fds, <span class="number">1</span>, <span class="number">5000</span>);</span><br></pre></td></tr></table></figure><p>  ç¨‹åºæœ€åè°ƒç”¨ <code>sys_exit</code> ç³»ç»Ÿè°ƒç”¨æ­£å¸¸é€€å‡ºï¼Œè¿”å›å€¼ <code>0</code> è¡¨ç¤ºæˆåŠŸã€‚</p><p>  é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>sys_poll</code> å¯ä»¥æœ‰æ•ˆåœ°åœ¨å•çº¿ç¨‹ä¸­åŒæ—¶ç›‘æ§å¤šä¸ª I&#x2F;O äº‹ä»¶ï¼Œå¸¸ç”¨äºå®ç°äº‹ä»¶å¾ªç¯æˆ–éé˜»å¡ I&#x2F;Oã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_poll&lt;/code&gt; ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;7&lt;/code&gt;çš„pollç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºæ£€æµ‹å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œçœ‹å®ƒä»¬æ˜¯å¦å‡†å¤‡å¥½å»è¿›è¡ŒæŸç§ç±»å‹çš„ I&amp;#x2F;O æ“ä½œï¼ˆæ¯”å¦‚æ˜¯å¦å¯è¯»ã€å¯å†™ç­‰ï¼‰ã€‚å®ƒæ˜¯ä¸€ç§å®ç° I&amp;#x</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_stat, sys_fstat ä»¥åŠ sys_lstat</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-stat-sys-fstat-%E4%BB%A5%E5%8F%8A-sys-lstat/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-stat-sys-fstat-%E4%BB%A5%E5%8F%8A-sys-lstat/</id>
    <published>2025-11-12T14:29:33.000Z</published>
    <updated>2025-11-16T16:23:30.434Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_stat</code> ï¼ˆè°ƒç”¨å·ä¸º<code>4</code>ï¼‰ã€<code>sys_fstat</code> ï¼ˆè°ƒç”¨å·ä¸º<code>5</code>ï¼‰å’Œ <code>sys_lstat</code> ï¼ˆè°ƒç”¨å·ä¸º<code>6</code>ï¼‰æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸‰ä¸ªåŸºæœ¬æ–‡ä»¶çŠ¶æ€æŸ¥è¯¢ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºè·å–æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼ˆå¦‚å¤§å°ã€æƒé™ã€æ—¶é—´æˆ³ç­‰ï¼‰ã€‚</p><p>è¿™ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨è™½ç„¶éƒ½ç”¨äºè·å–æ–‡ä»¶å…ƒä¿¡æ¯ï¼Œä½†ä¸‰è€…ä»ç„¶å­˜åœ¨æ˜æ˜¾çš„ä¸åŒã€‚<code>sys_stat</code> å’Œ<code>sys_lstat</code>éƒ½æ˜¯é€šè¿‡æ–‡ä»¶çš„è·¯å¾„å¯¹æ–‡ä»¶è¿›è¡Œè®¿é—®çš„ï¼Œè€Œ<code>sys_fstat</code> å´æ˜¯é€šè¿‡æ–‡ä»¶æè¿°ç¬¦<code>fd</code> å¯¹æŸä¸€æ–‡ä»¶è¿›è¡Œè®¿é—®ã€‚ä¸<code>sys_stat</code>ç›¸æ¯”ï¼Œ<code>sys_lstat</code> è™½ç„¶ä¹Ÿé€šè¿‡æ–‡ä»¶çš„è·¯å¾„å¯¹æ–‡ä»¶è¿›è¡Œè®¿é—®ï¼Œä½†åœ¨å¤„ç†ç¬¦å·é“¾æ¥çš„æ–¹å¼ä¸Šæœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚å‰è€…æŸ¥è¯¢åˆ°ç¬¦å·é“¾æ¥æ—¶ï¼Œä¼šå¯¹å…¶æ‰€æŒ‡å‘çš„é‚£ä¸ªç›®æ ‡æ–‡ä»¶è¿›è¡ŒæŸ¥è¯¢ï¼›è€Œåè€…åˆ™ä¼šå¯¹ç¬¦å·é“¾æ¥è¿™ä¸ªæ–‡ä»¶æœ¬èº«è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸ä¼šé‡å®šå‘è‡³ç¬¦å·é“¾æ¥æ‰€æŒ‡å‘çš„é‚£ä¸ªæ–‡ä»¶ã€‚</p><p>æ— è®ºæ˜¯è¿™ä¸‰è€…ä¸­çš„å“ªä¸€ä¸ªï¼Œè¿”å›å…ƒä¿¡æ¯çš„ç»“æ„ä½“<code>struct stat</code> çš„å®šä¹‰éƒ½æ˜¯ä¸€è‡´çš„ã€‚<code>struct stat</code> è¢«å®šä¹‰ä¸ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span> &#123;</span></span><br><span class="line">    <span class="type">dev_t</span>     st_dev;     <span class="comment">/* æ–‡ä»¶æ‰€åœ¨è®¾å¤‡å· */</span></span><br><span class="line">    <span class="type">ino_t</span>     st_ino;     <span class="comment">/* æ–‡ä»¶ i-node å· */</span></span><br><span class="line">    <span class="type">nlink_t</span>   st_nlink;   <span class="comment">/* ç¡¬é“¾æ¥æ•° */</span></span><br><span class="line">    <span class="type">mode_t</span>    st_mode;    <span class="comment">/* æ–‡ä»¶ç±»å‹ä¸æƒé™æ¨¡å¼ */</span></span><br><span class="line">    <span class="type">uid_t</span>     st_uid;     <span class="comment">/* æ‰€æœ‰è€…ç”¨æˆ· ID */</span></span><br><span class="line">    <span class="type">gid_t</span>     st_gid;     <span class="comment">/* æ‰€æœ‰è€…ç»„ ID */</span></span><br><span class="line">    <span class="type">dev_t</span>     st_rdev;    <span class="comment">/* ç‰¹æ®Šæ–‡ä»¶çš„è®¾å¤‡å·ï¼ˆå­—ç¬¦/å—è®¾å¤‡ï¼‰ */</span></span><br><span class="line">    <span class="type">off_t</span>     st_size;    <span class="comment">/* æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰ */</span></span><br><span class="line">    <span class="type">blksize_t</span> st_blksize; <span class="comment">/* æ–‡ä»¶ç³»ç»Ÿ I/O å—å¤§å° */</span></span><br><span class="line">    <span class="type">blkcnt_t</span>  st_blocks;  <span class="comment">/* åˆ†é…çš„å—æ•° */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ—¶é—´æˆ³ */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">st_atim</span>;</span>  <span class="comment">/* æœ€åè®¿é—®æ—¶é—´ */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">st_mtim</span>;</span>  <span class="comment">/* æœ€åä¿®æ”¹æ—¶é—´ */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">timespec</span> <span class="title">st_ctim</span>;</span>  <span class="comment">/* i-node çŠ¶æ€æ”¹å˜æ—¶é—´ */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p><code>sys_stat</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">stat</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="keyword">struct</span> stat *statbuf)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>pathname</code>: è¦æŸ¥è¯¢çš„æ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰</li><li><code>statbuf</code>: æŒ‡å‘ <code>struct stat</code> ç»“æ„çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶ä¿¡æ¯</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å› <code>0</code></li><li>å¤±è´¥æ—¶è¿”å› <code>errno</code>ï¼ˆå¦‚ <code>ENOENT</code>, <code>EACCES</code>, <code>ENOTDIR</code>ï¼‰</li></ul></li></ul></li><li><p><code>sys_fstat</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fstat</span><span class="params">(<span class="type">int</span> fd, <span class="keyword">struct</span> stat *statbuf)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>fd</code>: å·²æ‰“å¼€æ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦</li><li><code>statbuf</code>: æŒ‡å‘ <code>struct stat</code> ç»“æ„çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶ä¿¡æ¯</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å› <code>0</code></li><li>å¤±è´¥æ—¶è¿”å› <code>errno</code>ï¼ˆå¦‚ <code>EBADF</code>, <code>EFAULT</code>ï¼‰</li></ul></li></ul></li><li><p><code>sys_lstat</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">lstat</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="keyword">struct</span> stat *statbuf)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>pathname</code>: è¦æŸ¥è¯¢çš„æ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰</li><li><code>statbuf</code>: æŒ‡å‘ <code>struct stat</code> ç»“æ„çš„æŒ‡é’ˆï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶ä¿¡æ¯</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å› <code>0</code></li><li>å¤±è´¥æ—¶è¿”å› <code>errno</code>ï¼ˆå¦‚ <code>ENOENT</code>, <code>EACCES</code>, <code>ENOTDIR</code>ï¼‰</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">.equ SYS_STAT, 4         # sys_stat ç³»ç»Ÿè°ƒç”¨å·</span><br><span class="line">.equ SYS_FSTAT, 5        # sys_fstat ç³»ç»Ÿè°ƒç”¨å·</span><br><span class="line">.equ SYS_LSTAT, 6        # sys_lstat ç³»ç»Ÿè°ƒç”¨å·</span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">filename:</span><br><span class="line">.ascii &quot;/tmp/test.txt&quot;</span><br><span class="line">statbuf:</span><br><span class="line">.space 144          # struct stat é€šå¸¸ä¸º 144 å­—èŠ‚ï¼ˆx86-64ï¼‰</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line"># ä½¿ç”¨ sys_stat æŸ¥è¯¢æ–‡ä»¶çŠ¶æ€</span><br><span class="line">mov $SYS_STAT, %rax</span><br><span class="line">lea filename(%rip), %rdi</span><br><span class="line">lea statbuf(%rip), %rsi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ sys_fstat æŸ¥è¯¢å·²æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦çŠ¶æ€</span><br><span class="line"># å‡è®¾æ–‡ä»¶æè¿°ç¬¦ä¿å­˜åœ¨ %r8</span><br><span class="line">mov $SYS_FSTAT, %rax</span><br><span class="line">mov %r8, %rdi</span><br><span class="line">lea statbuf(%rip), %rsi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ sys_lstat æŸ¥è¯¢ç¬¦å·é“¾æ¥çŠ¶æ€</span><br><span class="line">mov $SYS_LSTAT, %rax</span><br><span class="line">lea filename(%rip), %rdi</span><br><span class="line">lea statbuf(%rip), %rsi</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line"># é€€å‡º</span><br><span class="line">mov $60, %rax</span><br><span class="line">xor %rdi, %rdi</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><ul><li><code>sys_stat</code> æ ¹æ®æ–‡ä»¶è·¯å¾„è·å–ç›®æ ‡æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚æœè·¯å¾„æ˜¯ç¬¦å·é“¾æ¥ï¼Œå®ƒè¿”å›é“¾æ¥æŒ‡å‘æ–‡ä»¶çš„ä¿¡æ¯ã€‚</li><li><code>sys_fstat</code> ç›´æ¥é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è·å–æ–‡ä»¶çŠ¶æ€ï¼Œä¸ä¾èµ–æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>sys_lstat</code> ç±»ä¼¼äº <code>stat</code>ï¼Œä½†å¦‚æœè·¯å¾„æ˜¯ç¬¦å·é“¾æ¥ï¼Œå®ƒè¿”å›é“¾æ¥æœ¬èº«çš„ä¿¡æ¯è€Œä¸æ˜¯ç›®æ ‡æ–‡ä»¶ã€‚</li></ul><p>  åœ¨æ±‡ç¼–ä¸­ï¼Œè¿™ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨éƒ½é€šè¿‡ <code>%rax</code> æŒ‡å®šç³»ç»Ÿè°ƒç”¨å·ï¼Œæ–‡ä»¶è·¯å¾„æˆ–æ–‡ä»¶æè¿°ç¬¦é€šè¿‡ <code>%rdi</code>ï¼Œ<code>struct stat</code> ç»“æ„æŒ‡é’ˆé€šè¿‡ <code>%rsi</code>ï¼Œè°ƒç”¨ <code>syscall</code> æŒ‡ä»¤æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè¿”å›å€¼å­˜æ”¾åœ¨ <code>%rax</code>ï¼šæˆåŠŸä¸º <code>0</code>ï¼Œå¤±è´¥ä¸º <code>-errno</code>ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_stat&lt;/code&gt; ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;4&lt;/code&gt;ï¼‰ã€&lt;code&gt;sys_fstat&lt;/code&gt; ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;5&lt;/code&gt;ï¼‰å’Œ &lt;code&gt;sys_lstat&lt;/code&gt; ï¼ˆè°ƒç”¨å·ä¸º&lt;code&gt;6&lt;/code&gt;ï¼‰æ˜¯ Linu</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_open ä¸ sys_close</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-open-%E4%B8%8E-sys-close/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-open-%E4%B8%8E-sys-close/</id>
    <published>2025-11-12T14:29:07.000Z</published>
    <updated>2025-11-16T16:22:50.687Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_open</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>2</code>çš„ç³»ç»Ÿè°ƒç”¨ï¼‰ä¸<code>sys_close</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>3</code>çš„ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸¤ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºå¯¹æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œç›¸å…³æ“ä½œã€‚</p><p><code>sys_open</code>ä¼šå°†è¢«æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„è½¬æ¢ä¸ºæ–‡ä»¶æè¿°ç¬¦<code>int fd</code>ï¼Œè¯¥æè¿°ç¬¦å¯ç”¨äºåç»­çš„è¯»å†™æ“ä½œã€‚</p><ul><li><p><code>sys_open</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">open</span><span class="params">(<span class="type">const</span> <span class="type">char</span> * pathname, <span class="type">int</span> flags, <span class="type">mode_t</span> mode)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>pathname</code>: è¦æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰</li><li><code>flags</code>: æ‰“å¼€æ ‡å¿—ï¼ŒæŒ‡å®šæ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ï¼ˆå…·ä½“è¯´æ˜è§ä¸‹ï¼‰</li><li><code>mode</code>: åˆ›å»ºæ–‡ä»¶æ—¶çš„æƒé™æ¨¡å¼ï¼ˆä»…åœ¨ä½¿ç”¨<code>O_CREAT</code>æ—¶æœ‰æ•ˆï¼‰ï¼ˆå…·ä½“è¯´æ˜è§ä¸‹ï¼‰</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼ˆéè´Ÿæ•´æ•°<code>fd</code>ï¼‰</li><li>å¤±è´¥æ—¶è¿”å›<code>-errno</code>ï¼ˆå¦‚<code>ENOENT</code>, <code>EACCES</code>, <code>EMFILE</code>ï¼‰</li></ul></li></ul></li><li><p><code>sys_close</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">close</span><span class="params">(<span class="type">int</span> fd)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>fd</code> : è¦å…³é—­çš„æ–‡ä»¶æè¿°ç¬¦</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›<code>0</code></li><li>å¤±è´¥æ—¶è¿”å›<code>-errno</code>ï¼ˆå¦‚<code>EBADF</code>, <code>EINTR</code>, <code>EIO</code>ï¼‰</li></ul></li></ul></li><li><p><strong><code>flags</code>çš„å®šä¹‰</strong></p><p>  <code>flags</code> çš„èµ‹å€¼é€šå¸¸æ˜¯ç”±â€œåŸºæœ¬è®¿é—®æ¨¡å¼â€ä¸â€œé™„åŠ æ ‡å¿—â€é€šè¿‡æˆ–é€»è¾‘æ‰€é™„åŠ è€Œæ¥çš„ã€‚åœ¨ Linux çš„å¤´æ–‡ä»¶<code>fcntl.h</code> ä¸­ï¼Œè¿™äºŒè€…çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li><p>åŸºæœ¬è®¿é—®æ¨¡å¼</p><table><thead><tr><th>å®å®šä¹‰</th><th>å€¼</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>O_RDONLY</code></td><td><code>0</code></td><td>åªè¯»æ‰“å¼€</td></tr><tr><td><code>O_WRONLY</code></td><td><code>1</code></td><td>åªå†™æ‰“å¼€</td></tr><tr><td><code>O_RDWR</code></td><td><code>2</code></td><td>è¯»å†™æ‰“å¼€</td></tr></tbody></table></li><li><p>é™„åŠ æ ‡å¿—</p><table><thead><tr><th>å®å®šä¹‰</th><th>å€¼ï¼ˆå…«è¿›åˆ¶ï¼‰</th><th>å€¼ï¼ˆåå…­è¿›åˆ¶ï¼‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>O_CREAT</code></td><td><code>0000100</code></td><td><code>0x40</code></td><td>æ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»º</td></tr><tr><td><code>O_EXCL</code></td><td><code>0000200</code></td><td><code>0x80</code></td><td>å’Œ<code>O_CREAT</code> ä¸€èµ·ç”¨ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™å¤±è´¥</td></tr><tr><td><code>O_NOCTTY</code></td><td><code>0000400</code></td><td><code>0x100</code></td><td>ä¸æŠŠæ–‡ä»¶ä½œä¸ºæ§åˆ¶ç»ˆç«¯</td></tr><tr><td><code>O_TRUNC</code></td><td><code>0001000</code></td><td><code>0x200</code></td><td>æˆªæ–­å·²å­˜åœ¨æ–‡ä»¶ä¸º<code>0</code>é•¿åº¦</td></tr><tr><td><code>O_APPEND</code></td><td><code>0002000</code></td><td><code>0x400</code></td><td>å†™æ“ä½œè¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾</td></tr><tr><td><code>O_NONBLOCK</code></td><td><code>0004000</code></td><td><code>0x800</code></td><td>éé˜»å¡ I&#x2F;O</td></tr><tr><td><code>O_NDELAY</code></td><td><code>0004000</code></td><td><code>0x800</code></td><td>ä¸<code>O_NONBLOCK</code>ç›¸åŒ</td></tr><tr><td><code>O_DSYNC</code></td><td><code>0010000</code></td><td><code>0x1000</code></td><td>æ•°æ®åŒæ­¥å†™å…¥</td></tr><tr><td><code>O_SYNC</code></td><td><code>04010000</code></td><td><code>0x101000</code></td><td>æ•°æ®+å…ƒæ•°æ®åŒæ­¥å†™å…¥</td></tr><tr><td><code>O_RSYNC</code></td><td><code>04010000</code></td><td><code>0x101000</code></td><td>ä¸<code>O_SYNC</code>ç›¸åŒï¼ˆå…¼å®¹ï¼‰</td></tr><tr><td><code>FASYNC</code></td><td><code>0020000</code></td><td><code>0x2000</code></td><td>å¼‚æ­¥é€šçŸ¥</td></tr><tr><td><code>O_DIRECT</code></td><td><code>0040000</code></td><td><code>0x4000</code></td><td>ç›´æ¥ I&#x2F;Oï¼Œç»•è¿‡å†…æ ¸ç¼“å­˜</td></tr><tr><td><code>O_LARGEFILE</code></td><td><code>00100000</code></td><td><code>0x8000</code></td><td>å¤§æ–‡ä»¶æ”¯æŒï¼ˆ32ä½ï¼‰</td></tr><tr><td><code>O_DIRECTORY</code></td><td><code>00200000</code></td><td><code>0x10000</code></td><td>å¿…é¡»æ˜¯ç›®å½•ï¼Œå¦åˆ™å‡ºé”™</td></tr><tr><td><code>O_NOFOLLOW</code></td><td><code>00400000</code></td><td><code>0x20000</code></td><td>ä¸è·Ÿéšç¬¦å·é“¾æ¥</td></tr><tr><td><code>O_NOATIME</code></td><td><code>01000000</code></td><td><code>0x40000</code></td><td>ä¸æ›´æ–°æ—¶é—´æˆ³</td></tr><tr><td><code>O_CLOEXEC</code></td><td><code>02000000</code></td><td><code>0x80000</code></td><td>è®¾ç½®<code>FD_CLOEXEC</code>ï¼Œexec æ—¶å…³é—­</td></tr><tr><td><code>O_PATH</code></td><td><code>010000000</code></td><td><code>0x200000</code></td><td>åªè·å–è·¯å¾„å¼•ç”¨ï¼Œä¸æ‰“å¼€æ–‡ä»¶</td></tr><tr><td><code>O_TMPFILE</code></td><td><code>020000000</code></td><td><code>0x400000</code></td><td>åˆ›å»ºåŒ¿åä¸´æ—¶æ–‡ä»¶ï¼ˆéœ€<code>O_DIRECTORY</code>ï¼‰</td></tr><tr><td><code>O_TMPFILE_MASK</code></td><td><code>03777700000</code></td><td>-</td><td>å†…éƒ¨æ©ç ï¼Œç”¨äºå±è”½<code>O_TMPFILE</code></td></tr></tbody></table></li></ul><p>  ä¸Šè¿°æ‰€æœ‰å®åœ¨ç»™æŸä¸€<code>flags</code> èµ‹å€¼æ—¶ï¼Œä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦<code>|</code>è¿›è¡Œè¿æ¥ã€‚å¦‚ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> flags = O_WRONLY | O_CREAT;</span><br></pre></td></tr></table></figure><p>  è¯¥<code>flags</code> æ„ä¸ºï¼šæ‰“å¼€æ–‡ä»¶æ—¶é‡‡ç”¨åªå†™æ¨¡å¼ï¼›ä¸”å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨åˆ›å»ºä¹‹ã€‚</p><p>  å¯ä»¥æƒ³åˆ°ï¼ŒåŸºæœ¬è®¿é—®æ¨¡å¼è¿™ä¸‰è€…<strong>åªèƒ½ç‹¬ç«‹å­˜åœ¨</strong>ï¼Œä¸èƒ½åŒæ—¶å­˜åœ¨äºä¸€ä¸ªè¡¨è¾¾å¼ä¸­ã€‚  </p></li><li><p><strong>æƒé™æ¨¡å¼çš„å®šä¹‰</strong></p><p>  Unix ç³»ç»Ÿçš„æƒé™æ¨¡å¼ç”±ä¸‰ä¸ªéƒ¨åˆ†æ‰€ç»„æˆï¼šæ‰€æœ‰è€…ï¼ˆ<code>owner</code>ï¼‰çš„æƒé™ã€æ‰€æœ‰è€…æ‰€åœ¨ç”¨æˆ·ç»„ä¸­çš„å…¶ä»–ç”¨æˆ·ï¼ˆ<code>group</code>ï¼‰çš„æƒé™ã€éä»¥ä¸Šç”¨æˆ·çš„å…¶ä»–ç”¨æˆ·ï¼ˆ<code>others</code>ï¼‰çš„æƒé™ï¼Œé€šè¿‡æ•°å­—è¿›è¡ŒåŒºåˆ†ã€‚</p><p>  Unix ç³»ç»Ÿçš„æƒé™ä¸»è¦æœ‰ä¸‰ç§ï¼šè¯»ï¼ˆ<code>r</code>ï¼‰ã€å†™ï¼ˆ<code>w</code>ï¼‰ã€æ‰§è¡Œï¼ˆ<code>x</code>ï¼‰ã€‚å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æƒé™</th><th>äºŒè¿›åˆ¶</th><th>å…«è¿›åˆ¶</th></tr></thead><tbody><tr><td><code>---</code></td><td>000</td><td>0</td></tr><tr><td><code>--x</code></td><td>001</td><td>1</td></tr><tr><td><code>-w-</code></td><td>010</td><td>2</td></tr><tr><td><code>-wx</code></td><td>011</td><td>3</td></tr><tr><td><code>r--</code></td><td>100</td><td>4</td></tr><tr><td><code>r-x</code></td><td>101</td><td>5</td></tr><tr><td><code>rw-</code></td><td>110</td><td>6</td></tr><tr><td><code>rwx</code></td><td>111</td><td>7</td></tr></tbody></table><p>  å…¶ä¸­<code>-</code> è¡¨ç¤ºç”¨æˆ·ä¸å…·æœ‰æŸä¸€ç§æƒé™ã€‚æ¯ä¸€ç±»ç”¨æˆ·é€šè¿‡å…«è¿›åˆ¶æ•°æ¥è¡¨ç¤ºè‡ªèº«çš„æƒé™ã€‚ä¸‰ç±»ç”¨æˆ·çš„æ’åˆ—é¡ºåºä¸ºï¼š<code>owner</code>-<code>group</code>-<code>others</code> ã€‚</p><p>  å¦‚ä¸€ä¸ªæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒçš„æƒé™æ¨¡å¼ä¸ºï¼š<br>  <code>rwxrwxrwx</code> ï¼Œäº¦å³<code>0777</code>ã€‚</p></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.equ FLAGS, 0x241             # O_WRONLY | O_CREAT | O_TRUNC </span><br><span class="line"></span><br><span class="line">.section .data</span><br><span class="line">filename:</span><br><span class="line">.asciz &quot;/tmp/test.txt&quot;      # è¦æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„</span><br><span class="line">buffer:</span><br><span class="line">.ascii &quot;Hello from sys_open!\n\0&quot;</span><br><span class="line">buffer_len = . - buffer</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">  # è°ƒç”¨ sys_open åˆ›å»º/æ‰“å¼€æ–‡ä»¶</span><br><span class="line">  mov $2, %rax              # ç³»ç»Ÿè°ƒç”¨å· (2 = sys_open)</span><br><span class="line">  lea filename(%rip), %rdi  # const char *pathname = &amp;filename</span><br><span class="line">  mov $FLAGS, %rsi          # é€šè¿‡å®å®šä¹‰ç»™ flags èµ‹å€¼</span><br><span class="line">  mov $0644, %rdx           # mode = 0644 (rw-r--r--)</span><br><span class="line">  syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  </span><br><span class="line">  # ä¿å­˜æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">  mov %rax, %r8             # ä¿å­˜æ–‡ä»¶æè¿°ç¬¦åˆ° %r8</span><br><span class="line">  </span><br><span class="line">  # ä½¿ç”¨ sys_write å‘æ–‡ä»¶å†™å…¥æ•°æ®</span><br><span class="line">  mov $1, %rax              # ç³»ç»Ÿè°ƒç”¨å· (1 = sys_write)</span><br><span class="line">  mov %r8, %rdi             # ä½¿ç”¨åˆšæ‰æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">  lea buffer(%rip), %rsi    # const void *buf = &amp;buffer</span><br><span class="line">  mov $buffer_len, %rdx     # count = buffer_len</span><br><span class="line">  syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  </span><br><span class="line">  # ä½¿ç”¨ sys_close å…³é—­æ–‡ä»¶</span><br><span class="line">  mov $3, %rax              # ç³»ç»Ÿè°ƒç”¨å· (3 = sys_close)</span><br><span class="line">  mov %r8, %rdi             # å…³é—­æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">  syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  </span><br><span class="line">  # é€€å‡º</span><br><span class="line">  mov $60, %rax             # ç³»ç»Ÿè°ƒç”¨å· (60 = sys_exit)</span><br><span class="line">  xor %rdi, %rdi            # return 0</span><br><span class="line">  syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>sys_open</code>ç³»ç»Ÿè°ƒç”¨åˆ›å»ºå¹¶æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå†™å…¥æ“ä½œã€‚</p><p>  ç¨‹åºé¦–å…ˆå®šä¹‰äº†è¦æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„<code>filename</code>å’Œè¦å†™å…¥çš„æ•°æ®<code>buffer</code>ã€‚åœ¨<code>_start</code>æ ‡ç­¾å¤„ï¼Œç¨‹åºå°†ç³»ç»Ÿè°ƒç”¨å·<code>2</code>ï¼ˆ<code>sys_open</code>ï¼‰å­˜å…¥<code>%rax</code>å¯„å­˜å™¨ï¼Œå°†æ–‡ä»¶è·¯å¾„åœ°å€åŠ è½½åˆ°<code>%rdi</code>ï¼Œè®¾ç½®æ‰“å¼€æ ‡å¿—ä¸º<code>0x241</code>ï¼ˆ<code>O_WRONLY | O_CREAT | O_TRUNC</code>ï¼Œè¡¨ç¤ºåªå†™ã€å¦‚ä¸å­˜åœ¨åˆ™åˆ›å»ºã€æˆªæ–­ä¸º0é•¿åº¦ï¼‰ï¼Œå¹¶è®¾ç½®æ–‡ä»¶æƒé™ä¸º<code>0644</code>ã€‚è¿™ä¸ªæ“ä½œï¼Œç”¨ C è¯­è¨€æ¥å†™çš„è¯ï¼Œå°±æ˜¯ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> fd = open(<span class="string">&quot;/tmp/test.txt&quot;</span>, O_WRONLY | O_CREAT | O_TRUNC, <span class="number">0644</span>);</span><br></pre></td></tr></table></figure><p>  åœ¨æ‰§è¡Œ<code>syscall</code>æŒ‡ä»¤åï¼Œç³»ç»Ÿè°ƒç”¨ä¼šå°è¯•æ‰“å¼€æŒ‡å®šçš„è¿™ä¸ªæ–‡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œæ–‡ä»¶æè¿°ç¬¦ä¼šå­˜å‚¨åœ¨<code>%rax</code>ä¸­ï¼›å¦‚æœå¤±è´¥ï¼Œ<code>%rax</code>å°†åŒ…å«è´Ÿå€¼ã€‚</p><p>  æˆåŠŸæ‰“å¼€æ–‡ä»¶åï¼Œæˆ‘ä»¬å°†æ–‡ä»¶æè¿°ç¬¦å¤‡ä»½åˆ°<code>%r8</code>å¯„å­˜å™¨ï¼Œä»¥é˜²æ­¢åœ¨åé¢è°ƒç”¨åˆ°å…¶ä»–ç³»ç»Ÿè°ƒç”¨æ—¶è¦†ç›–äº†åŸæœ¬çš„æ–‡ä»¶æè¿°ç¬¦ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>sys_write</code>å‘è¯¥æ–‡ä»¶ä¸­å†™å…¥æˆ‘ä»¬å‡†å¤‡å¥½çš„æ•°æ®ã€‚æœ€åï¼Œç¨‹åºä½¿ç”¨<code>sys_close</code>ï¼ˆç³»ç»Ÿè°ƒç”¨å·ä¸º<code>3</code>ï¼‰å…³é—­æ–‡ä»¶æè¿°ç¬¦ï¼Œé‡Šæ”¾ç³»ç»Ÿèµ„æºï¼Œå¹¶è°ƒç”¨<code>sys_exit</code>æ­£å¸¸é€€å‡ºã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_open&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;2&lt;/code&gt;çš„ç³»ç»Ÿè°ƒç”¨ï¼‰ä¸&lt;code&gt;sys_close&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;3&lt;/code&gt;çš„ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸¤ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºå¯¹æ–‡ä»¶æè¿°ç¬¦è¿›è¡Œç›¸å…³æ“ä½œã€‚&lt;/p&gt;
&lt;p</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_write</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-write/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-write/</id>
    <published>2025-11-12T14:28:49.000Z</published>
    <updated>2025-11-16T16:23:41.642Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_write</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>1</code>çš„<code>write</code>ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºå‘æŸä¸€æ–‡ä»¶æè¿°ç¬¦ä¸­å†™å…¥æ•°æ®ã€‚å®ƒä»æŒ‡å®šçš„æŸä¸€å†…å­˜åŒºåŸŸè¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ°ç›®æ ‡ï¼Œè¿”å›å€¼ä¸ºå®é™…å†™å…¥çš„å­—èŠ‚æ•°ã€‚</p><ul><li><p><code>sys_write</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œå³å†™å…¥çš„ä½ç½®æ‰€åœ¨</li><li><code>buf</code>: ç¼“å†²åŒºæŒ‡é’ˆï¼Œè¦å†™å…¥çš„æ•°æ®æ¥æº</li><li><code>count</code>: è¦å†™å…¥å¤šå°‘å­—èŠ‚</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›å®é™…å†™å…¥çš„å­—èŠ‚æ•°</li><li>å¤±è´¥æ—¶è¿”å›<code>-errno</code>ï¼ˆå¦‚<code>EBADF</code>, <code>EPIPE</code>, <code>ENOSPC</code>ï¼‰</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.section .data</span><br><span class="line">message:</span><br><span class="line">.ascii &quot;Hello, World!\n&quot;</span><br><span class="line">msg_len = . - message</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">  # è°ƒç”¨ sys_write è¾“å‡ºæ¶ˆæ¯</span><br><span class="line">  mov $1, %rax              # ç³»ç»Ÿè°ƒç”¨å· (1 = sys_write)</span><br><span class="line">  mov $1, %rdi              # æ–‡ä»¶æè¿°ç¬¦ (1 = stdout)</span><br><span class="line">  lea message(%rip), %rsi   # ä½¿å¾— const void * buf = &amp;message</span><br><span class="line">  mov $msg_len, %rdx        # count = msg_len (æ¶ˆæ¯é•¿åº¦)</span><br><span class="line">  syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  </span><br><span class="line">  # é€€å‡ºç¨‹åº</span><br><span class="line">  mov $60, %rax             # ç³»ç»Ÿè°ƒç”¨å· (60 = sys_exit)</span><br><span class="line">  xor %rdi, %rdi            # return 0</span><br><span class="line">  syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>sys_write</code>å‘æ ‡å‡†è¾“å‡ºï¼ˆ<code>stdout</code>ï¼Œæ–‡ä»¶æè¿°ç¬¦<code>1</code>ï¼‰å†™å…¥æ•°æ®ã€‚</p><p>  ç¨‹åºé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªå­—ç¬¦ä¸²<code>message</code>ï¼Œå¹¶è®¡ç®—å…¶é•¿åº¦<code>msg_len</code>ã€‚åœ¨<code>_start</code>æ ‡ç­¾å¤„ï¼Œç¨‹åºå°†ç³»ç»Ÿè°ƒç”¨å·<code>1</code>ï¼ˆ<code>sys_write</code>ï¼‰å­˜å…¥<code>%rax</code>å¯„å­˜å™¨ï¼Œå°†æ–‡ä»¶æè¿°ç¬¦<code>1</code>ï¼ˆ<code>stdout</code>ï¼‰å­˜å…¥<code>%rdi</code>ï¼Œå°†<code>message</code>çš„åœ°å€åŠ è½½åˆ°<code>%rsi</code>ï¼Œå¹¶è®¾ç½®è¦å†™å…¥çš„å­—èŠ‚æ•°ä¸º<code>msg_len</code>ã€‚äº¦å³ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write(<span class="number">1</span>, &amp;message, msg_len);</span><br></pre></td></tr></table></figure><p>  æ‰§è¡Œ<code>syscall</code>æŒ‡ä»¤åï¼Œç³»ç»Ÿè°ƒç”¨ä¼šå°†æ¶ˆæ¯æ•°æ®å†™å…¥åˆ°æ ‡å‡†è¾“å‡ºï¼Œç”¨æˆ·å¯ä»¥åœ¨ç»ˆç«¯çœ‹åˆ°è¾“å‡ºçš„æ–‡å­—ã€‚å®é™…å†™å…¥çš„å­—èŠ‚æ•°ä¼šå­˜å‚¨åœ¨<code>%rax</code>ä¸­ã€‚</p><p>  æœ€åï¼Œç¨‹åºè°ƒç”¨<code>sys_exit</code>ï¼ˆç³»ç»Ÿè°ƒç”¨å·ä¸º<code>60</code>ï¼‰æ­£å¸¸é€€å‡ºï¼Œè¿”å›å€¼ä¸º<code>0</code>è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_write&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;1&lt;/code&gt;çš„&lt;code&gt;write&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºå‘æŸä¸€æ–‡ä»¶æè¿°ç¬¦ä¸­å†™å…¥æ•°æ®ã€‚å®ƒä»æŒ‡å®šçš„æŸä¸€å†…å­˜åŒºåŸŸè¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶å†™å…¥åˆ°ç›®æ ‡ï¼Œè¿”å›å€¼ä¸ºå®é™…å†™å…¥çš„å­—èŠ‚</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>sys_read</title>
    <link href="https://redstone6835.github.io/2025/11/12/sys-read/"/>
    <id>https://redstone6835.github.io/2025/11/12/sys-read/</id>
    <published>2025-11-12T14:28:43.000Z</published>
    <updated>2025-11-16T16:23:16.791Z</updated>
    
    <content type="html"><![CDATA[<p><code>sys_read</code>ï¼ˆå³è°ƒç”¨å·ä¸º<code>0</code>çš„<code>read</code>ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºä»æ–‡ä»¶æè¿°ç¬¦ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å­˜å‚¨åœ¨ä¸€æ®µæŒ‡å®šçš„å†…å­˜åŒºåŸŸä¸­ï¼Œè¿”å›å€¼ä¸ºè¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚</p><ul><li><p><code>sys_read</code></p><ul><li><p><strong>å‡½æ•°åŸå‹</strong></p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">read</span><span class="params">(<span class="type">int</span> fd, <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>å‚æ•°</strong></p><ul><li><code>fd</code>: æ–‡ä»¶æè¿°ç¬¦ï¼Œå³æŒ‡å®šè¯»å–çš„â€œæºâ€ä¹‹æ‰€åœ¨</li><li><code>buf</code>: ç¼“å†²åŒºæŒ‡é’ˆï¼Œæ•°æ®å°†è¢«è¯»å–åˆ°è¿™é‡Œ</li><li><code>count</code>: è¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°</li></ul></li><li><p><strong>è¿”å›å€¼</strong></p><ul><li>æˆåŠŸæ—¶è¿”å›å®é™…è¯»å–çš„å­—èŠ‚æ•°</li><li>è¿”å›0è¡¨ç¤ºå·²åˆ°è¾¾æ–‡ä»¶æœ«å°¾(<code>EOF</code>)</li><li>å¤±è´¥æ—¶è¿”å›<code>-errno</code>ï¼ˆå¦‚<code>EINTR</code>, <code>EBADF</code>ï¼‰</li></ul></li></ul></li><li><p><strong>ç”¨ä¾‹</strong></p>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">.section .data</span><br><span class="line">buffer: </span><br><span class="line">.space 128</span><br><span class="line"></span><br><span class="line">.section .text</span><br><span class="line">.globl _start</span><br><span class="line"></span><br><span class="line">_start:</span><br><span class="line">  # è°ƒç”¨ sys_read è¯»å–æ•°æ®</span><br><span class="line">  mov $0, %rax               # ç³»ç»Ÿè°ƒç”¨å· (0 = sys_read)</span><br><span class="line">  mov $0, %rdi               # æ–‡ä»¶æè¿°ç¬¦ (0 = stdin)</span><br><span class="line">  lea buffer(%rip), %rsi    # ä½¿å¾— void * buf = &amp;buffer</span><br><span class="line">  mov $128, %rdx            # count = 128 (å‰é¢å®šä¹‰ buffer çš„é•¿åº¦)</span><br><span class="line">  syscall                   # æ‰§è¡Œç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  </span><br><span class="line">  # æ•°æ®è¯»å–å®Œæ¯•ï¼Œå­˜å‚¨åœ¨ buffer ä¸­</span><br><span class="line">  # è¿”å›å€¼ %rax ä¸ºè¯»å–çš„å­—èŠ‚é•¿åº¦</span><br><span class="line">  mov %rax, %r12            # å¤‡ä»½ %rax è‡³ %r12</span><br><span class="line">  </span><br><span class="line">  # è°ƒç”¨ sys_write å°†åˆšåˆšè¾“å…¥çš„æ•°æ®æ‰“å°å‡ºæ¥</span><br><span class="line">mov $1, %rax              # ç³»ç»Ÿè°ƒç”¨å· (1 = sys_write)</span><br><span class="line">  mov $1, %rdi              # æ–‡ä»¶æè¿°ç¬¦ (1 = stdout)</span><br><span class="line">  lea buffer(%rip), %rsi    # ä½¿å¾—void * buf = &amp;buffer</span><br><span class="line">mov %r12, %rdx            # ä½¿å¾— sys_write è¾“å‡ºçš„é•¿åº¦ä¸ºå‰é¢è¯»å–çš„å­—èŠ‚é•¿åº¦</span><br><span class="line">syscall</span><br><span class="line"></span><br><span class="line">  # é€€å‡ºç¨‹åº</span><br><span class="line">  mov $60, %rax             # ç³»ç»Ÿè°ƒç”¨å· (60 = sys_exit)</span><br><span class="line">  xor %rdi, %rdi            # return 0</span><br><span class="line">  syscall</span><br></pre></td></tr></table></figure><p>  <strong>åˆ†æ</strong>ï¼š</p><p>  ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>sys_read</code>ç³»ç»Ÿè°ƒç”¨ä»æ ‡å‡†è¾“å…¥ï¼ˆ<code>stdin</code>ï¼Œæ–‡ä»¶æè¿°ç¬¦<code>0</code>ï¼‰è¯»å–æ•°æ®ã€‚</p><p>  ç¨‹åºé¦–å…ˆå®šä¹‰äº†ä¸€ä¸ª<code>128</code>å­—èŠ‚çš„<code>buffer</code>ä½œä¸ºå­˜å‚¨è¯»å–æ•°æ®çš„ç¼“å†²åŒºã€‚åœ¨<code>_start</code>æ ‡ç­¾å¤„ï¼Œç¨‹åºå°†ç³»ç»Ÿè°ƒç”¨å·<code>0</code>ï¼ˆ<code>sys_read</code>ï¼‰å­˜å…¥ <code>%rax</code>å¯„å­˜å™¨ï¼Œå°†æ–‡ä»¶æè¿°ç¬¦<code>0</code>ï¼ˆ<code>stdin</code>ï¼‰å­˜å…¥<code>%rdi</code>ï¼Œå°†<code>buffer</code>çš„åœ°å€åŠ è½½åˆ°<code>%rsi</code>ï¼Œå¹¶è®¾ç½®è¦è¯»å–çš„æœ€å¤§å­—èŠ‚æ•°ä¸º<code>128</code>ã€‚æ­¤å³ä¸ºä»¥ä¸‹ä»£ç æ‰€æŒ‡çš„è°ƒç”¨ï¼š</p>  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read(<span class="number">0</span>, &amp;buffer, <span class="number">128</span>);</span><br></pre></td></tr></table></figure><p>  æ‰§è¡Œ<code>syscall</code>æŒ‡ä»¤åï¼Œç³»ç»Ÿè°ƒç”¨ä¼šä»æ ‡å‡†è¾“å…¥è¯»å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å®é™…è¯»å–çš„å­—èŠ‚æ•°å­˜å‚¨åœ¨<code>%rax</code>ä¸­ã€‚</p><p>  éšåï¼Œç¨‹åºå°†è¿”å›å€¼ï¼ˆè¯»å–çš„å­—èŠ‚æ•°ï¼‰å¤‡ä»½åˆ°<code>%r12</code>å¯„å­˜å™¨ï¼Œç„¶åå‡†å¤‡è°ƒç”¨<code>sys_write</code>ï¼ˆç³»ç»Ÿè°ƒç”¨å·ä¸º<code>1</code>ï¼‰å°†è¯»å–çš„æ•°æ®è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆ<code>stdout</code>ï¼Œæ–‡ä»¶æè¿°ç¬¦<code>1</code>ï¼‰ã€‚æœ€åï¼Œç¨‹åºè°ƒç”¨<code>sys_exit</code>ï¼ˆç³»ç»Ÿè°ƒç”¨å·ä¸º<code>60</code>ï¼‰é€€å‡ºï¼Œè¿”å›å€¼ä¸º<code>0</code>è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;sys_read&lt;/code&gt;ï¼ˆå³è°ƒç”¨å·ä¸º&lt;code&gt;0&lt;/code&gt;çš„&lt;code&gt;read&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼‰æ˜¯ Linux ä¸­çš„ä¸€ä¸ªåŸºæœ¬ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨äºä»æ–‡ä»¶æè¿°ç¬¦ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å­˜å‚¨åœ¨ä¸€æ®µæŒ‡å®šçš„å†…å­˜åŒºåŸŸä¸­ï¼Œè¿”å›å€¼ä¸ºè¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux x86_64 ç³»ç»Ÿè°ƒç”¨è¡¨</title>
    <link href="https://redstone6835.github.io/2025/11/12/Linux-x86-64-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8/"/>
    <id>https://redstone6835.github.io/2025/11/12/Linux-x86-64-%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E8%A1%A8/</id>
    <published>2025-11-12T07:27:52.000Z</published>
    <updated>2025-11-12T07:29:02.106Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¯´æ˜ï¼š</p><ul><li><p>è°ƒç”¨å·å­˜æ”¾åœ¨ <code>%rax</code></p></li><li><p>å‰å…­ä¸ªå‚æ•°ä¾æ¬¡åœ¨ <code>%rdi</code>, <code>%rsi</code>, <code>%rdx</code>, <code>%r10</code>, <code>%r8</code>, <code>%r9</code></p></li><li><p>è¿”å›å€¼å­˜æ”¾åœ¨ <code>%rax</code></p></li><li><p>é”™è¯¯æ—¶è¿”å› <code>-1</code> å¹¶è®¾ç½® <code>errno</code></p></li></ul></blockquote><table><thead><tr><th>ç³»ç»Ÿè°ƒç”¨å·</th><th>åç§°</th><th>å‡½æ•°åŸå‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>0</code></td><td><code>read</code></td><td><code>ssize_t read(int fd, void *buf, size_t count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ‰€ä»£è¡¨çš„è®¾å¤‡æˆ–æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚å®ƒå°†æœ€å¤š <code>count</code> å­—èŠ‚çš„æ•°æ®ä¼ è¾“è‡³ç”± <code>buf</code> æŒ‡å‘çš„ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºã€‚è¿”å›å€¼ä¸ºå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œè‹¥åˆ°è¾¾æ–‡ä»¶æœ«å°¾åˆ™è¿”å› <code>0</code>ï¼Œè‹¥å‘ç”Ÿé”™è¯¯åˆ™è¿”å› <code>-1</code>ã€‚è¯¥è°ƒç”¨æ˜¯ä¸€ä¸ªé˜»å¡å¼æ“ä½œï¼Œé™¤éæ–‡ä»¶æè¿°ç¬¦è¢«è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼ã€‚</td></tr><tr><td><code>1</code></td><td><code>write</code></td><td><code>ssize_t write(int fd, const void *buf, size_t count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æœ€å¤š <code>count</code> å­—èŠ‚çš„æ•°æ®ä»ç”¨æˆ·ç©ºé—´ç¼“å†²åŒº <code>buf</code> å†™å…¥ç”±æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ‰€ä»£è¡¨çš„æ–‡ä»¶æˆ–è®¾å¤‡ä¸­ã€‚è¿”å›å€¼ä¸ºå®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼Œè‹¥å‘ç”Ÿé”™è¯¯åˆ™è¿”å› <code>-1</code>ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå†™å…¥çš„å­—èŠ‚æ•°å¯èƒ½å°äºè¯·æ±‚çš„ <code>count</code>ã€‚</td></tr><tr><td><code>2</code></td><td><code>open</code></td><td><code>int open(const char *pathname, int flags, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ‰“å¼€ä¸€ä¸ªç”± <code>pathname</code> æŒ‡å®šçš„æ–‡ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¯ç”¨äºåç»­æ“ä½œï¼ˆå¦‚ <code>read</code> æˆ– <code>write</code>ï¼‰çš„æ–‡ä»¶æè¿°ç¬¦ã€‚<code>flags</code> å‚æ•°æ§åˆ¶æ‰“å¼€æ¨¡å¼ï¼ˆå¦‚åªè¯»ã€åªå†™æˆ–è¯»å†™ï¼‰ï¼Œ<code>mode</code> å‚æ•°åˆ™åœ¨åˆ›å»ºæ–°æ–‡ä»¶æ—¶æŒ‡å®šå…¶æƒé™ã€‚è‹¥æˆåŠŸåˆ™è¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥åˆ™è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>3</code></td><td><code>close</code></td><td><code>int close(int fd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå…³é—­æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ï¼Œä½¿å…¶ä¸å†å¼•ç”¨ä»»ä½•æ–‡ä»¶ï¼Œå¹¶é‡Šæ”¾è¯¥æè¿°ç¬¦æ‰€å…³è”çš„ç³»ç»Ÿèµ„æºã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>4</code></td><td><code>stat</code></td><td><code>int stat(const char *pathname, struct stat *statbuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ç”± <code>pathname</code> æŒ‡å®šçš„æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ <code>statbuf</code> ç»“æ„ä½“ä¸­ã€‚è¿™äº›ä¿¡æ¯åŒ…æ‹¬æ–‡ä»¶ç±»å‹ã€æƒé™ã€å¤§å°ã€æœ€åä¿®æ”¹æ—¶é—´ç­‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>5</code></td><td><code>fstat</code></td><td><code>int fstat(int fd, struct stat *statbuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>stat</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥è·å–å·²æ‰“å¼€æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™é¿å…äº†æ–‡ä»¶è·¯å¾„è§£æè¿‡ç¨‹ä¸­çš„æ½œåœ¨ç«æ€æ¡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>6</code></td><td><code>lstat</code></td><td><code>int lstat(const char *pathname, struct stat *statbuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç±»ä¼¼äº <code>stat</code>ï¼Œä½†å¦‚æœ <code>pathname</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šè¿”å›ç¬¦å·é“¾æ¥æœ¬èº«çš„çŠ¶æ€ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>7</code></td><td><code>poll</code></td><td><code>int poll(struct pollfd *fds, nfds_t nfds, int timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç›‘è§†ä¸€ç»„æ–‡ä»¶æè¿°ç¬¦ï¼Œä»¥ç­‰å¾…å…¶ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæè¿°ç¬¦å‡†å¤‡å¥½è¿›è¡Œ I&#x2F;O æ“ä½œã€‚å®ƒæ£€æŸ¥æ¯ä¸ª <code>pollfd</code> ç»“æ„ä½“ä¸­çš„ <code>events</code>ï¼Œå¹¶åœ¨ç›¸åº”çš„ <code>revents</code> å­—æ®µä¸­è¿”å›å°±ç»ªäº‹ä»¶ã€‚<code>timeout</code> å‚æ•°æŒ‡å®šäº†ç­‰å¾…çš„æ¯«ç§’æ•°ã€‚è¿”å›å€¼ä¸ºå°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦æ€»æ•°ï¼Œè¶…æ—¶è¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>8</code></td><td><code>lseek</code></td><td><code>off_t lseek(int fd, off_t offset, int whence);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé‡æ–°å®šä½æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> çš„è¯»&#x2F;å†™ä½ç½®ã€‚<code>offset</code> å‚æ•°æŒ‡å®šåç§»é‡ï¼Œ<code>whence</code> åˆ™æŒ‡å®šåç§»çš„èµ·å§‹ä½ç½®ï¼ˆå¦‚æ–‡ä»¶å¼€å¤´ <code>SEEK_SET</code>ã€å½“å‰ä½ç½® <code>SEEK_CUR</code> æˆ–æ–‡ä»¶æœ«å°¾ <code>SEEK_END</code>ï¼‰ã€‚è¿”å›å€¼ä¸ºæ–°çš„æ–‡ä»¶ä½ç½®ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>9</code></td><td><code>mmap</code></td><td><code>void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªæ–‡ä»¶æˆ–è®¾å¤‡çš„ä¸€éƒ¨åˆ†æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚å®ƒå…è®¸è¿›ç¨‹åƒè®¿é—®å†…å­˜ä¸€æ ·è®¿é—®æ–‡ä»¶å†…å®¹ï¼Œä»è€Œé¿å…äº† <code>read</code>&#x2F;<code>write</code> è°ƒç”¨å¸¦æ¥çš„å¼€é”€ã€‚æˆåŠŸè¿”å›æ˜ å°„åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼Œå¤±è´¥è¿”å› <code>MAP_FAILED</code>ã€‚</td></tr><tr><td><code>10</code></td><td><code>mprotect</code></td><td><code>int mprotect(void *addr, size_t len, int prot);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¿®æ”¹ä¸€ä¸ªè¿›ç¨‹å†…å­˜åŒºåŸŸçš„ä¿æŠ¤æƒé™ã€‚<code>addr</code> å’Œ <code>len</code> æŒ‡å®šäº†è¦ä¿®æ”¹çš„å†…å­˜åŒºåŸŸï¼Œ<code>prot</code> å‚æ•°åˆ™è®¾ç½®æ–°çš„æƒé™ï¼Œå¦‚å¯è¯»ã€å¯å†™æˆ–å¯æ‰§è¡Œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>11</code></td><td><code>munmap</code></td><td><code>int munmap(void *addr, size_t length);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå–æ¶ˆè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„æ˜ å°„ã€‚å®ƒé‡Šæ”¾äº†ç”± <code>mmap</code> åˆ›å»ºçš„å†…å­˜åŒºåŸŸï¼Œä½¿å…¶ä¸å†å¯è®¿é—®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>12</code></td><td><code>brk</code></td><td><code>int brk(void *addr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜è¿›ç¨‹æ•°æ®æ®µçš„ç»“æŸä½ç½®ï¼Œé€šå¸¸ç§°ä¸º <code>program break</code>ã€‚å®ƒå¯ä»¥é€šè¿‡è°ƒæ•´ <code>brk</code> çš„å€¼æ¥åŠ¨æ€åœ°åˆ†é…æˆ–é‡Šæ”¾å†…å­˜ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>13</code></td><td><code>rt_sigaction</code></td><td><code>int rt_sigaction(int signum, const struct sigaction *act, struct sigaction *oldact, size_t sigsetsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ£€æŸ¥æˆ–æ”¹å˜ä¸ç‰¹å®šä¿¡å· <code>signum</code> ç›¸å…³çš„å¤„ç†è¡Œä¸ºã€‚å®ƒæ˜¯ä¸€ä¸ªæ›´å…ˆè¿›å’Œæ›´å¥å£®çš„ä¿¡å·å¤„ç†ç‰ˆæœ¬ï¼Œæ”¯æŒå®æ—¶ä¿¡å·ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>14</code></td><td><code>rt_sigprocmask</code></td><td><code>int rt_sigprocmask(int how, const sigset_t *set, sigset_t *oldset, size_t sigsetsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ£€æŸ¥æˆ–æ”¹å˜è¿›ç¨‹çš„ä¿¡å·é˜»å¡æ©ç ã€‚å®ƒå¯ä»¥ç”¨äºé˜»å¡ï¼ˆ<code>SIG_BLOCK</code>ï¼‰ã€è§£é™¤é˜»å¡ï¼ˆ<code>SIG_UNBLOCK</code>ï¼‰æˆ–è®¾ç½®ï¼ˆ<code>SIG_SETMASK</code>ï¼‰ä¿¡å·é›†ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>15</code></td><td><code>rt_sigreturn</code></td><td><code>int rt_sigreturn(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»ä¿¡å·å¤„ç†å‡½æ•°ä¸­è¿”å›ã€‚å®ƒæ¢å¤äº†åœ¨è¿›å…¥ä¿¡å·å¤„ç†å‡½æ•°ä¹‹å‰ä¿å­˜çš„è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬å¯„å­˜å™¨å’Œä¿¡å·æ©ç ã€‚è¯¥è°ƒç”¨é€šå¸¸ç”±å†…æ ¸è‡ªåŠ¨ç”Ÿæˆï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·ç›´æ¥è°ƒç”¨ã€‚</td></tr><tr><td><code>16</code></td><td><code>ioctl</code></td><td><code>int ioctl(int fd, unsigned long request, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹è®¾å¤‡æ‰§è¡Œç‰¹å®šçš„ I&#x2F;O æ§åˆ¶æ“ä½œã€‚<code>fd</code> æ˜¯è®¾å¤‡çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>request</code> æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œã€‚å…¶åçš„å‚æ•°å–å†³äºå…·ä½“è¯·æ±‚ã€‚è¯¥è°ƒç”¨æä¾›äº†å¯¹è®¾å¤‡åº•å±‚åŠŸèƒ½çš„è®¿é—®ï¼Œå¦‚é…ç½®ç»ˆç«¯ã€è°ƒæ•´é©±åŠ¨ç¨‹åºå‚æ•°ç­‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>17</code></td><td><code>pread64</code></td><td><code>ssize_t pread64(int fd, void *buf, size_t count, off64_t offset);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> ä¸­è¯»å–æ•°æ®ï¼Œä½†å®ƒåœ¨ <code>offset</code> å¤„å¼€å§‹è¯»å–ï¼Œå¹¶ä¸”ä¸æ”¹å˜æ–‡ä»¶æè¿°ç¬¦çš„å½“å‰è¯»&#x2F;å†™ä½ç½®ã€‚è¿™å¯¹äºå¤šçº¿ç¨‹æˆ–å¹¶å‘è®¿é—®åŒä¸€ä¸ªæ–‡ä»¶éå¸¸æœ‰ç”¨ã€‚è¿”å›å€¼ä¸ºå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>18</code></td><td><code>pwrite64</code></td><td><code>ssize_t pwrite64(int fd, const void *buf, size_t count, off64_t offset);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> å†™å…¥æ•°æ®ï¼Œä½†å®ƒåœ¨ <code>offset</code> å¤„å¼€å§‹å†™å…¥ï¼Œå¹¶ä¸”ä¸æ”¹å˜æ–‡ä»¶æè¿°ç¬¦çš„å½“å‰è¯»&#x2F;å†™ä½ç½®ã€‚è¿™ä¸ <code>pread64</code> ç±»ä¼¼ï¼Œæä¾›äº†åŸå­æ€§çš„å†™å…¥æ“ä½œï¼Œé¿å…äº†æ–‡ä»¶æŒ‡é’ˆçš„ç«äº‰ã€‚è¿”å›å€¼ä¸ºå®é™…å†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>19</code></td><td><code>readv</code></td><td><code>ssize_t readv(int fd, const struct iovec *iov, int iovcnt);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œä¸€ä¸ªåˆ†æ•£è¯»å–æ“ä½œã€‚å®ƒä»æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> ä¸­è¯»å–æ•°æ®ï¼Œå¹¶æŒ‰é¡ºåºå°†æ•°æ®åˆ†æ•£åˆ°ç”± <code>iov</code> æ•°ç»„ï¼ˆ<code>iovec</code> ç»“æ„ä½“ï¼‰æŒ‡å®šçš„å¤šä¸ªç¼“å†²åŒºä¸­ã€‚<code>iovcnt</code> æ˜¯ <code>iov</code> æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ã€‚è¿”å›å€¼ä¸ºè¯»å–çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>20</code></td><td><code>writev</code></td><td><code>ssize_t writev(int fd, const struct iovec *iov, int iovcnt);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œä¸€ä¸ªé›†ä¸­å†™å…¥æ“ä½œã€‚å®ƒå°†ç”± <code>iov</code> æ•°ç»„ï¼ˆ<code>iovec</code> ç»“æ„ä½“ï¼‰æŒ‡å®šçš„å¤šä¸ªç¼“å†²åŒºä¸­çš„æ•°æ®ï¼ŒæŒ‰é¡ºåºé›†ä¸­å†™å…¥åˆ°æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> ä¸­ã€‚<code>iovcnt</code> æ˜¯ <code>iov</code> æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ã€‚è¿”å›å€¼ä¸ºå†™å…¥çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>21</code></td><td><code>access</code></td><td><code>int access(const char *pathname, int mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ£€æŸ¥è°ƒç”¨è¿›ç¨‹æ˜¯å¦å…·æœ‰å¯¹ <code>pathname</code> æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ã€‚<code>mode</code> å‚æ•°æŒ‡å®šè¦æ£€æŸ¥çš„æƒé™ç±»å‹ï¼Œå¦‚ <code>R_OK</code>ï¼ˆå¯è¯»ï¼‰ã€<code>W_OK</code>ï¼ˆå¯å†™ï¼‰ã€<code>X_OK</code>ï¼ˆå¯æ‰§è¡Œï¼‰æˆ– <code>F_OK</code>ï¼ˆæ–‡ä»¶å­˜åœ¨ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>22</code></td><td><code>pipe</code></td><td><code>int pipe(int pipefd[2]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªç®€å•çš„ç®¡é“ï¼Œç”¨äºè¿›ç¨‹é—´çš„é€šä¿¡ã€‚å®ƒåˆ›å»ºä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>pipefd[0]</code> ç”¨äºè¯»å–ï¼Œ<code>pipefd[1]</code> ç”¨äºå†™å…¥ã€‚å†™å…¥ <code>pipefd[1]</code> çš„æ•°æ®å¯ä»¥ä» <code>pipefd[0]</code> ä¸­è¯»å–ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>23</code></td><td><code>select</code></td><td><code>int select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦é›†ï¼Œä»¥ç­‰å¾…å…¶ä¸­ä»»ä½•ä¸€ä¸ªæè¿°ç¬¦å‡†å¤‡å¥½è¿›è¡Œ I&#x2F;O æ“ä½œã€‚å®ƒèƒ½å¤ŸåŒæ—¶ç›‘è§†å¯è¯»ã€å¯å†™å’Œå¼‚å¸¸æƒ…å†µã€‚è¿”å›å€¼ä¸ºå°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦æ€»æ•°ï¼Œè¶…æ—¶è¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>24</code></td><td><code>sched_yield</code></td><td><code>int sched_yield(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè‡ªæ„¿åœ°æ”¾å¼ƒ CPUï¼Œå…è®¸å…¶ä»–å…·æœ‰ç›¸åŒæˆ–æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹æˆ–è¿›ç¨‹è¿è¡Œã€‚å®ƒå°†è°ƒç”¨è¿›ç¨‹ä»è¿è¡Œé˜Ÿåˆ—ä¸­ç§»åˆ°å°±ç»ªé˜Ÿåˆ—çš„æœ«å°¾ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>25</code></td><td><code>mremap</code></td><td><code>void *mremap(void *old_address, size_t old_size, size_t new_size, int flags, ... /* void *new_address */);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè°ƒæ•´ç°æœ‰å†…å­˜æ˜ å°„çš„å¤§å°ã€‚å®ƒå°† <code>old_address</code> å¼€å§‹çš„ <code>old_size</code> å­—èŠ‚å†…å­˜æ˜ å°„é‡æ–°æ˜ å°„åˆ° <code>new_size</code> å­—èŠ‚ã€‚å¯ä»¥ç”¨äºæ‰©å¤§æˆ–ç¼©å°ä¸€ä¸ªå†…å­˜åŒºåŸŸã€‚æˆåŠŸè¿”å›æ–°æ˜ å°„çš„èµ·å§‹åœ°å€ï¼Œå¤±è´¥è¿”å› <code>MAP_FAILED</code>ã€‚</td></tr><tr><td><code>26</code></td><td><code>msync</code></td><td><code>int msync(void *addr, size_t length, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†å†…å­˜æ˜ å°„åŒºåŸŸä¸­çš„ä¿®æ”¹æ•°æ®åŒæ­¥åˆ°æ–‡ä»¶ã€‚å®ƒç¡®ä¿å¯¹å†…å­˜ä¸­çš„æ›´æ”¹è¢«å†™å…¥åˆ°åº•å±‚æ–‡ä»¶ç³»ç»Ÿï¼Œä»è€Œä¿æŒæ–‡ä»¶å’Œå†…å­˜çš„åŒæ­¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>27</code></td><td><code>mincore</code></td><td><code>int mincore(void *addr, size_t length, unsigned char *vec);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç¡®å®šè™šæ‹Ÿå†…å­˜åŒºåŸŸçš„å“ªäº›é¡µé¢å½“å‰ä½äºç‰©ç†å†…å­˜ï¼ˆRAMï¼‰ä¸­ã€‚å®ƒå°†ç»“æœå­˜å‚¨åœ¨ <code>vec</code> æ•°ç»„ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªå­—èŠ‚å¯¹åº”ä¸€ä¸ªé¡µé¢ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>28</code></td><td><code>madvise</code></td><td><code>int madvise(void *addr, size_t length, int advice);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘ŠçŸ¥å†…æ ¸å¦‚ä½•å¤„ç†ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜åŒºåŸŸã€‚<code>advice</code> å‚æ•°å¯ä»¥æä¾›å…³äºæœªæ¥å†…å­˜è®¿é—®æ¨¡å¼çš„å»ºè®®ï¼Œä¾‹å¦‚ <code>MADV_SEQUENTIAL</code>ï¼ˆæŒ‰é¡ºåºè®¿é—®ï¼‰æˆ– <code>MADV_WILLNEED</code>ï¼ˆå³å°†è®¿é—®ï¼‰ï¼Œä»è€Œå¸®åŠ©å†…æ ¸è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>29</code></td><td><code>shmget</code></td><td><code>int shmget(key_t key, size_t size, int shmflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å…±äº«å†…å­˜æ®µæˆ–è·å–ä¸€ä¸ªå·²æœ‰çš„å…±äº«å†…å­˜æ®µã€‚<code>key</code> ç”¨äºæ ‡è¯†å…±äº«å†…å­˜æ®µï¼Œ<code>size</code> æŒ‡å®šæ®µçš„å¤§å°ï¼Œ<code>shmflg</code> åˆ™æ§åˆ¶åˆ›å»ºæ ‡å¿—å’Œæƒé™ã€‚æˆåŠŸè¿”å›å…±äº«å†…å­˜æ ‡è¯†ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>30</code></td><td><code>shmat</code></td><td><code>void *shmat(int shmid, const void *shmaddr, int shmflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ç”± <code>shmid</code> æ ‡è¯†çš„å…±äº«å†…å­˜æ®µé™„åŠ åˆ°è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚<code>shmaddr</code> å¯ç”¨äºæŒ‡å®šé™„åŠ åœ°å€ï¼Œå¦‚æœä¸º <code>NULL</code> åˆ™ç”±å†…æ ¸é€‰æ‹©ã€‚æˆåŠŸè¿”å›é™„åŠ çš„åœ°å€ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>31</code></td><td><code>shmctl</code></td><td><code>int shmctl(int shmid, int cmd, struct shmid_ds *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹ç”± <code>shmid</code> æ ‡è¯†çš„å…±äº«å†…å­˜æ®µæ‰§è¡Œæ§åˆ¶æ“ä½œã€‚<code>cmd</code> å‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚åˆ é™¤å…±äº«å†…å­˜æ®µï¼ˆ<code>IPC_RMID</code>ï¼‰æˆ–è·å–çŠ¶æ€ä¿¡æ¯ï¼ˆ<code>IPC_STAT</code>ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>32</code></td><td><code>dup</code></td><td><code>int dup(int oldfd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒæ˜¯ <code>oldfd</code> çš„ä¸€ä¸ªå‰¯æœ¬ã€‚æ–°çš„æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘ä¸ <code>oldfd</code> ç›¸åŒçš„åº•å±‚æ–‡ä»¶æˆ–è®¾å¤‡ï¼Œå¹¶ä¸”å…±äº«æ–‡ä»¶æŒ‡é’ˆã€æ–‡ä»¶çŠ¶æ€æ ‡å¿—ç­‰ã€‚è¿”å›å€¼ä¸ºæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>33</code></td><td><code>dup2</code></td><td><code>int dup2(int oldfd, int newfd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°† <code>newfd</code> é‡å®šå‘ä¸º <code>oldfd</code> çš„å‰¯æœ¬ã€‚å¦‚æœ <code>newfd</code> å·²ç»æ‰“å¼€ï¼Œå®ƒä¼šå…ˆè¢«å…³é—­ã€‚æ­¤æ“ä½œæ˜¯åŸå­æ€§çš„ã€‚<code>dup2</code> æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æŠ€å·§ï¼Œä¾‹å¦‚ç”¨äºé‡å®šå‘æ ‡å‡†è¾“å…¥&#x2F;è¾“å‡ºã€‚æˆåŠŸè¿”å› <code>newfd</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>34</code></td><td><code>pause</code></td><td><code>int pause(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä½¿è°ƒç”¨è¿›ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç›´åˆ°æ¥æ”¶åˆ°ä¸€ä¸ªä¿¡å·ä¸ºæ­¢ã€‚å®ƒä¸ä¼šè¿”å›ï¼Œé™¤éä¿¡å·å¤„ç†å‡½æ•°è¿”å›ï¼Œæˆ–è€…è¿›ç¨‹è¢«ä¸€ä¸ªæœªè¢«å¿½ç•¥çš„ä¿¡å·ç»ˆæ­¢ã€‚è¿”å›å€¼ä¸º <code>-1</code> å¹¶è®¾ç½® <code>errno</code> ä¸º <code>EINTR</code>ã€‚</td></tr><tr><td><code>35</code></td><td><code>nanosleep</code></td><td><code>int nanosleep(const struct timespec *req, struct timespec *rem);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®©è°ƒç”¨è¿›ç¨‹ç²¾ç¡®åœ°æš‚åœæŒ‡å®šçš„çº³ç§’çº§æ—¶é—´ã€‚<code>req</code> æŒ‡å®šè¯·æ±‚çš„ç¡çœ æ—¶é—´ï¼Œ<code>rem</code> å¯ç”¨äºè·å–å‰©ä½™çš„ç¡çœ æ—¶é—´ï¼Œå¦‚æœè°ƒç”¨è¢«ä¿¡å·ä¸­æ–­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œè¢«ä¿¡å·ä¸­æ–­è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>36</code></td><td><code>getitimer</code></td><td><code>int getitimer(int which, struct itimerval *curr_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šé—´éš”å®šæ—¶å™¨çš„å½“å‰å€¼ã€‚<code>which</code> å‚æ•°æŒ‡å®šå®šæ—¶å™¨çš„ç±»å‹ï¼Œä¾‹å¦‚ <code>ITIMER_REAL</code>ï¼ˆå®æ—¶å®šæ—¶å™¨ï¼‰ã€‚å½“å‰å€¼è¢«å­˜å‚¨åœ¨ <code>curr_value</code> ç»“æ„ä½“ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>37</code></td><td><code>alarm</code></td><td><code>unsigned int alarm(unsigned int seconds);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨æŒ‡å®šçš„ <code>seconds</code> ç§’åå‘è°ƒç”¨è¿›ç¨‹å‘é€ <code>SIGALRM</code> ä¿¡å·ã€‚å¦‚æœ <code>seconds</code> ä¸º <code>0</code>ï¼Œåˆ™å–æ¶ˆä»»ä½•å¾…å®šçš„å®šæ—¶å™¨ã€‚è¿”å›å€¼ä¸ºå‰ä¸€ä¸ªå®šæ—¶å™¨å‰©ä½™çš„ç§’æ•°ã€‚</td></tr><tr><td><code>38</code></td><td><code>setitimer</code></td><td><code>int setitimer(int which, const struct itimerval *new_value, struct itimerval *old_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–ä¿®æ”¹æŒ‡å®šçš„é—´éš”å®šæ—¶å™¨ã€‚<code>which</code> æŒ‡å®šå®šæ—¶å™¨ç±»å‹ï¼Œ<code>new_value</code> è®¾ç½®æ–°çš„å€¼ï¼Œè€Œ <code>old_value</code> åˆ™å¯é€‰åœ°ç”¨äºè·å–å‰ä¸€ä¸ªå€¼ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>39</code></td><td><code>getpid</code></td><td><code>pid_t getpid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„è¿›ç¨‹ IDã€‚è¯¥ ID åœ¨ç³»ç»ŸèŒƒå›´å†…æ˜¯å”¯ä¸€çš„ã€‚è¿”å›å€¼ä¸ºè¿›ç¨‹ IDã€‚</td></tr><tr><td><code>40</code></td><td><code>sendfile</code></td><td><code>ssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´é›¶æ‹·è´åœ°ä¼ è¾“æ•°æ®ã€‚å®ƒç›´æ¥ä» <code>in_fd</code> ä¼ è¾“æœ€å¤š <code>count</code> å­—èŠ‚æ•°æ®åˆ° <code>out_fd</code>ï¼Œæ— éœ€é€šè¿‡ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºã€‚è¿™å¯¹äºé«˜æ•ˆåœ°ä¼ è¾“æ–‡ä»¶å†…å®¹éå¸¸æœ‰ç”¨ã€‚è¿”å›å€¼ä¸ºå®é™…ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>41</code></td><td><code>socket</code></td><td><code>int socket(int domain, int type, int protocol);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å¥—æ¥å­—ã€‚<code>domain</code> å‚æ•°æŒ‡å®šåè®®æ—ï¼ˆå¦‚ <code>AF_INET</code> ç”¨äº IPv4ï¼‰ï¼Œ<code>type</code> æŒ‡å®šå¥—æ¥å­—ç±»å‹ï¼ˆå¦‚ <code>SOCK_STREAM</code> ç”¨äº TCPï¼‰ï¼Œ<code>protocol</code> é€šå¸¸ä¸º <code>0</code>ã€‚æˆåŠŸè¿”å›æ–°çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>42</code></td><td><code>connect</code></td><td><code>int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªå¥—æ¥å­—è¿æ¥åˆ°æŒ‡å®šçš„ç½‘ç»œåœ°å€ <code>addr</code>ã€‚è¿™é€šå¸¸ç”¨äºå®¢æˆ·ç«¯ç¨‹åºå»ºç«‹ä¸æœåŠ¡å™¨çš„è¿æ¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>43</code></td><td><code>accept</code></td><td><code>int accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ¥å—ä¸€ä¸ªä¼ å…¥çš„è¿æ¥è¯·æ±‚ã€‚å®ƒä»ç›‘å¬å¥—æ¥å­— <code>sockfd</code> çš„é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªè¿æ¥ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„å·²è¿æ¥å¥—æ¥å­—ã€‚æ–°å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦è¢«è¿”å›ï¼Œå¯ç”¨äºä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚æˆåŠŸè¿”å›æ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>44</code></td><td><code>sendto</code></td><td><code>ssize_t sendto(int sockfd, const void *buf, size_t len, int flags, const struct sockaddr *dest_addr, socklen_t addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨æ— è¿æ¥çš„å¥—æ¥å­—ï¼ˆå¦‚ UDPï¼‰ä¸Šå‘é€æ•°æ®ã€‚å®ƒå°† <code>buf</code> ä¸­çš„æ•°æ®å‘é€åˆ°ç”± <code>dest_addr</code> æŒ‡å®šçš„ç›®æ ‡åœ°å€ã€‚è¿”å›å€¼ä¸ºå‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>45</code></td><td><code>recvfrom</code></td><td><code>ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨æ— è¿æ¥çš„å¥—æ¥å­—ï¼ˆå¦‚ UDPï¼‰ä¸Šæ¥æ”¶æ•°æ®ã€‚å®ƒä»å¥—æ¥å­— <code>sockfd</code> ä¸­è¯»å–æ•°æ®å¹¶å°†å…¶å­˜å‚¨åœ¨ <code>buf</code> ä¸­ï¼ŒåŒæ—¶å°†å‘é€æ–¹çš„åœ°å€ä¿¡æ¯å­˜å‚¨åœ¨ <code>src_addr</code> ä¸­ã€‚è¿”å›å€¼ä¸ºæ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>46</code></td><td><code>sendmsg</code></td><td><code>ssize_t sendmsg(int sockfd, const struct msghdr *msg, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æä¾›äº†æ¯” <code>sendto</code> æ›´é€šç”¨çš„æ•°æ®å‘é€æ–¹å¼ã€‚å®ƒé€šè¿‡ <code>msghdr</code> ç»“æ„ä½“ï¼Œå¯ä»¥å‘é€å¤šä¸ªä¸è¿ç»­çš„ç¼“å†²åŒºï¼Œå¹¶æ”¯æŒå‘é€è¾…åŠ©æ•°æ®ï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ï¼‰ã€‚è¿”å›å€¼ä¸ºå‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>47</code></td><td><code>recvmsg</code></td><td><code>ssize_t recvmsg(int sockfd, struct msghdr *msg, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æä¾›äº†æ¯” <code>recvfrom</code> æ›´é€šç”¨çš„æ•°æ®æ¥æ”¶æ–¹å¼ã€‚å®ƒé€šè¿‡ <code>msghdr</code> ç»“æ„ä½“ï¼Œå¯ä»¥æ¥æ”¶å¤šä¸ªä¸è¿ç»­çš„ç¼“å†²åŒºï¼Œå¹¶æ”¯æŒæ¥æ”¶è¾…åŠ©æ•°æ®ã€‚è¿”å›å€¼ä¸ºæ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>48</code></td><td><code>shutdown</code></td><td><code>int shutdown(int sockfd, int how);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºéƒ¨åˆ†æˆ–å®Œå…¨å…³é—­ä¸€ä¸ªå¥—æ¥å­—çš„è¿æ¥ã€‚<code>how</code> å‚æ•°æ§åˆ¶å…³é—­æ–¹å‘ï¼š<code>SHUT_RD</code>ï¼ˆç¦æ­¢åç»­è¯»å–ï¼‰ã€<code>SHUT_WR</code>ï¼ˆç¦æ­¢åç»­å†™å…¥ï¼‰æˆ– <code>SHUT_RDWR</code>ï¼ˆç¦æ­¢è¯»å†™ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>49</code></td><td><code>bind</code></td><td><code>int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªå¥—æ¥å­—ä¸ä¸€ä¸ªç‰¹å®šçš„æœ¬åœ°åœ°å€ï¼ˆå¦‚ IP åœ°å€å’Œç«¯å£å·ï¼‰å…³è”èµ·æ¥ã€‚è¿™é€šå¸¸ç”¨äºæœåŠ¡å™¨ç¨‹åºï¼Œä»¥ä¾¿ç›‘å¬è¯¥åœ°å€ä¸Šçš„ä¼ å…¥è¿æ¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>50</code></td><td><code>listen</code></td><td><code>int listen(int sockfd, int backlog);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªå¥—æ¥å­—è®¾ç½®ä¸ºè¢«åŠ¨æ¨¡å¼ï¼Œä»¥ä¾¿æ¥å—ä¼ å…¥çš„è¿æ¥ã€‚<code>backlog</code> å‚æ•°æŒ‡å®šäº†ç­‰å¾…æ¥å—çš„è¿æ¥è¯·æ±‚é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>51</code></td><td><code>getsockname</code></td><td><code>int getsockname(int sockfd, struct sockaddr *addr, socklen_t *addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šå¥—æ¥å­— <code>sockfd</code> çš„æœ¬åœ°åœ°å€ä¿¡æ¯ã€‚åœ°å€ä¿¡æ¯è¢«å­˜å‚¨åœ¨ <code>addr</code> ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>52</code></td><td><code>getpeername</code></td><td><code>int getpeername(int sockfd, struct sockaddr *addr, socklen_t *addrlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ä¸æŒ‡å®šå¥—æ¥å­— <code>sockfd</code> è¿æ¥çš„å¯¹ç«¯ï¼ˆpeerï¼‰çš„åœ°å€ä¿¡æ¯ã€‚åœ°å€ä¿¡æ¯è¢«å­˜å‚¨åœ¨ <code>addr</code> ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>53</code></td><td><code>socketpair</code></td><td><code>int socketpair(int domain, int type, int protocol, int sv[2]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€å¯¹ç›¸äº’è¿æ¥çš„æ— åå¥—æ¥å­—ã€‚<code>sv</code> æ•°ç»„å°†åŒ…å«ä¸¤ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒä»¬å¯ä»¥ç”¨äºåŒå‘é€šä¿¡ã€‚è¿™é€šå¸¸ç”¨äºçˆ¶å­è¿›ç¨‹æˆ–åŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹é—´é€šä¿¡ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>54</code></td><td><code>setsockopt</code></td><td><code>int setsockopt(int sockfd, int level, int optname, const void *optval, socklen_t optlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®å¥—æ¥å­—é€‰é¡¹ã€‚<code>level</code> æŒ‡å®šé€‰é¡¹çš„åè®®å±‚ï¼Œ<code>optname</code> æŒ‡å®šé€‰é¡¹åç§°ï¼Œ<code>optval</code> å’Œ <code>optlen</code> æä¾›é€‰é¡¹å€¼ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç”¨æ¥è®¾ç½®å¥—æ¥å­—ä¸ºéé˜»å¡æ¨¡å¼æˆ–å¯ç”¨åœ°å€é‡ç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>55</code></td><td><code>getsockopt</code></td><td><code>int getsockopt(int sockfd, int level, int optname, void *optval, socklen_t *optlen);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å¥—æ¥å­—é€‰é¡¹ã€‚å®ƒä¸ <code>setsockopt</code> ç±»ä¼¼ï¼Œä½†ç”¨äºæ£€ç´¢é€‰é¡¹çš„å½“å‰å€¼ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>56</code></td><td><code>clone</code></td><td><code>int clone(int (*fn)(void *), void *child_stack, int flags, void *arg, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹æˆ–çº¿ç¨‹ã€‚å®ƒæ¯” <code>fork</code> æ›´çµæ´»ï¼Œå…è®¸è°ƒç”¨è€…ç²¾ç¡®æ§åˆ¶æ–°è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«å“ªäº›èµ„æºï¼Œå¦‚å†…å­˜ã€æ–‡ä»¶æè¿°ç¬¦å’Œä¿¡å·å¤„ç†ç¨‹åºã€‚æˆåŠŸè¿”å›å­è¿›ç¨‹çš„ PIDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>57</code></td><td><code>fork</code></td><td><code>pid_t fork(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œå®ƒæ˜¯è°ƒç”¨è¿›ç¨‹çš„ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å‰¯æœ¬ã€‚å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹æ‹¥æœ‰ç›¸åŒçš„ä»£ç ã€æ•°æ®å’Œæ–‡ä»¶æè¿°ç¬¦å‰¯æœ¬ï¼Œä½†æœ‰è‡ªå·±çš„ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚æˆåŠŸè¿”å›å­è¿›ç¨‹çš„ PIDï¼ˆåœ¨çˆ¶è¿›ç¨‹ä¸­ï¼‰ï¼Œæˆ– <code>0</code>ï¼ˆåœ¨å­è¿›ç¨‹ä¸­ï¼‰ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>58</code></td><td><code>vfork</code></td><td><code>pid_t vfork(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹ï¼Œä¸ <code>fork</code> ç±»ä¼¼ï¼Œä½†å®ƒåœ¨åˆ›å»ºåå…±äº«çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚çˆ¶è¿›ç¨‹ä¼šé˜»å¡ï¼Œç›´åˆ°å­è¿›ç¨‹è°ƒç”¨ <code>execve</code> æˆ– <code>_exit</code>ã€‚å®ƒä¸»è¦ç”¨äºå¿«é€Ÿåˆ›å»ºæ–°è¿›ç¨‹ä»¥æ‰§è¡Œæ–°ç¨‹åºã€‚è¿”å›è§„åˆ™ä¸ <code>fork</code> ç›¸åŒã€‚</td></tr><tr><td><code>59</code></td><td><code>execve</code></td><td><code>int execve(const char *pathname, char *const argv[], char *const envp[]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨å½“å‰è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä¸€ä¸ªæ–°çš„ç¨‹åºã€‚å®ƒåŠ è½½ <code>pathname</code> æŒ‡å®šçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶ç”¨ <code>argv</code> å’Œ <code>envp</code> æä¾›çš„å‚æ•°å’Œç¯å¢ƒå˜é‡æ›¿æ¢å½“å‰è¿›ç¨‹çš„æ˜ åƒã€‚å¦‚æœæˆåŠŸï¼Œå®ƒä¸ä¼šè¿”å›ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>60</code></td><td><code>exit</code></td><td><code>void exit(int status);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç»ˆæ­¢è°ƒç”¨è¿›ç¨‹ã€‚<code>status</code> å‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½œä¸ºè¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ç è¿”å›ç»™çˆ¶è¿›ç¨‹ã€‚å®ƒä¼šæ‰§è¡Œæ‰€æœ‰å¿…è¦çš„æ¸…ç†å·¥ä½œï¼ŒåŒ…æ‹¬å…³é—­æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ã€‚æ­¤è°ƒç”¨æ°¸ä¸è¿”å›ã€‚</td></tr><tr><td><code>61</code></td><td><code>wait4</code></td><td><code>pid_t wait4(pid_t pid, int *wstatus, int options, struct rusage *rusage);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç­‰å¾…ä¸€ä¸ªå­è¿›ç¨‹çŠ¶æ€çš„æ”¹å˜ï¼ˆå¦‚ç»ˆæ­¢æˆ–åœæ­¢ï¼‰ã€‚å®ƒå¯ä»¥ç­‰å¾…æŒ‡å®š PID çš„å­è¿›ç¨‹ï¼Œæˆ–è€…ä»»ä½•å­è¿›ç¨‹ã€‚å®ƒè¿˜å¯ä»¥åœ¨ <code>rusage</code> ä¸­è¿”å›å­è¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µã€‚æˆåŠŸè¿”å›å·²ç»ˆæ­¢å­è¿›ç¨‹çš„ PIDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>62</code></td><td><code>kill</code></td><td><code>int kill(pid_t pid, int sig);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æŒ‡å®šçš„è¿›ç¨‹æˆ–è¿›ç¨‹ç»„å‘é€ä¿¡å·ã€‚<code>pid</code> æŒ‡å®šç›®æ ‡è¿›ç¨‹ï¼Œ<code>sig</code> æŒ‡å®šè¦å‘é€çš„ä¿¡å·ã€‚å®ƒå¯ä»¥ç”¨äºç»ˆæ­¢è¿›ç¨‹ã€æš‚åœè¿›ç¨‹æˆ–æ‰§è¡Œå…¶ä»–ä¿¡å·ç›¸å…³çš„æ“ä½œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>63</code></td><td><code>uname</code></td><td><code>int uname(struct utsname *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å½“å‰ç³»ç»Ÿçš„ä¿¡æ¯ã€‚å®ƒå°†ç³»ç»Ÿåç§°ã€ç‰ˆæœ¬å·ã€å†…æ ¸ç‰ˆæœ¬ç­‰ä¿¡æ¯å¡«å……åˆ° <code>utsname</code> ç»“æ„ä½“ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>64</code></td><td><code>semget</code></td><td><code>int semget(key_t key, int nsems, int semflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ä¿¡å·é‡é›†æˆ–è·å–ä¸€ä¸ªå·²æœ‰çš„ä¿¡å·é‡é›†ã€‚<code>key</code> ç”¨äºæ ‡è¯†ä¿¡å·é‡é›†ï¼Œ<code>nsems</code> æŒ‡å®šä¿¡å·é‡çš„æ•°é‡ï¼Œ<code>semflg</code> åˆ™æ§åˆ¶åˆ›å»ºæ ‡å¿—å’Œæƒé™ã€‚æˆåŠŸè¿”å›ä¿¡å·é‡é›†æ ‡è¯†ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>65</code></td><td><code>semop</code></td><td><code>int semop(int semid, struct sembuf *sops, size_t nsops);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ç”± <code>semid</code> æ ‡è¯†çš„ä¿¡å·é‡é›†ä¸Šæ‰§è¡ŒåŸå­æ€§çš„æ“ä½œã€‚<code>sops</code> æ˜¯ä¸€ä¸ª <code>sembuf</code> ç»“æ„ä½“æ•°ç»„ï¼Œæ¯ä¸ªç»“æ„ä½“å®šä¹‰ä¸€ä¸ªæ“ä½œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>66</code></td><td><code>semctl</code></td><td><code>int semctl(int semid, int semnum, int cmd, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹ç”± <code>semid</code> æ ‡è¯†çš„ä¿¡å·é‡é›†æ‰§è¡Œæ§åˆ¶æ“ä½œã€‚<code>cmd</code> å‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚åˆ é™¤ä¿¡å·é‡é›†ï¼ˆ<code>IPC_RMID</code>ï¼‰æˆ–è®¾ç½®ä¿¡å·é‡å€¼ï¼ˆ<code>SETVAL</code>ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>67</code></td><td><code>shmdt</code></td><td><code>int shmdt(const void *shmaddr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ç”± <code>shmaddr</code> æŒ‡å®šçš„å…±äº«å†…å­˜æ®µä»è°ƒç”¨è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­åˆ†ç¦»ã€‚å®ƒä¸ä¼šåˆ é™¤å…±äº«å†…å­˜æ®µï¼Œåªæ˜¯è§£é™¤è¿›ç¨‹ä¸å…¶çš„å…³è”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>68</code></td><td><code>msgget</code></td><td><code>int msgget(key_t key, int msgflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆæ¯é˜Ÿåˆ—æˆ–è·å–ä¸€ä¸ªå·²æœ‰çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚<code>key</code> ç”¨äºæ ‡è¯†æ¶ˆæ¯é˜Ÿåˆ—ï¼Œ<code>msgflg</code> åˆ™æ§åˆ¶åˆ›å»ºæ ‡å¿—å’Œæƒé™ã€‚æˆåŠŸè¿”å›æ¶ˆæ¯é˜Ÿåˆ—æ ‡è¯†ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>69</code></td><td><code>msgsnd</code></td><td><code>int msgsnd(int msqid, const void *msgp, size_t msgsz, int msgflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€æ¡æ¶ˆæ¯å‘é€åˆ°ç”± <code>msqid</code> æ ‡è¯†çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚<code>msgp</code> æŒ‡å‘æ¶ˆæ¯æ•°æ®ï¼Œ<code>msgsz</code> æŒ‡å®šæ¶ˆæ¯å¤§å°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>70</code></td><td><code>msgrcv</code></td><td><code>ssize_t msgrcv(int msqid, void *msgp, size_t msgsz, long msgtyp, int msgflg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»ç”± <code>msqid</code> æ ‡è¯†çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ¥æ”¶ä¸€æ¡æ¶ˆæ¯ã€‚<code>msgtyp</code> æŒ‡å®šè¦æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹ã€‚æˆåŠŸè¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>71</code></td><td><code>msgctl</code></td><td><code>int msgctl(int msqid, int cmd, struct msqid_ds *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹ç”± <code>msqid</code> æ ‡è¯†çš„æ¶ˆæ¯é˜Ÿåˆ—æ‰§è¡Œæ§åˆ¶æ“ä½œã€‚<code>cmd</code> å‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚åˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ<code>IPC_RMID</code>ï¼‰æˆ–è·å–çŠ¶æ€ä¿¡æ¯ï¼ˆ<code>IPC_STAT</code>ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>72</code></td><td><code>fcntl</code></td><td><code>int fcntl(int fd, int cmd, ... /* arg */);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ‰§è¡Œæ§åˆ¶æ“ä½œã€‚<code>cmd</code> å‚æ•°æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œï¼Œå¦‚å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ï¼ˆ<code>F_DUPFD</code>ï¼‰ã€è·å–&#x2F;è®¾ç½®æ–‡ä»¶çŠ¶æ€æ ‡å¿—ï¼ˆ<code>F_GETFL</code>&#x2F;<code>F_SETFL</code>ï¼‰æˆ–ç®¡ç†æ–‡ä»¶é”ã€‚æˆåŠŸè¿”å›å–å†³äº <code>cmd</code> çš„å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>73</code></td><td><code>flock</code></td><td><code>int flock(int fd, int operation);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹æ•´ä¸ªæ–‡ä»¶åº”ç”¨æˆ–ç§»é™¤æ–‡ä»¶é”ã€‚<code>fd</code> æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>operation</code> æŒ‡å®šé”çš„ç±»å‹ï¼ˆå…±äº«é” <code>LOCK_SH</code>ã€æ’ä»–é” <code>LOCK_EX</code>ï¼‰æˆ–æ“ä½œï¼ˆè§£é” <code>LOCK_UN</code>ï¼‰ã€‚è¯¥é”æ˜¯å»ºè®®æ€§é”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>74</code></td><td><code>fsync</code></td><td><code>int fsync(int fd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ‰€ä»£è¡¨çš„æ–‡ä»¶æ‰€æœ‰è¢«ä¿®æ”¹çš„ç¼“å†²åŒºæ•°æ®å†™å…¥åº•å±‚ç£ç›˜ï¼Œå¹¶ç­‰å¾… I&#x2F;O å®Œæˆã€‚è¿™ç¡®ä¿äº†æ•°æ®åœ¨ç³»ç»Ÿå´©æºƒæ—¶ä¸ä¼šä¸¢å¤±ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>75</code></td><td><code>fdatasync</code></td><td><code>int fdatasync(int fd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>fsync</code> ç±»ä¼¼ï¼Œä½†å®ƒåªåŒæ­¥æ–‡ä»¶æ•°æ®ï¼Œä¸åŒ…æ‹¬å…ƒæ•°æ®ï¼ˆå¦‚æ–‡ä»¶å¤§å°æˆ–æ—¶é—´æˆ³ï¼‰ï¼Œé™¤éè¿™äº›å…ƒæ•°æ®å¯¹äºåç»­çš„æ•°æ®è¯»å–è‡³å…³é‡è¦ã€‚è¿™é€šå¸¸æ¯” <code>fsync</code> æ›´å¿«ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>76</code></td><td><code>truncate</code></td><td><code>int truncate(const char *path, off_t length);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ç”± <code>path</code> æŒ‡å®šçš„æ–‡ä»¶æˆªæ–­ä¸ºæŒ‡å®šçš„ <code>length</code> å­—èŠ‚å¤§å°ã€‚å¦‚æœæ–‡ä»¶å¤§äº <code>length</code>ï¼Œåˆ™å¤šä½™çš„æ•°æ®å°†è¢«ä¸¢å¼ƒï¼›å¦‚æœæ–‡ä»¶å°äº <code>length</code>ï¼Œåˆ™æ–‡ä»¶å°†è¢«æ‰©å±•ï¼Œæ‰©å±•çš„éƒ¨åˆ†å°†å¡«å……é›¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>77</code></td><td><code>ftruncate</code></td><td><code>int ftruncate(int fd, off_t length);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>truncate</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥æ“ä½œå·²æ‰“å¼€çš„æ–‡ä»¶ã€‚å®ƒå°†æ–‡ä»¶æˆªæ–­æˆ–æ‰©å±•åˆ°æŒ‡å®šçš„ <code>length</code> å­—èŠ‚å¤§å°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>78</code></td><td><code>getdents</code></td><td><code>int getdents(int fd, struct linux_dirent *dirp, unsigned int count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè¯»å–ç”±æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æŒ‡å®šçš„ç›®å½•ä¸­çš„ç›®å½•é¡¹ã€‚å®ƒå°†ç›®å½•é¡¹ä¿¡æ¯å¡«å……åˆ° <code>dirp</code> ç¼“å†²åŒºä¸­ï¼Œæœ€å¤šè¯»å– <code>count</code> å­—èŠ‚ã€‚è¿”å›å€¼ä¸ºå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>79</code></td><td><code>getcwd</code></td><td><code>char *getcwd(char *buf, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„åã€‚è·¯å¾„åè¢«å¤åˆ¶åˆ° <code>buf</code> ä¸­ï¼Œæœ€å¤š <code>size</code> å­—èŠ‚ã€‚æˆåŠŸè¿”å› <code>buf</code>ï¼Œå¤±è´¥è¿”å› <code>NULL</code>ã€‚</td></tr><tr><td><code>80</code></td><td><code>chdir</code></td><td><code>int chdir(const char *path);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†è°ƒç”¨è¿›ç¨‹çš„å½“å‰å·¥ä½œç›®å½•æ›´æ”¹ä¸ºç”± <code>path</code> æŒ‡å®šçš„ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>81</code></td><td><code>fchdir</code></td><td><code>int fchdir(int fd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>chdir</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥æ›´æ”¹å½“å‰å·¥ä½œç›®å½•ã€‚è¿™å…è®¸åœ¨ä¸æŒ‡å®šè·¯å¾„åçš„æƒ…å†µä¸‹æ›´æ”¹ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>82</code></td><td><code>rename</code></td><td><code>int rename(const char *oldpath, const char *newpath);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„åç§°æˆ–ä½ç½®ã€‚å®ƒå°† <code>oldpath</code> æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•é‡å‘½åä¸º <code>newpath</code>ã€‚å¦‚æœ <code>newpath</code> å·²ç»å­˜åœ¨ï¼Œåˆ™å®ƒä¼šè¢«åŸå­æ€§åœ°æ›¿æ¢ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>83</code></td><td><code>mkdir</code></td><td><code>int mkdir(const char *pathname, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ã€‚<code>pathname</code> æŒ‡å®šæ–°ç›®å½•çš„è·¯å¾„ï¼Œ<code>mode</code> åˆ™æŒ‡å®šæ–°ç›®å½•çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>84</code></td><td><code>rmdir</code></td><td><code>int rmdir(const char *pathname);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ é™¤ä¸€ä¸ªç©ºç›®å½•ã€‚å¦‚æœç›®å½•ä¸ä¸ºç©ºï¼Œåˆ™æ­¤è°ƒç”¨ä¼šå¤±è´¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>85</code></td><td><code>creat</code></td><td><code>int creat(const char *pathname, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºå¹¶æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™å…¶å†…å®¹ä¼šè¢«æˆªæ–­ä¸ºé›¶å­—èŠ‚ã€‚å®ƒç­‰åŒäº &#96;open(pathname, O_CREAT</td></tr><tr><td><code>86</code></td><td><code>link</code></td><td><code>int link(const char *oldpath, const char *newpath);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªç¡¬é“¾æ¥ã€‚å®ƒå°† <code>newpath</code> æŒ‡å‘ä¸ <code>oldpath</code> ç›¸åŒçš„åº•å±‚æ–‡ä»¶ã€‚ç¡¬é“¾æ¥ä¸èƒ½è·¨è¶Šæ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿä¸èƒ½é“¾æ¥åˆ°ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>87</code></td><td><code>unlink</code></td><td><code>int unlink(const char *pathname);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ é™¤æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªåç§°ã€‚å¦‚æœ <code>pathname</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸€ä¸ªç¡¬é“¾æ¥ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•è¿›ç¨‹æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œé‚£ä¹ˆæ–‡ä»¶æœ¬èº«å°†è¢«åˆ é™¤ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>88</code></td><td><code>symlink</code></td><td><code>int symlink(const char *target, const char *linkpath);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆè½¯é“¾æ¥ï¼‰ã€‚å®ƒå°† <code>linkpath</code> åˆ›å»ºä¸ºæŒ‡å‘ <code>target</code> çš„ç¬¦å·é“¾æ¥ã€‚<code>target</code> å¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶ä¸”å¯ä»¥è·¨è¶Šæ–‡ä»¶ç³»ç»Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>89</code></td><td><code>readlink</code></td><td><code>ssize_t readlink(const char *pathname, char *buf, size_t bufsiz);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè¯»å–ç”± <code>pathname</code> æŒ‡å®šçš„ç¬¦å·é“¾æ¥çš„å€¼ï¼ˆå³å®ƒæ‰€æŒ‡å‘çš„è·¯å¾„ï¼‰ã€‚å®ƒå°†è·¯å¾„åå¤åˆ¶åˆ° <code>buf</code> ä¸­ï¼Œæœ€å¤š <code>bufsiz</code> å­—èŠ‚ã€‚æˆåŠŸè¿”å›è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>90</code></td><td><code>chmod</code></td><td><code>int chmod(const char *pathname, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜ç”± <code>pathname</code> æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚<code>mode</code> å‚æ•°æŒ‡å®šæ–°çš„æƒé™ä½æ©ç ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>91</code></td><td><code>fchmod</code></td><td><code>int fchmod(int fd, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>chmod</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥æ”¹å˜å·²æ‰“å¼€æ–‡ä»¶çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>92</code></td><td><code>chown</code></td><td><code>int chown(const char *pathname, uid_t owner, gid_t group);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜ç”± <code>pathname</code> æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€æœ‰è€…å’Œç»„ã€‚<code>owner</code> å’Œ <code>group</code> åˆ†åˆ«æŒ‡å®šæ–°çš„ç”¨æˆ· ID å’Œç»„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>93</code></td><td><code>fchown</code></td><td><code>int fchown(int fd, uid_t owner, gid_t group);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>chown</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥æ”¹å˜å·²æ‰“å¼€æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œç»„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>94</code></td><td><code>lchown</code></td><td><code>int lchown(const char *pathname, uid_t owner, gid_t group);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>chown</code> ç±»ä¼¼ï¼Œä½†å¦‚æœ <code>pathname</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šæ”¹å˜ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰€æœ‰è€…å’Œç»„ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>95</code></td><td><code>umask</code></td><td><code>mode_t umask(mode_t mask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æ–‡ä»¶åˆ›å»ºæ©ç ï¼Œå¹¶è¿”å›æ—§çš„æ©ç ã€‚æ–‡ä»¶åˆ›å»ºæ©ç ç”¨äºé™åˆ¶æ–°æ–‡ä»¶å’Œç›®å½•çš„æƒé™ã€‚<code>mask</code> å‚æ•°ä¸­çš„ä½åœ¨åˆ›å»ºæ–‡ä»¶æ—¶ä¼šè¢«æ¸…é›¶ã€‚</td></tr><tr><td><code>96</code></td><td><code>gettimeofday</code></td><td><code>int gettimeofday(struct timeval *tv, struct timezone *tz);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å½“å‰æ—¶é—´å’Œæ—¶åŒºä¿¡æ¯ã€‚<code>tv</code> ç»“æ„ä½“ä¸­åŒ…å«ç§’æ•°å’Œå¾®ç§’æ•°ï¼Œ<code>tz</code> ç»“æ„ä½“ï¼ˆé€šå¸¸è¢«å¿½ç•¥ï¼‰åŒ…å«æ—¶åŒºä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>97</code></td><td><code>getrlimit</code></td><td><code>int getrlimit(int resource, struct rlimit *rlim);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„èµ„æºé™åˆ¶ã€‚<code>resource</code> æŒ‡å®šè¦æŸ¥è¯¢çš„èµ„æºç±»å‹ï¼Œä¾‹å¦‚ <code>RLIMIT_NOFILE</code>ï¼ˆæœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼‰ã€‚<code>rlim</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è½¯é™åˆ¶å’Œç¡¬é™åˆ¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>98</code></td><td><code>getrusage</code></td><td><code>int getrusage(int who, struct rusage *usage);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹æˆ–å…¶å­è¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µã€‚<code>who</code> å‚æ•°æŒ‡å®šè¦æŸ¥è¯¢çš„å¯¹è±¡ï¼Œä¾‹å¦‚ <code>RUSAGE_SELF</code>ï¼ˆå½“å‰è¿›ç¨‹ï¼‰æˆ– <code>RUSAGE_CHILDREN</code>ï¼ˆå·²ç»ˆæ­¢çš„å­è¿›ç¨‹ï¼‰ã€‚<code>usage</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨ä½¿ç”¨æƒ…å†µã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>99</code></td><td><code>sysinfo</code></td><td><code>int sysinfo(struct sysinfo *info);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å…³äºç³»ç»Ÿæ•´ä½“çš„ç»Ÿè®¡ä¿¡æ¯ã€‚å®ƒå°†å†…å­˜ã€äº¤æ¢ç©ºé—´ã€è¿›ç¨‹æ•°ç­‰ä¿¡æ¯å¡«å……åˆ° <code>sysinfo</code> ç»“æ„ä½“ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>100</code></td><td><code>times</code></td><td><code>clock_t times(struct tms *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹åŠå…¶å·²ç»ˆæ­¢å­è¿›ç¨‹çš„ç”¨æˆ·å’Œç³»ç»Ÿ CPU æ—¶é—´ã€‚è¿™äº›æ—¶é—´ä¿¡æ¯è¢«å¡«å……åˆ° <code>tms</code> ç»“æ„ä½“ä¸­ã€‚æˆåŠŸè¿”å›è‡ªæŸä¸ªä»»æ„æ—¶é—´ç‚¹ï¼ˆå¦‚ç³»ç»Ÿå¯åŠ¨ï¼‰ä»¥æ¥çš„æ—¶é’Ÿæ»´ç­”æ•°ï¼Œå¤±è´¥è¿”å› <code>(clock_t)-1</code>ã€‚</td></tr><tr><td><code>101</code></td><td><code>ptrace</code></td><td><code>long ptrace(enum ptrace_request request, pid_t pid, void *addr, void *data);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ºè¿›ç¨‹æä¾›äº†å¯¹å¦ä¸€ä¸ªè¿›ç¨‹ï¼ˆè·Ÿè¸ªå¯¹è±¡ï¼‰çš„æ§åˆ¶ã€‚å®ƒå…è®¸ä¸€ä¸ªè¿›ç¨‹æ£€æŸ¥å’Œä¿®æ”¹å¦ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜å’Œå¯„å­˜å™¨ï¼Œå¹¶æ§åˆ¶å…¶æ‰§è¡Œã€‚è¿™é€šå¸¸ç”¨äºå®ç°è°ƒè¯•å™¨å’Œè·Ÿè¸ªå·¥å…·ã€‚æˆåŠŸè¿”å›å–å†³äº <code>request</code> çš„å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>102</code></td><td><code>getuid</code></td><td><code>uid_t getuid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å®é™…ç”¨æˆ· IDã€‚è¿”å›å€¼ä¸ºå®é™…ç”¨æˆ· IDã€‚</td></tr><tr><td><code>103</code></td><td><code>syslog</code></td><td><code>int syslog(int type, char *bufp, int len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¸å†…æ ¸æ—¥å¿—ç¼“å†²åŒºè¿›è¡Œäº¤äº’ã€‚å®ƒå¯ä»¥ç”¨äºè¯»å–ã€æ¸…ç©ºæˆ–æ§åˆ¶å†…æ ¸æ—¥å¿—ã€‚è¿”å›å€¼ä¸ºè¯»å–çš„å­—èŠ‚æ•°ï¼Œæˆ–å–å†³äº <code>type</code> çš„å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>104</code></td><td><code>getgid</code></td><td><code>gid_t getgid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å®é™…ç»„ IDã€‚è¿”å›å€¼ä¸ºå®é™…ç»„ IDã€‚</td></tr><tr><td><code>105</code></td><td><code>setuid</code></td><td><code>int setuid(uid_t uid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…ç”¨æˆ· IDã€æœ‰æ•ˆç”¨æˆ· ID å’Œä¿å­˜çš„ç”¨æˆ· IDã€‚å¦‚æœè¿›ç¨‹å…·æœ‰é€‚å½“çš„æƒé™ï¼Œå®ƒå¯ä»¥ç”¨äºæ›´æ”¹å…¶èº«ä»½ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>106</code></td><td><code>setgid</code></td><td><code>int setgid(gid_t gid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…ç»„ IDã€æœ‰æ•ˆç»„ ID å’Œä¿å­˜çš„ç»„ IDã€‚å¦‚æœè¿›ç¨‹å…·æœ‰é€‚å½“çš„æƒé™ï¼Œå®ƒå¯ä»¥ç”¨äºæ›´æ”¹å…¶ç»„èº«ä»½ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>107</code></td><td><code>geteuid</code></td><td><code>uid_t geteuid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„æœ‰æ•ˆç”¨æˆ· IDã€‚æœ‰æ•ˆç”¨æˆ· ID ç”¨äºç¡®å®šæ–‡ä»¶è®¿é—®æƒé™ã€‚è¿”å›å€¼ä¸ºæœ‰æ•ˆç”¨æˆ· IDã€‚</td></tr><tr><td><code>108</code></td><td><code>getegid</code></td><td><code>gid_t getegid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„æœ‰æ•ˆç»„ IDã€‚æœ‰æ•ˆç»„ ID ç”¨äºç¡®å®šæ–‡ä»¶è®¿é—®æƒé™ã€‚è¿”å›å€¼ä¸ºæœ‰æ•ˆç»„ IDã€‚</td></tr><tr><td><code>109</code></td><td><code>setpgid</code></td><td><code>int setpgid(pid_t pid, pid_t pgid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æŒ‡å®šè¿›ç¨‹çš„è¿›ç¨‹ç»„ IDã€‚<code>pid</code> æŒ‡å®šç›®æ ‡è¿›ç¨‹ï¼Œ<code>pgid</code> æŒ‡å®šæ–°çš„è¿›ç¨‹ç»„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>110</code></td><td><code>getppid</code></td><td><code>pid_t getppid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ IDã€‚è¿”å›å€¼ä¸ºçˆ¶è¿›ç¨‹ IDã€‚</td></tr><tr><td><code>111</code></td><td><code>getpgrp</code></td><td><code>pid_t getpgrp(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„è¿›ç¨‹ç»„ IDã€‚è¿”å›å€¼ä¸ºè¿›ç¨‹ç»„ IDã€‚</td></tr><tr><td><code>112</code></td><td><code>setsid</code></td><td><code>pid_t setsid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ã€‚è°ƒç”¨è¿›ç¨‹æˆä¸ºæ–°ä¼šè¯çš„ä¼šè¯é¢†å¯¼è€…ï¼Œå¹¶æˆä¸ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ç»„çš„é¢†å¯¼è€…ã€‚æ­¤è°ƒç”¨é€šå¸¸ç”¨äºåˆ›å»ºå®ˆæŠ¤è¿›ç¨‹ã€‚æˆåŠŸè¿”å›æ–°çš„ä¼šè¯ IDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>113</code></td><td><code>setreuid</code></td><td><code>int setreuid(uid_t ruid, uid_t euid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…å’Œæœ‰æ•ˆç”¨æˆ· IDã€‚<code>ruid</code> è®¾ç½®å®é™…ç”¨æˆ· IDï¼Œ<code>euid</code> è®¾ç½®æœ‰æ•ˆç”¨æˆ· IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>114</code></td><td><code>setregid</code></td><td><code>int setregid(gid_t rgid, gid_t egid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…å’Œæœ‰æ•ˆç»„ IDã€‚<code>rgid</code> è®¾ç½®å®é™…ç»„ IDï¼Œ<code>egid</code> è®¾ç½®æœ‰æ•ˆç»„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>115</code></td><td><code>getgroups</code></td><td><code>int getgroups(int gidsetsize, gid_t grouplist[]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„é™„åŠ ç»„ ID åˆ—è¡¨ã€‚å®ƒå°†è¿™äº› ID å­˜å‚¨åœ¨ <code>grouplist</code> æ•°ç»„ä¸­ï¼Œæœ€å¤š <code>gidsetsize</code> ä¸ªã€‚è¿”å›å€¼ä¸ºå®é™…è·å–çš„ç»„ ID æ•°é‡ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>116</code></td><td><code>setgroups</code></td><td><code>int setgroups(size_t gidsetsize, const gid_t *grouplist);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„é™„åŠ ç»„ ID åˆ—è¡¨ã€‚å®ƒå°†åˆ—è¡¨è®¾ç½®ä¸ºç”± <code>grouplist</code> æŒ‡å‘çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…å« <code>gidsetsize</code> ä¸ª IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>117</code></td><td><code>setresuid</code></td><td><code>int setresuid(uid_t ruid, uid_t euid, uid_t suid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…ã€æœ‰æ•ˆå’Œä¿å­˜çš„ç”¨æˆ· IDã€‚<code>ruid</code>ã€<code>euid</code> å’Œ <code>suid</code> åˆ†åˆ«æŒ‡å®šæ–°çš„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>118</code></td><td><code>getresuid</code></td><td><code>int getresuid(uid_t *ruid, uid_t *euid, uid_t *suid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å®é™…ã€æœ‰æ•ˆå’Œä¿å­˜çš„ç”¨æˆ· IDï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ç›¸åº”çš„æŒ‡é’ˆæŒ‡å‘çš„å˜é‡ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>119</code></td><td><code>setresgid</code></td><td><code>int setresgid(gid_t rgid, gid_t egid, gid_t sgid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„å®é™…ã€æœ‰æ•ˆå’Œä¿å­˜çš„ç»„ IDã€‚<code>rgid</code>ã€<code>egid</code> å’Œ <code>sgid</code> åˆ†åˆ«æŒ‡å®šæ–°çš„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>120</code></td><td><code>getresgid</code></td><td><code>int getresgid(gid_t *rgid, gid_t *egid, gid_t *sgid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å®é™…ã€æœ‰æ•ˆå’Œä¿å­˜çš„ç»„ IDï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ç›¸åº”çš„æŒ‡é’ˆæŒ‡å‘çš„å˜é‡ä¸­ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>121</code></td><td><code>getpgid</code></td><td><code>pid_t getpgid(pid_t pid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹ <code>pid</code> çš„è¿›ç¨‹ç»„ IDã€‚å¦‚æœ <code>pid</code> ä¸º <code>0</code>ï¼Œåˆ™è·å–è°ƒç”¨è¿›ç¨‹çš„è¿›ç¨‹ç»„ IDã€‚è¿”å›å€¼ä¸ºè¿›ç¨‹ç»„ IDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>122</code></td><td><code>setfsuid</code></td><td><code>int setfsuid(uid_t fsuid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„æ–‡ä»¶ç³»ç»Ÿç”¨æˆ· IDã€‚æ–‡ä»¶ç³»ç»Ÿç”¨æˆ· ID ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶æ£€æŸ¥æƒé™ã€‚å®ƒé€šå¸¸ä¸æœ‰æ•ˆç”¨æˆ· ID ç›¸åŒã€‚æˆåŠŸè¿”å›æ—§çš„æ–‡ä»¶ç³»ç»Ÿç”¨æˆ· IDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>123</code></td><td><code>setfsgid</code></td><td><code>int setfsgid(gid_t fsgid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„æ–‡ä»¶ç³»ç»Ÿç»„ IDã€‚æ–‡ä»¶ç³»ç»Ÿç»„ ID ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ—¶æ£€æŸ¥æƒé™ã€‚å®ƒé€šå¸¸ä¸æœ‰æ•ˆç»„ ID ç›¸åŒã€‚æˆåŠŸè¿”å›æ—§çš„æ–‡ä»¶ç³»ç»Ÿç»„ IDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>124</code></td><td><code>getsid</code></td><td><code>pid_t getsid(pid_t pid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹ <code>pid</code> çš„ä¼šè¯ IDã€‚å¦‚æœ <code>pid</code> ä¸º <code>0</code>ï¼Œåˆ™è·å–è°ƒç”¨è¿›ç¨‹çš„ä¼šè¯ IDã€‚è¿”å›å€¼ä¸ºä¼šè¯ IDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>125</code></td><td><code>capget</code></td><td><code>int capget(cap_user_header_t header, cap_user_data_t data);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨çº¿ç¨‹æˆ–æŒ‡å®šçº¿ç¨‹çš„èƒ½åŠ›ã€‚<code>header</code> ç»“æ„ä½“æä¾›ç‰ˆæœ¬ä¿¡æ¯ï¼Œ<code>data</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è·å–çš„èƒ½åŠ›ä½æ©ç ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>126</code></td><td><code>capset</code></td><td><code>int capset(cap_user_header_t header, const cap_user_data_t data);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨çº¿ç¨‹æˆ–æŒ‡å®šçº¿ç¨‹çš„èƒ½åŠ›ã€‚<code>header</code> ç»“æ„ä½“æä¾›ç‰ˆæœ¬ä¿¡æ¯ï¼Œ<code>data</code> ç»“æ„ä½“ç”¨äºæŒ‡å®šè¦è®¾ç½®çš„èƒ½åŠ›ä½æ©ç ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>127</code></td><td><code>rt_sigpending</code></td><td><code>int rt_sigpending(sigset_t *set, size_t sigsetsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å½“å‰æŒ‚èµ·çš„ã€è¢«é˜»å¡çš„ä¿¡å·é›†åˆã€‚<code>set</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è¿™äº›ä¿¡å·ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>128</code></td><td><code>rt_sigtimedwait</code></td><td><code>int rt_sigtimedwait(const sigset_t *set, siginfo_t *info, const struct timespec *timeout, size_t sigsetsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç­‰å¾… <code>set</code> é›†åˆä¸­çš„ä»»ä½•ä¿¡å·ä¼ é€’ã€‚å¦‚æœä¸€ä¸ªä¿¡å·è¢«æ¥æ”¶ï¼Œè¯¥è°ƒç”¨ä¼šè¿”å›ï¼Œä¿¡å·ä¿¡æ¯å­˜å‚¨åœ¨ <code>info</code> ä¸­ã€‚<code>timeout</code> å‚æ•°æŒ‡å®šç­‰å¾…çš„è¶…æ—¶æ—¶é—´ã€‚æˆåŠŸè¿”å›ä¿¡å·ç¼–å·ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>129</code></td><td><code>rt_sigqueueinfo</code></td><td><code>int rt_sigqueueinfo(pid_t pid, int sig, siginfo_t *uinfo);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æŒ‡å®šçš„è¿›ç¨‹ <code>pid</code> å‘é€ä¸€ä¸ªä¿¡å· <code>sig</code>ï¼Œå¹¶ä¼ é€’ä¸€ä¸ª <code>siginfo_t</code> ç»“æ„ä½“ã€‚è¿™å…è®¸åœ¨ä¿¡å·ä¸­æºå¸¦é¢å¤–çš„ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>130</code></td><td><code>rt_sigsuspend</code></td><td><code>int rt_sigsuspend(const sigset_t *set, size_t sigsetsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¸´æ—¶æ›¿æ¢è¿›ç¨‹çš„ä¿¡å·æ©ç ï¼Œå¹¶ä½¿è¿›ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç›´åˆ°æ¥æ”¶åˆ°ä¸€ä¸ªæœªè¢«é˜»å¡çš„ä¿¡å·ã€‚æˆåŠŸæ—¶ï¼Œæ­¤è°ƒç”¨æ°¸è¿œä¸ä¼šè¿”å›ã€‚å¦‚æœè¢«ä¿¡å·ä¸­æ–­ï¼Œå®ƒè¿”å› <code>-1</code> å¹¶è®¾ç½® <code>errno</code> ä¸º <code>EINTR</code>ã€‚</td></tr><tr><td><code>131</code></td><td><code>sigaltstack</code></td><td><code>int sigaltstack(const stack_t *ss, stack_t *old_ss);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–è·å–ä¿¡å·å¤„ç†ç¨‹åºçš„å¤‡ç”¨æ ˆã€‚è¿™å¯ä»¥ç”¨äºå¤„ç† <code>SIGSEGV</code> æˆ– <code>SIGBUS</code> ç­‰ä¿¡å·ï¼Œä»¥é¿å…åœ¨ä¸»æ ˆä¸Šå¤„ç†ä¿¡å·æ—¶å‡ºç°æ ˆæº¢å‡ºã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>132</code></td><td><code>utime</code></td><td><code>int utime(const char *filename, const struct utimbuf *times);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜æŒ‡å®šæ–‡ä»¶ <code>filename</code> çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ã€‚<code>times</code> ç»“æ„ä½“åŒ…å«äº†æ–°çš„è®¿é—®æ—¶é—´å’Œä¿®æ”¹æ—¶é—´ã€‚å¦‚æœ <code>times</code> ä¸º <code>NULL</code>ï¼Œåˆ™æ—¶é—´å°†è¢«è®¾ç½®ä¸ºå½“å‰æ—¶é—´ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>133</code></td><td><code>mknod</code></td><td><code>int mknod(const char *pathname, mode_t mode, dev_t dev);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ã€‚<code>pathname</code> æŒ‡å®šè·¯å¾„ï¼Œ<code>mode</code> æŒ‡å®šæ–‡ä»¶ç±»å‹å’Œæƒé™ï¼Œ<code>dev</code> ç”¨äºè®¾å¤‡æ–‡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>134</code></td><td><code>uselib</code></td><td><code>int uselib(const char *library);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåŠ è½½å…±äº«åº“ã€‚å®ƒå·²ç»è¢«å¼ƒç”¨ï¼Œä¸å†æ¨èä½¿ç”¨ã€‚</td></tr><tr><td><code>135</code></td><td><code>personality</code></td><td><code>int personality(unsigned long persona);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æˆ–è®¾ç½®è°ƒç”¨è¿›ç¨‹çš„æ‰§è¡ŒåŸŸï¼ˆpersonalityï¼‰ã€‚æ‰§è¡ŒåŸŸä¼šå½±å“æŸäº›ç³»ç»Ÿè°ƒç”¨çš„è¡Œä¸ºï¼Œä¾‹å¦‚ <code>fork</code> å’Œ <code>execve</code>ã€‚æˆåŠŸè¿”å›æ—§çš„ <code>persona</code> å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>136</code></td><td><code>ustat</code></td><td><code>int ustat(dev_t dev, struct ustat *ubuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ä¸€ä¸ªæŒ‚è½½æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚<code>dev</code> æŒ‡å®šè®¾å¤‡å·ï¼Œ<code>ubuf</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨å¯ç”¨å—æ•°å’Œå¯ç”¨èŠ‚ç‚¹æ•°ç­‰ä¿¡æ¯ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ <code>statfs</code> æˆ– <code>fstatfs</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>137</code></td><td><code>statfs</code></td><td><code>int statfs(const char *path, struct statfs *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–åŒ…å« <code>path</code> çš„æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚<code>buf</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€æ€»å—æ•°ã€ç©ºé—²å—æ•°ç­‰ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>138</code></td><td><code>fstatfs</code></td><td><code>int fstatfs(int fd, struct statfs *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>statfs</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥è·å–æ–‡ä»¶ç³»ç»Ÿçš„ç»Ÿè®¡ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>139</code></td><td><code>sysfs</code></td><td><code>int sysfs(int option, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æˆ–è®¾ç½®å†…æ ¸çš„ <code>sysfs</code> æ–‡ä»¶ç³»ç»Ÿç›¸å…³ä¿¡æ¯ã€‚å®ƒä¸»è¦ç”¨äºè·å–æ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹æˆ–æŒ‚è½½ç‚¹ä¿¡æ¯ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>140</code></td><td><code>getpriority</code></td><td><code>int getpriority(int which, id_t who);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è¿›ç¨‹ã€è¿›ç¨‹ç»„æˆ–ç”¨æˆ·ä¼˜å…ˆçº§ã€‚<code>which</code> æŒ‡å®šè¦æŸ¥è¯¢çš„å¯¹è±¡ç±»å‹ï¼Œ<code>who</code> æŒ‡å®šå…¶ IDã€‚è¿”å›å€¼ä¸ºä¼˜å…ˆçº§å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>141</code></td><td><code>setpriority</code></td><td><code>int setpriority(int which, id_t who, int prio);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è¿›ç¨‹ã€è¿›ç¨‹ç»„æˆ–ç”¨æˆ·ä¼˜å…ˆçº§ã€‚<code>prio</code> å‚æ•°æŒ‡å®šæ–°çš„ä¼˜å…ˆçº§å€¼ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>142</code></td><td><code>sched_setparam</code></td><td><code>int sched_setparam(pid_t pid, const struct sched_param *param);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦å‚æ•°ã€‚<code>pid</code> æŒ‡å®šç›®æ ‡è¿›ç¨‹ï¼Œ<code>param</code> ç»“æ„ä½“åŒ…å«äº†è°ƒåº¦å‚æ•°ï¼ˆå¦‚ä¼˜å…ˆçº§ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>143</code></td><td><code>sched_getparam</code></td><td><code>int sched_getparam(pid_t pid, struct sched_param *param);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦å‚æ•°ã€‚<code>param</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è·å–çš„å‚æ•°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>144</code></td><td><code>sched_setscheduler</code></td><td><code>int sched_setscheduler(pid_t pid, int policy, const struct sched_param *param);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥å’Œå‚æ•°ã€‚<code>policy</code> æŒ‡å®šè°ƒåº¦ç­–ç•¥ï¼Œå¦‚ <code>SCHED_FIFO</code> æˆ– <code>SCHED_RR</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>145</code></td><td><code>sched_getscheduler</code></td><td><code>int sched_getscheduler(pid_t pid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥ã€‚è¿”å›å€¼ä¸ºè°ƒåº¦ç­–ç•¥ï¼ˆå¦‚ <code>SCHED_FIFO</code> æˆ– <code>SCHED_RR</code>ï¼‰ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>146</code></td><td><code>sched_get_priority_max</code></td><td><code>int sched_get_priority_max(int policy);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè°ƒåº¦ç­–ç•¥çš„æœ€é«˜ä¼˜å…ˆçº§å€¼ã€‚è¿”å›å€¼ä¸ºæœ€é«˜ä¼˜å…ˆçº§å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>147</code></td><td><code>sched_get_priority_min</code></td><td><code>int sched_get_priority_min(int policy);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè°ƒåº¦ç­–ç•¥çš„æœ€ä½ä¼˜å…ˆçº§å€¼ã€‚è¿”å›å€¼ä¸ºæœ€ä½ä¼˜å…ˆçº§å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>148</code></td><td><code>sched_rr_get_interval</code></td><td><code>int sched_rr_get_interval(pid_t pid, struct timespec *tp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„ <code>SCHED_RR</code> è°ƒåº¦ç­–ç•¥çš„æ—¶é—´ç‰‡ï¼ˆtime sliceï¼‰é—´éš”ã€‚<code>tp</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è¯¥é—´éš”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>149</code></td><td><code>mlock</code></td><td><code>int mlock(const void *addr, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æŒ‡å®šå†…å­˜åŒºåŸŸé”å®šåœ¨ç‰©ç†å†…å­˜ä¸­ã€‚è¿™å¯ä»¥é˜²æ­¢è¯¥åŒºåŸŸè¢«æ¢å‡ºåˆ°äº¤æ¢ç©ºé—´ï¼Œå¯¹äºéœ€è¦å®æ—¶æ€§èƒ½çš„åº”ç”¨éå¸¸æœ‰ç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>150</code></td><td><code>munlock</code></td><td><code>int munlock(const void *addr, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè§£é™¤å¯¹æŒ‡å®šå†…å­˜åŒºåŸŸçš„é”å®šï¼Œå…è®¸å…¶è¢«æ¢å‡ºåˆ°äº¤æ¢ç©ºé—´ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>151</code></td><td><code>mlockall</code></td><td><code>int mlockall(int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé”å®šè°ƒç”¨è¿›ç¨‹çš„æ‰€æœ‰å½“å‰å’Œæœªæ¥çš„å†…å­˜ã€‚<code>flags</code> å‚æ•°æ§åˆ¶é”å®šèŒƒå›´ï¼Œä¾‹å¦‚ <code>MCL_CURRENT</code>ï¼ˆå½“å‰å†…å­˜ï¼‰å’Œ <code>MCL_FUTURE</code>ï¼ˆæœªæ¥å†…å­˜ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>152</code></td><td><code>munlockall</code></td><td><code>int munlockall(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè§£é™¤å¯¹è°ƒç”¨è¿›ç¨‹æ‰€æœ‰å†…å­˜çš„é”å®šã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>153</code></td><td><code>vhangup</code></td><td><code>int vhangup(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ¨¡æ‹Ÿè™šæ‹Ÿç»ˆç«¯çš„æŒ‚æ–­æ“ä½œï¼Œä»è€Œå…³é—­æ‰€æœ‰ä¸å½“å‰è™šæ‹Ÿç»ˆç«¯ç›¸å…³çš„ç»ˆç«¯è®¾å¤‡ã€‚è¿™ä¸»è¦ç”± <code>init</code> è¿›ç¨‹ç”¨äºç³»ç»Ÿé‡å¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>154</code></td><td><code>modify_ldt</code></td><td><code>int modify_ldt(int func, void *ptr, unsigned long bytecount);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¿®æ”¹æœ¬åœ°æè¿°ç¬¦è¡¨ï¼ˆLDTï¼‰ã€‚<code>func</code> æŒ‡å®šæ“ä½œç±»å‹ï¼ˆå¦‚è¯»æˆ–å†™ï¼‰ï¼Œ<code>ptr</code> æŒ‡å‘æ•°æ®ï¼Œ<code>bytecount</code> æŒ‡å®šå­—èŠ‚æ•°ã€‚æ­¤è°ƒç”¨é€šå¸¸ç”± C åº“ä½¿ç”¨ï¼Œä¸åº”ç”±æ™®é€šåº”ç”¨ç¨‹åºç›´æ¥è°ƒç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>155</code></td><td><code>pivot_root</code></td><td><code>int pivot_root(const char *new_root, const char *put_old);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜è¿›ç¨‹çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚å®ƒå°†å½“å‰æ ¹æ–‡ä»¶ç³»ç»Ÿç§»åŠ¨åˆ° <code>put_old</code>ï¼Œå¹¶å°† <code>new_root</code> è®¾ç½®ä¸ºæ–°çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>156</code></td><td><code>_sysctl</code></td><td><code>int _sysctl(struct __sysctl_args *args);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨è¿è¡Œæ—¶é…ç½®å†…æ ¸å‚æ•°ã€‚å®ƒé€šè¿‡ <code>__sysctl_args</code> ç»“æ„ä½“æ¥æŒ‡å®šè¦æ“ä½œçš„å‚æ•°ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ <code>/proc/sys</code> æ–‡ä»¶ç³»ç»Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>157</code></td><td><code>prctl</code></td><td><code>int prctl(int option, unsigned long arg2, unsigned long arg3, unsigned long arg4, unsigned long arg5);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹è°ƒç”¨è¿›ç¨‹æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚<code>option</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œä¾‹å¦‚è®¾ç½®è¿›ç¨‹çš„åç§°ï¼ˆ<code>PR_SET_NAME</code>ï¼‰æˆ–æ§åˆ¶å…¶èƒ½åŠ›ã€‚è¿”å›å€¼ä¸º <code>option</code> ç›¸å…³çš„ç»“æœï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>158</code></td><td><code>arch_prctl</code></td><td><code>int arch_prctl(int code, unsigned long addr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹è¿›ç¨‹æ‰§è¡Œç‰¹å®šäºæ¶æ„çš„æ“ä½œã€‚<code>code</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œä¾‹å¦‚è®¾ç½® <code>fs</code> æˆ– <code>gs</code> æ®µå¯„å­˜å™¨çš„åŸºå€ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>159</code></td><td><code>adjtimex</code></td><td><code>int adjtimex(struct timex *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè°ƒæ•´ç³»ç»Ÿæ—¶é’Ÿã€‚<code>timex</code> ç»“æ„ä½“åŒ…å«äº†ç”¨äºè°ƒæ•´æ—¶é’Ÿé¢‘ç‡å’Œç›¸ä½çš„å‚æ•°ã€‚è¿™é€šå¸¸ç”¨äºå®ç° NTPï¼ˆç½‘ç»œæ—¶é—´åè®®ï¼‰å®ˆæŠ¤è¿›ç¨‹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>160</code></td><td><code>setrlimit</code></td><td><code>int setrlimit(int resource, const struct rlimit *rlim);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„èµ„æºé™åˆ¶ã€‚<code>resource</code> æŒ‡å®šè¦ä¿®æ”¹çš„èµ„æºç±»å‹ï¼Œ<code>rlim</code> ç»“æ„ä½“åŒ…å«æ–°çš„è½¯é™åˆ¶å’Œç¡¬é™åˆ¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>161</code></td><td><code>chroot</code></td><td><code>int chroot(const char *path);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜è°ƒç”¨è¿›ç¨‹çš„æ ¹ç›®å½•ã€‚è¿™æœ‰æ•ˆåœ°å°†è¿›ç¨‹åŠå…¶å­è¿›ç¨‹é™åˆ¶åœ¨ç”± <code>path</code> æŒ‡å®šçš„ç›®å½•å­æ ‘ä¸­ã€‚éœ€è¦è¶…çº§ç”¨æˆ·æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>162</code></td><td><code>sync</code></td><td><code>void sync(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿç¼“å­˜æ•°æ®å†™å…¥åº•å±‚ç£ç›˜ã€‚å®ƒå¯åŠ¨åŒæ­¥æ“ä½œï¼Œä½†ä¸ä¼šç­‰å¾… I&#x2F;O å®Œæˆã€‚</td></tr><tr><td><code>163</code></td><td><code>acct</code></td><td><code>int acct(const char *filename);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯ç”¨æˆ–ç¦ç”¨è¿›ç¨‹ä¼šè®¡ã€‚å½“å¯ç”¨æ—¶ï¼Œå†…æ ¸ä¼šä¸ºæ¯ä¸ªç»ˆæ­¢çš„è¿›ç¨‹å†™å…¥ä¸€ä¸ªè®°å½•ã€‚<code>filename</code> æŒ‡å®šä¼šè®¡æ–‡ä»¶çš„è·¯å¾„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>164</code></td><td><code>settimeofday</code></td><td><code>int settimeofday(const struct timeval *tv, const struct timezone *tz);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ç³»ç»Ÿæ—¶é—´å’Œæ—¶åŒºã€‚<code>tv</code> ç»“æ„ä½“åŒ…å«äº†æ–°çš„æ—¶é—´ï¼Œ<code>tz</code> ç»“æ„ä½“åŒ…å«äº†æ–°çš„æ—¶åŒºä¿¡æ¯ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>165</code></td><td><code>mount</code></td><td><code>int mount(const char *source, const char *target, const char *filesystemtype, unsigned long mountflags, const void *data);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°æŒ‡å®šä½ç½®ã€‚<code>source</code> æŒ‡å®šè®¾å¤‡æˆ–æ–‡ä»¶ï¼Œ<code>target</code> æŒ‡å®šæŒ‚è½½ç‚¹ï¼Œ<code>filesystemtype</code> æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>166</code></td><td><code>umount2</code></td><td><code>int umount2(const char *target, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¸è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚<code>target</code> æŒ‡å®šæŒ‚è½½ç‚¹ã€‚<code>flags</code> å‚æ•°æä¾›äº†é¢å¤–çš„å¸è½½é€‰é¡¹ï¼Œå¦‚å»¶è¿Ÿå¸è½½ï¼ˆ<code>MNT_DETACH</code>ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>167</code></td><td><code>swapon</code></td><td><code>int swapon(const char *path, int swapflags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯ç”¨ä¸€ä¸ªäº¤æ¢è®¾å¤‡æˆ–æ–‡ä»¶ã€‚<code>path</code> æŒ‡å®šäº¤æ¢è®¾å¤‡çš„è·¯å¾„ï¼Œ<code>swapflags</code> æä¾›é€‰é¡¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>168</code></td><td><code>swapoff</code></td><td><code>int swapoff(const char *path);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç¦ç”¨ä¸€ä¸ªäº¤æ¢è®¾å¤‡æˆ–æ–‡ä»¶ã€‚<code>path</code> æŒ‡å®šäº¤æ¢è®¾å¤‡çš„è·¯å¾„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>169</code></td><td><code>reboot</code></td><td><code>int reboot(int magic, int magic2, int cmd, void *arg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé‡å¯ã€å…³é—­æˆ–æŒ‚èµ·ç³»ç»Ÿã€‚<code>magic</code> å’Œ <code>magic2</code> æ˜¯ç‰¹å®šçš„é­”æœ¯æ•°å­—ï¼Œ<code>cmd</code> æŒ‡å®šè¦æ‰§è¡Œçš„æ“ä½œï¼ˆå¦‚ <code>LINUX_REBOOT_CMD_RESTART</code>ï¼‰ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸåæ°¸ä¸è¿”å›ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>170</code></td><td><code>sethostname</code></td><td><code>int sethostname(const char *name, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ç³»ç»Ÿçš„ä¸»æœºåã€‚<code>name</code> æŒ‡å‘æ–°çš„ä¸»æœºåï¼Œ<code>len</code> æ˜¯å…¶é•¿åº¦ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>171</code></td><td><code>setdomainname</code></td><td><code>int setdomainname(const char *name, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ç³»ç»Ÿçš„åŸŸåã€‚<code>name</code> æŒ‡å‘æ–°çš„åŸŸåï¼Œ<code>len</code> æ˜¯å…¶é•¿åº¦ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>172</code></td><td><code>iopl</code></td><td><code>int iopl(int level);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜è°ƒç”¨è¿›ç¨‹çš„ I&#x2F;O ç‰¹æƒçº§åˆ«ã€‚<code>level</code> æŒ‡å®šæ–°çš„ç‰¹æƒçº§åˆ«ã€‚æ­¤è°ƒç”¨ä»…åœ¨ x86 æ¶æ„ä¸Šå¯ç”¨ï¼Œä¸”éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>173</code></td><td><code>ioperm</code></td><td><code>int ioperm(unsigned long from, unsigned long num, int turn_on);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–ç§»é™¤å¯¹ I&#x2F;O ç«¯å£çš„è®¿é—®æƒé™ã€‚<code>from</code> å’Œ <code>num</code> æŒ‡å®š I&#x2F;O ç«¯å£çš„èŒƒå›´ï¼Œ<code>turn_on</code> æ§åˆ¶æ˜¯å¯ç”¨è¿˜æ˜¯ç¦ç”¨æƒé™ã€‚æ­¤è°ƒç”¨ä»…åœ¨ x86 æ¶æ„ä¸Šå¯ç”¨ï¼Œä¸”éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>174</code></td><td><code>create_module</code></td><td><code>int create_module(const char *name, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨å†…æ ¸ä¸­åˆ›å»ºä¸€ä¸ªç©ºçš„æ¨¡å—ç©ºé—´ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ <code>init_module</code>ã€‚</td></tr><tr><td><code>175</code></td><td><code>init_module</code></td><td><code>int init_module(const void *module_image, unsigned long len, const char *param_values);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªå†…æ ¸æ¨¡å—åŠ è½½åˆ°å†…æ ¸ã€‚<code>module_image</code> æŒ‡å‘æ¨¡å—çš„äºŒè¿›åˆ¶æ˜ åƒï¼Œ<code>len</code> æ˜¯å…¶å¤§å°ï¼Œ<code>param_values</code> æ˜¯æ¨¡å—å‚æ•°ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>176</code></td><td><code>delete_module</code></td><td><code>int delete_module(const char *name, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å†…æ ¸ä¸­ç§»é™¤ä¸€ä¸ªå·²åŠ è½½çš„æ¨¡å—ã€‚<code>name</code> æŒ‡å®šæ¨¡å—åç§°ï¼Œ<code>flags</code> æä¾›å¸è½½é€‰é¡¹ã€‚éœ€è¦é€‚å½“çš„æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>177</code></td><td><code>get_kernel_syms</code></td><td><code>int get_kernel_syms(struct kernel_sym *table);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å†…æ ¸ç¬¦å·è¡¨ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ <code>/proc/kallsyms</code>ã€‚</td></tr><tr><td><code>178</code></td><td><code>query_module</code></td><td><code>int query_module(const char *name, int what, void *buf, size_t bufsize, size_t *ret);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæŸ¥è¯¢å†…æ ¸æ¨¡å—çš„ä¿¡æ¯ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ã€‚</td></tr><tr><td><code>179</code></td><td><code>quotactl</code></td><td><code>int quotactl(int cmd, const char *special, qid_t id, void *addr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç®¡ç†æ–‡ä»¶ç³»ç»Ÿé…é¢ã€‚<code>cmd</code> æŒ‡å®šæ“ä½œï¼Œ<code>special</code> æ˜¯è®¾å¤‡åç§°ï¼Œ<code>id</code> æ˜¯ç”¨æˆ·æˆ–ç»„ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>180</code></td><td><code>nfsservctl</code></td><td><code>long nfsservctl(int cmd, struct nfsctl_arg *argp, union nfsctl_res *resp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ§åˆ¶ NFS æœåŠ¡å™¨ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ã€‚</td></tr><tr><td><code>181</code></td><td><code>getpmsg</code></td><td><code>int getpmsg(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸æµï¼ˆstreamï¼‰ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>182</code></td><td><code>putpmsg</code></td><td><code>int putpmsg(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸æµï¼ˆstreamï¼‰ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>183</code></td><td><code>afs_syscall</code></td><td><code>int afs_syscall(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ AFSï¼ˆAndrew File Systemï¼‰ä¸“ç”¨çš„ï¼Œç”¨äºæ‰§è¡Œç‰¹å®šäº AFS çš„æ“ä½œã€‚</td></tr><tr><td><code>184</code></td><td><code>tuxcall</code></td><td><code>int tuxcall(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ TUX ç½‘ç»œæœåŠ¡å™¨ä¸“ç”¨çš„ã€‚</td></tr><tr><td><code>185</code></td><td><code>security</code></td><td><code>int security(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¸ Linux å®‰å…¨æ¨¡å—ï¼ˆLSMï¼‰è¿›è¡Œäº¤äº’ã€‚å®ƒå·²è¿‡æ—¶ï¼Œç›¸å…³åŠŸèƒ½å·²é›†æˆåˆ°å…¶ä»–ç³»ç»Ÿè°ƒç”¨ä¸­ã€‚</td></tr><tr><td><code>186</code></td><td><code>gettid</code></td><td><code>pid_t gettid(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨çº¿ç¨‹çš„çº¿ç¨‹ IDï¼ˆTIDï¼‰ã€‚çº¿ç¨‹ ID åœ¨ç³»ç»ŸèŒƒå›´å†…æ˜¯å”¯ä¸€çš„ï¼Œä½†ä¸è¿›ç¨‹ IDï¼ˆPIDï¼‰ä¸åŒã€‚è¿”å›å€¼ä¸ºçº¿ç¨‹ IDã€‚</td></tr><tr><td><code>187</code></td><td><code>readahead</code></td><td><code>ssize_t readahead(int fd, off64_t offset, size_t count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé¢„è¯»æ–‡ä»¶æ•°æ®åˆ°é¡µé¢ç¼“å­˜ä¸­ã€‚å®ƒä»æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> çš„ <code>offset</code> å¤„å¼€å§‹ï¼Œé¢„è¯» <code>count</code> å­—èŠ‚æ•°æ®ã€‚è¿™å¯ä»¥å¸®åŠ©å‡å°‘åç»­ <code>read</code> è°ƒç”¨çš„å»¶è¿Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>188</code></td><td><code>setxattr</code></td><td><code>int setxattr(const char *path, const char *name, const void *value, size_t size, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„æ‰©å±•å±æ€§ã€‚<code>path</code> æŒ‡å®šæ–‡ä»¶ï¼Œ<code>name</code> æŒ‡å®šå±æ€§åï¼Œ<code>value</code> å’Œ <code>size</code> æŒ‡å®šå±æ€§å€¼ã€‚<code>flags</code> æä¾›é€‰é¡¹ï¼Œå¦‚ <code>XATTR_CREATE</code>ï¼ˆåªåœ¨å±æ€§ä¸å­˜åœ¨æ—¶åˆ›å»ºï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>189</code></td><td><code>lsetxattr</code></td><td><code>int lsetxattr(const char *path, const char *name, const void *value, size_t size, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>setxattr</code> ç±»ä¼¼ï¼Œä½†å¦‚æœ <code>path</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šæ”¹å˜ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰©å±•å±æ€§ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ–‡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>190</code></td><td><code>fsetxattr</code></td><td><code>int fsetxattr(int fd, const char *name, const void *value, size_t size, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>setxattr</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥è®¾ç½®å·²æ‰“å¼€æ–‡ä»¶çš„æ‰©å±•å±æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>191</code></td><td><code>getxattr</code></td><td><code>ssize_t getxattr(const char *path, const char *name, void *value, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æ–‡ä»¶æˆ–ç›®å½•çš„æ‰©å±•å±æ€§å€¼ã€‚<code>path</code> æŒ‡å®šæ–‡ä»¶ï¼Œ<code>name</code> æŒ‡å®šå±æ€§åã€‚å±æ€§å€¼è¢«å¤åˆ¶åˆ° <code>value</code> ç¼“å†²åŒºä¸­ï¼Œæœ€å¤š <code>size</code> å­—èŠ‚ã€‚è¿”å›å€¼ä¸ºå±æ€§å€¼çš„å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>192</code></td><td><code>lgetxattr</code></td><td><code>ssize_t lgetxattr(const char *path, const char *name, void *value, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>getxattr</code> ç±»ä¼¼ï¼Œä½†å¦‚æœ <code>path</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šè·å–ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰©å±•å±æ€§ã€‚è¿”å›å€¼ä¸ºå±æ€§å€¼çš„å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>193</code></td><td><code>fgetxattr</code></td><td><code>ssize_t fgetxattr(int fd, const char *name, void *value, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>getxattr</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥è·å–å·²æ‰“å¼€æ–‡ä»¶çš„æ‰©å±•å±æ€§å€¼ã€‚è¿”å›å€¼ä¸ºå±æ€§å€¼çš„å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>194</code></td><td><code>listxattr</code></td><td><code>ssize_t listxattr(const char *path, char *list, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æ–‡ä»¶æˆ–ç›®å½•æ‰€æœ‰æ‰©å±•å±æ€§çš„åç§°åˆ—è¡¨ã€‚å±æ€§åè¢«å¤åˆ¶åˆ° <code>list</code> ç¼“å†²åŒºä¸­ï¼Œä»¥ç©ºå­—ç¬¦åˆ†éš”ã€‚è¿”å›å€¼ä¸ºåˆ—è¡¨çš„æ€»å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>195</code></td><td><code>llistxattr</code></td><td><code>ssize_t llistxattr(const char *path, char *list, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>listxattr</code> ç±»ä¼¼ï¼Œä½†å¦‚æœ <code>path</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šè·å–ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰©å±•å±æ€§åç§°åˆ—è¡¨ã€‚è¿”å›å€¼ä¸ºåˆ—è¡¨çš„æ€»å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>196</code></td><td><code>flistxattr</code></td><td><code>ssize_t flistxattr(int fd, char *list, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>listxattr</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥è·å–å·²æ‰“å¼€æ–‡ä»¶çš„æ‰©å±•å±æ€§åç§°åˆ—è¡¨ã€‚è¿”å›å€¼ä¸ºåˆ—è¡¨çš„æ€»å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>197</code></td><td><code>removexattr</code></td><td><code>int removexattr(const char *path, const char *name);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç§»é™¤æ–‡ä»¶æˆ–ç›®å½•çš„æ‰©å±•å±æ€§ã€‚<code>path</code> æŒ‡å®šæ–‡ä»¶ï¼Œ<code>name</code> æŒ‡å®šè¦ç§»é™¤çš„å±æ€§åã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>198</code></td><td><code>lremovexattr</code></td><td><code>int lremovexattr(const char *path, const char *name);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>removexattr</code> ç±»ä¼¼ï¼Œä½†å¦‚æœ <code>path</code> æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå®ƒä¼šç§»é™¤ç¬¦å·é“¾æ¥æœ¬èº«çš„æ‰©å±•å±æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>199</code></td><td><code>fremovexattr</code></td><td><code>int fremovexattr(int fd, const char *name);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ä¸ <code>removexattr</code> ç±»ä¼¼ï¼Œä½†å®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ <code>fd</code> æ¥ç§»é™¤å·²æ‰“å¼€æ–‡ä»¶çš„æ‰©å±•å±æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>200</code></td><td><code>tkill</code></td><td><code>int tkill(int tid, int sig);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æŒ‡å®šçš„çº¿ç¨‹ <code>tid</code> å‘é€ä¿¡å·ã€‚å®ƒæ¯” <code>kill</code> æ›´ç²¾ç¡®ï¼Œå› ä¸ºå®ƒç›´æ¥é’ˆå¯¹å•ä¸ªçº¿ç¨‹ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ <code>tgkill</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>201</code></td><td><code>time</code></td><td><code>time_t time(time_t *tloc);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è‡ª Epochï¼ˆ1970-01-01 00:00:00 +0000 (UTC)ï¼‰ä»¥æ¥çš„ç§’æ•°ã€‚å¦‚æœ <code>tloc</code> éç©ºï¼Œåˆ™è¯¥å€¼ä¹Ÿä¼šå­˜å‚¨åœ¨ <code>tloc</code> ä¸­ã€‚è¿”å›å€¼ä¸ºç§’æ•°ï¼Œå¤±è´¥è¿”å› <code>(time_t)-1</code>ã€‚</td></tr><tr><td><code>202</code></td><td><code>futex</code></td><td><code>int futex(int *uaddr, int futex_op, int val, const struct timespec *timeout, int *uaddr2, int val3);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå®ç°ç”¨æˆ·ç©ºé—´çš„å¿«é€Ÿäº’æ–¥é”ï¼ˆfast user-space mutexesï¼‰ã€‚å®ƒåœ¨ç”¨æˆ·ç©ºé—´æä¾›åŸå­æ“ä½œï¼Œå¹¶ä¸”åªåœ¨å¿…è¦æ—¶æ‰è°ƒç”¨å†…æ ¸ã€‚<code>futex_op</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œå¦‚ç­‰å¾…ï¼ˆ<code>FUTEX_WAIT</code>ï¼‰æˆ–å”¤é†’ï¼ˆ<code>FUTEX_WAKE</code>ï¼‰ã€‚æˆåŠŸè¿”å›å–å†³äºæ“ä½œç±»å‹ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>203</code></td><td><code>sched_setaffinity</code></td><td><code>int sched_setaffinity(pid_t pid, size_t cpusize, cpu_set_t *mask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æŒ‡å®šè¿›ç¨‹çš„ CPU äº²å’ŒåŠ›æ©ç ã€‚<code>mask</code> æŒ‡å®šè¿›ç¨‹å¯ä»¥åœ¨å“ªäº› CPU ä¸Šè¿è¡Œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>204</code></td><td><code>sched_getaffinity</code></td><td><code>int sched_getaffinity(pid_t pid, size_t cpusize, cpu_set_t *mask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„ CPU äº²å’ŒåŠ›æ©ç ã€‚<code>mask</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨è¯¥æ©ç ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>205</code></td><td><code>set_thread_area</code></td><td><code>int set_thread_area(struct user_desc *u_info);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®çº¿ç¨‹çš„æœ¬åœ°å­˜å‚¨ï¼ˆTLSï¼‰åŒºåŸŸã€‚å®ƒç”¨äºå®ç°çº¿ç¨‹å±€éƒ¨å˜é‡ã€‚æ­¤è°ƒç”¨ä»…åœ¨ x86 æ¶æ„ä¸Šå¯ç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>206</code></td><td><code>io_setup</code></td><td><code>int io_setup(unsigned nr_events, aio_context_t *ctxp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®å¼‚æ­¥ I&#x2F;O ä¸Šä¸‹æ–‡ã€‚<code>nr_events</code> æŒ‡å®šé˜Ÿåˆ—ä¸­çš„æœ€å¤§äº‹ä»¶æ•°ï¼Œ<code>ctxp</code> ç”¨äºå­˜å‚¨ä¸Šä¸‹æ–‡å¥æŸ„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>207</code></td><td><code>io_destroy</code></td><td><code>int io_destroy(aio_context_t ctx);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé”€æ¯æŒ‡å®šçš„å¼‚æ­¥ I&#x2F;O ä¸Šä¸‹æ–‡ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>208</code></td><td><code>io_getevents</code></td><td><code>int io_getevents(aio_context_t ctx_id, long min_nr, long nr, struct io_event *events, struct timespec *timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å¼‚æ­¥ I&#x2F;O ä¸Šä¸‹æ–‡ä¸­æ£€ç´¢å·²å®Œæˆçš„äº‹ä»¶ã€‚<code>events</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨äº‹ä»¶ä¿¡æ¯ã€‚è¿”å›å€¼ä¸ºè·å–çš„äº‹ä»¶æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>209</code></td><td><code>io_submit</code></td><td><code>int io_submit(aio_context_t ctx_id, long nr, struct iocb **iocbpp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘å¼‚æ­¥ I&#x2F;O ä¸Šä¸‹æ–‡æäº¤ I&#x2F;O è¯·æ±‚ã€‚<code>iocbpp</code> æ˜¯æŒ‡å‘ <code>iocb</code> ç»“æ„ä½“æŒ‡é’ˆæ•°ç»„çš„æŒ‡é’ˆï¼Œæ¯ä¸ªç»“æ„ä½“æè¿°ä¸€ä¸ª I&#x2F;O æ“ä½œã€‚è¿”å›å€¼ä¸ºæäº¤çš„è¯·æ±‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>210</code></td><td><code>io_cancel</code></td><td><code>int io_cancel(aio_context_t ctx_id, struct iocb *iocb, struct io_event *result);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå–æ¶ˆä¸€ä¸ªå·²æäº¤çš„å¼‚æ­¥ I&#x2F;O è¯·æ±‚ã€‚<code>iocb</code> ç»“æ„ä½“æŒ‡å®šè¦å–æ¶ˆçš„è¯·æ±‚ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>211</code></td><td><code>get_thread_area</code></td><td><code>int get_thread_area(struct user_desc *u_info);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–çº¿ç¨‹çš„æœ¬åœ°å­˜å‚¨ï¼ˆTLSï¼‰åŒºåŸŸã€‚å®ƒç”¨äºè·å–ç”± <code>set_thread_area</code> è®¾ç½®çš„ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>212</code></td><td><code>lookup_dcookie</code></td><td><code>int lookup_dcookie(u64 cookie, char *buffer, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªç›®å½• â€œcookieâ€ è½¬æ¢ä¸ºå…¶è·¯å¾„åã€‚<code>cookie</code> æ˜¯ä¸€ä¸ªå†…æ ¸å†…éƒ¨æ ‡è¯†ç¬¦ã€‚æˆåŠŸè¿”å›è·¯å¾„åçš„é•¿åº¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>213</code></td><td><code>epoll_create</code></td><td><code>int epoll_create(int size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ª epoll å®ä¾‹ã€‚<code>size</code> å‚æ•°ç°åœ¨å·²è¢«å¿½ç•¥ï¼Œä½†å¿…é¡»å¤§äº <code>0</code>ã€‚è¿”å›ä¸€ä¸ª epoll å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>214</code></td><td><code>epoll_ctl_old</code></td><td><code>int epoll_ctl_old(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>epoll_ctl</code> çš„æ—§ç‰ˆæœ¬ï¼Œå·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>215</code></td><td><code>epoll_wait_old</code></td><td><code>int epoll_wait_old(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>epoll_wait</code> çš„æ—§ç‰ˆæœ¬ï¼Œå·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>216</code></td><td><code>remap_file_pages</code></td><td><code>int remap_file_pages(unsigned long start, unsigned long size, unsigned long prot, unsigned long pgoff, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æ–‡ä»¶æ˜ å°„åŒºåŸŸçš„é¡µé¢é‡æ–°æ˜ å°„åˆ°æ–°çš„è™šæ‹Ÿåœ°å€ã€‚æ­¤è°ƒç”¨å·²è¢«å¼ƒç”¨ã€‚</td></tr><tr><td><code>217</code></td><td><code>getdents64</code></td><td><code>int getdents64(int fd, struct linux_dirent64 *dirp, unsigned int count);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>getdents</code> çš„ 64 ä½ç‰ˆæœ¬ï¼Œç”¨äºè¯»å–ç›®å½•é¡¹ã€‚å®ƒç”¨äºå¤„ç†å…·æœ‰ 64 ä½ inode å·çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿”å›å€¼ä¸ºå®é™…è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>218</code></td><td><code>set_tid_address</code></td><td><code>long set_tid_address(int *tidptr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ä¸€ä¸ªåœ°å€ï¼Œå½“çº¿ç¨‹ç»ˆæ­¢æ—¶ï¼Œå†…æ ¸ä¼šå°†çº¿ç¨‹çš„ TID å†™å…¥è¯¥åœ°å€ï¼Œå¹¶å¯èƒ½å‘é€ä¸€ä¸ªä¿¡å·ã€‚è¿™å¯¹äºå®ç°çº¿ç¨‹åº“éå¸¸æœ‰ç”¨ã€‚è¿”å›å€¼ä¸ºçº¿ç¨‹ IDã€‚</td></tr><tr><td><code>219</code></td><td><code>restart_syscall</code></td><td><code>long restart_syscall(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ä»ä¿¡å·å¤„ç†å‡½æ•°è¿”å›åé‡æ–°å¯åŠ¨ä¸€ä¸ªè¢«ä¸­æ–­çš„ç³»ç»Ÿè°ƒç”¨ã€‚å®ƒé€šå¸¸ç”±å†…æ ¸åœ¨åå°è‡ªåŠ¨è°ƒç”¨ã€‚</td></tr><tr><td><code>220</code></td><td><code>semtimedop</code></td><td><code>int semtimedop(int semid, struct sembuf *sops, size_t nsops, const struct timespec *timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>semop</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸æŒ‡å®šä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å¦‚æœä¿¡å·é‡æ“ä½œæ— æ³•åœ¨è¶…æ—¶æ—¶é—´å†…å®Œæˆï¼Œåˆ™è°ƒç”¨ä¼šè¿”å›ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>221</code></td><td><code>fadvise64</code></td><td><code>int fadvise64(int fd, off64_t offset, off64_t len, int advice);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹æ–‡ä»¶æ•°æ®è¿›è¡Œé¢„è¯»å’Œç¼“å­˜ç­–ç•¥çš„å»ºè®®ã€‚å®ƒå‘Šè¯‰å†…æ ¸åº”ç”¨ç¨‹åºå°†å¦‚ä½•è®¿é—®æ–‡ä»¶ï¼Œä»¥ä¾¿å†…æ ¸å¯ä»¥ä¼˜åŒ–å…¶ I&#x2F;O è¡Œä¸ºã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>222</code></td><td><code>timer_create</code></td><td><code>int timer_create(clockid_t clockid, struct sigevent *sevp, timer_t *timerid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ POSIX è®¡æ—¶å™¨ã€‚<code>clockid</code> æŒ‡å®šæ—¶é’Ÿç±»å‹ï¼Œ<code>sevp</code> æŒ‡å®šè®¡æ—¶å™¨åˆ°æœŸæ—¶è¦å‘é€çš„é€šçŸ¥äº‹ä»¶ï¼Œ<code>timerid</code> ç”¨äºå­˜å‚¨æ–°çš„è®¡æ—¶å™¨ IDã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>223</code></td><td><code>timer_settime</code></td><td><code>int timer_settime(timer_t timerid, int flags, const struct itimerspec *new_value, struct itimerspec *old_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–ä¿®æ”¹æŒ‡å®šçš„ POSIX è®¡æ—¶å™¨ã€‚<code>timerid</code> æŒ‡å®šè®¡æ—¶å™¨ï¼Œ<code>new_value</code> è®¾ç½®æ–°çš„åˆ°æœŸæ—¶é—´å’Œé—´éš”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>224</code></td><td><code>timer_gettime</code></td><td><code>int timer_gettime(timer_t timerid, struct itimerspec *curr_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šçš„ POSIX è®¡æ—¶å™¨çš„å½“å‰å€¼ã€‚<code>curr_value</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨å‰©ä½™æ—¶é—´å’Œé—´éš”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>225</code></td><td><code>timer_getoverrun</code></td><td><code>int timer_getoverrun(timer_t timerid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šçš„ POSIX è®¡æ—¶å™¨çš„åˆ°æœŸæº¢å‡ºè®¡æ•°ã€‚å®ƒè¿”å›è®¡æ—¶å™¨åˆ°æœŸæ—¶ï¼Œç”±äºè¿›ç¨‹æœªåŠæ—¶å¤„ç†è€Œé”™è¿‡çš„ä¿¡å·æ•°ã€‚è¿”å›å€¼ä¸ºæº¢å‡ºè®¡æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>226</code></td><td><code>timer_delete</code></td><td><code>int timer_delete(timer_t timerid);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ é™¤æŒ‡å®šçš„ POSIX è®¡æ—¶å™¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>227</code></td><td><code>clock_settime</code></td><td><code>int clock_settime(clockid_t clockid, const struct timespec *tp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æŒ‡å®šæ—¶é’Ÿçš„æ—¶é—´ã€‚<code>clockid</code> æŒ‡å®šæ—¶é’Ÿç±»å‹ï¼Œ<code>tp</code> ç»“æ„ä½“åŒ…å«äº†æ–°çš„æ—¶é—´ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>228</code></td><td><code>clock_gettime</code></td><td><code>int clock_gettime(clockid_t clockid, struct timespec *tp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šæ—¶é’Ÿçš„å½“å‰æ—¶é—´ã€‚<code>tp</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨æ—¶é—´ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>229</code></td><td><code>clock_getres</code></td><td><code>int clock_getres(clockid_t clockid, struct timespec *res);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šæ—¶é’Ÿçš„åˆ†è¾¨ç‡ï¼ˆå³æœ€å°å¯æµ‹é‡çš„æ—¶é—´é—´éš”ï¼‰ã€‚<code>res</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨åˆ†è¾¨ç‡ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>230</code></td><td><code>clock_nanosleep</code></td><td><code>int clock_nanosleep(clockid_t clockid, int flags, const struct timespec *request, struct timespec *remain);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨é«˜ç²¾åº¦æ—¶é’Ÿä¸Šæš‚åœæ‰§è¡Œã€‚å®ƒæ¯” <code>nanosleep</code> æ›´çµæ´»ï¼Œå…è®¸æŒ‡å®šæ—¶é’Ÿç±»å‹å’Œç›¸å¯¹&#x2F;ç»å¯¹æ—¶é—´ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>231</code></td><td><code>exit_group</code></td><td><code>void exit_group(int status);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç»ˆæ­¢è°ƒç”¨è¿›ç¨‹æ‰€å±çš„æ•´ä¸ªçº¿ç¨‹ç»„ã€‚<code>status</code> å‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½œä¸ºè¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ç ã€‚ä¸ <code>exit</code> ä¸åŒï¼Œå®ƒä¼šç»ˆæ­¢æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œä¸ä»…ä»…æ˜¯è°ƒç”¨çº¿ç¨‹ã€‚æ­¤è°ƒç”¨æ°¸ä¸è¿”å›ã€‚</td></tr><tr><td><code>232</code></td><td><code>epoll_wait</code></td><td><code>int epoll_wait(int epfd, struct epoll_event *events, int maxevents, int timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç­‰å¾… epoll å®ä¾‹ä¸Šçš„äº‹ä»¶ã€‚å®ƒé˜»å¡ç›´åˆ° <code>epfd</code> ä¸Šçš„äº‹ä»¶å‘ç”Ÿæˆ–è¶…æ—¶ã€‚å°±ç»ªçš„äº‹ä»¶è¢«å­˜å‚¨åœ¨ <code>events</code> æ•°ç»„ä¸­ã€‚è¿”å›å€¼ä¸ºå°±ç»ªäº‹ä»¶çš„æ•°é‡ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>233</code></td><td><code>epoll_ctl</code></td><td><code>int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ§åˆ¶ epoll å®ä¾‹ã€‚<code>op</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œå¦‚æ·»åŠ ï¼ˆ<code>EPOLL_CTL_ADD</code>ï¼‰ã€ä¿®æ”¹ï¼ˆ<code>EPOLL_CTL_MOD</code>ï¼‰æˆ–åˆ é™¤ï¼ˆ<code>EPOLL_CTL_DEL</code>ï¼‰æ–‡ä»¶æè¿°ç¬¦ <code>fd</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>234</code></td><td><code>tgkill</code></td><td><code>int tgkill(int tgid, int tid, int sig);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æŒ‡å®šçš„çº¿ç¨‹ <code>tid</code> å‘é€ä¿¡å·ã€‚å®ƒé€šè¿‡æŒ‡å®šçº¿ç¨‹ç»„ IDï¼ˆ<code>tgid</code>ï¼‰æ¥ç¡®ä¿ç›®æ ‡çº¿ç¨‹å±äºæ­£ç¡®çš„è¿›ç¨‹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>235</code></td><td><code>utimes</code></td><td><code>int utimes(const char *filename, const struct timeval times[2]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ”¹å˜æŒ‡å®šæ–‡ä»¶ <code>filename</code> çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´ã€‚å®ƒæ¯” <code>utime</code> æä¾›äº†æ›´é«˜çš„ç²¾åº¦ï¼Œæ”¯æŒå¾®ç§’ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>236</code></td><td><code>vserver</code></td><td><code>int vserver(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè™šæ‹ŸåŒ–æœåŠ¡å™¨ã€‚è¯¥è°ƒç”¨å·²è¢«å¼ƒç”¨ï¼Œå› ä¸ºè™šæ‹ŸåŒ–æŠ€æœ¯å·²ç»é€šè¿‡å…¶ä»–æ–¹å¼å®ç°ã€‚</td></tr><tr><td><code>237</code></td><td><code>mbind</code></td><td><code>long mbind(unsigned long start, unsigned long len, unsigned long mode, unsigned long *nmask, unsigned long maxnode, unsigned flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜åŒºåŸŸç»‘å®šåˆ°ä¸€ç»„æŒ‡å®šçš„ NUMAï¼ˆéå‡åŒ€å†…å­˜è®¿é—®ï¼‰èŠ‚ç‚¹ã€‚è¿™æœ‰åŠ©äºåœ¨ NUMA æ¶æ„ä¸Šä¼˜åŒ–å†…å­˜è®¿é—®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>238</code></td><td><code>set_mempolicy</code></td><td><code>long set_mempolicy(int mode, const unsigned long *nmask, unsigned long maxnode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è°ƒç”¨è¿›ç¨‹çš„é»˜è®¤å†…å­˜åˆ†é…ç­–ç•¥ã€‚<code>mode</code> æŒ‡å®šç­–ç•¥ï¼Œ<code>nmask</code> æŒ‡å®šè¦ä½¿ç”¨çš„ NUMA èŠ‚ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>239</code></td><td><code>get_mempolicy</code></td><td><code>long get_mempolicy(int *mode, unsigned long *nmask, unsigned long maxnode, unsigned long addr, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨è¿›ç¨‹çš„å†…å­˜åˆ†é…ç­–ç•¥æˆ–æŒ‡å®šåœ°å€çš„ç­–ç•¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>240</code></td><td><code>mq_open</code></td><td><code>mqd_t mq_open(const char *name, int oflag, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ª POSIX æ¶ˆæ¯é˜Ÿåˆ—ã€‚<code>name</code> æŒ‡å®šé˜Ÿåˆ—åç§°ï¼Œ<code>oflag</code> æŒ‡å®šæ‰“å¼€æ ‡å¿—ã€‚æˆåŠŸè¿”å›æ¶ˆæ¯é˜Ÿåˆ—æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>241</code></td><td><code>mq_unlink</code></td><td><code>int mq_unlink(const char *name);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ é™¤æŒ‡å®šçš„ POSIX æ¶ˆæ¯é˜Ÿåˆ—ã€‚<code>name</code> æŒ‡å®šè¦åˆ é™¤çš„é˜Ÿåˆ—åç§°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>242</code></td><td><code>mq_timedsend</code></td><td><code>int mq_timedsend(mqd_t mqdes, const char *msg_ptr, size_t msg_len, unsigned int msg_prio, const struct timespec *abs_timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘æ¶ˆæ¯é˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªç»å¯¹è¶…æ—¶æ—¶é—´ã€‚å¦‚æœæ— æ³•åœ¨è¶…æ—¶æ—¶é—´å†…å‘é€æ¶ˆæ¯ï¼Œåˆ™è°ƒç”¨å¤±è´¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>243</code></td><td><code>mq_timedreceive</code></td><td><code>ssize_t mq_timedreceive(mqd_t mqdes, char *msg_ptr, size_t msg_len, unsigned int *msg_prio, const struct timespec *abs_timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»æ¶ˆæ¯é˜Ÿåˆ—æ¥æ”¶æ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šä¸€ä¸ªç»å¯¹è¶…æ—¶æ—¶é—´ã€‚å¦‚æœæ— æ³•åœ¨è¶…æ—¶æ—¶é—´å†…æ¥æ”¶æ¶ˆæ¯ï¼Œåˆ™è°ƒç”¨å¤±è´¥ã€‚æˆåŠŸè¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>244</code></td><td><code>mq_notify</code></td><td><code>int mq_notify(mqd_t mqdes, const struct sigevent *sevp);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ³¨å†Œæˆ–å–æ¶ˆæ¶ˆæ¯é˜Ÿåˆ—çš„é€šçŸ¥ã€‚<code>sevp</code> ç»“æ„ä½“æŒ‡å®šå½“æ¶ˆæ¯åˆ°è¾¾ä¸€ä¸ªç©ºé˜Ÿåˆ—æ—¶ï¼Œè¦å‘é€çš„é€šçŸ¥ç±»å‹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>245</code></td><td><code>mq_getsetattr</code></td><td><code>int mq_getsetattr(mqd_t mqdes, const struct mq_attr *newattr, struct mq_attr *oldattr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æˆ–è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„å±æ€§ã€‚<code>newattr</code> æŒ‡å®šæ–°çš„å±æ€§ï¼Œ<code>oldattr</code> ç”¨äºè·å–æ—§çš„å±æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>246</code></td><td><code>kexec_load</code></td><td><code>long kexec_load(unsigned long entry, unsigned long nr_segments, struct kexec_segment *segments, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåŠ è½½ä¸€ä¸ªæ–°çš„å†…æ ¸é•œåƒï¼Œä»¥ä¾¿åœ¨ä¸é‡å¯ç‰©ç†æœºå™¨çš„æƒ…å†µä¸‹å¯åŠ¨å®ƒã€‚<code>entry</code> æŒ‡å®šæ–°å†…æ ¸çš„å…¥å£ç‚¹ï¼Œ<code>segments</code> æè¿°å†…æ ¸å’Œåˆå§‹ RAM ç›˜çš„å†…å­˜å¸ƒå±€ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>247</code></td><td><code>waitid</code></td><td><code>int waitid(idtype_t idtype, id_t id, siginfo_t *infop, int options);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç­‰å¾…ä¸€ä¸ªå­è¿›ç¨‹çŠ¶æ€çš„æ”¹å˜ã€‚å®ƒæ¯” <code>waitpid</code> æ›´çµæ´»ï¼Œå…è®¸æŒ‡å®šè¦ç­‰å¾…çš„è¿›ç¨‹ç±»å‹å’Œ IDï¼Œå¹¶æä¾›æ›´è¯¦ç»†çš„ä¿¡å·ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>248</code></td><td><code>add_key</code></td><td><code>key_serial_t add_key(const char *type, const char *description, const void *payload, size_t plen, key_serial_t keyring);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘å†…æ ¸å¯†é’¥ç¯æ·»åŠ ä¸€ä¸ªæ–°çš„å¯†é’¥ã€‚<code>type</code> æŒ‡å®šå¯†é’¥ç±»å‹ï¼Œ<code>description</code> æä¾›äº†æè¿°ï¼Œ<code>payload</code> æ˜¯å¯†é’¥æ•°æ®ã€‚æˆåŠŸè¿”å›æ–°å¯†é’¥çš„åºåˆ—å·ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>249</code></td><td><code>request_key</code></td><td><code>key_serial_t request_key(const char *type, const char *description, const char *callout_info, key_serial_t keyring);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å†…æ ¸å¯†é’¥ç¯ä¸­æŸ¥æ‰¾ä¸€ä¸ªå¯†é’¥ã€‚å¦‚æœå¯†é’¥ä¸å­˜åœ¨ï¼Œå®ƒä¼šå°è¯•è°ƒç”¨ <code>keyctl</code> å®ç”¨ç¨‹åºæ¥è·å–ã€‚æˆåŠŸè¿”å›æ‰¾åˆ°çš„å¯†é’¥çš„åºåˆ—å·ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>250</code></td><td><code>keyctl</code></td><td><code>long keyctl(int operation, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹å†…æ ¸å¯†é’¥ç¯æ‰§è¡Œå„ç§æ“ä½œã€‚<code>operation</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œä¾‹å¦‚è·å–å¯†é’¥å±æ€§ï¼ˆ<code>KEYCTL_GET_KEYRING_ID</code>ï¼‰æˆ–é“¾æ¥å¯†é’¥ï¼ˆ<code>KEYCTL_LINK</code>ï¼‰ã€‚æˆåŠŸè¿”å›å–å†³äºæ“ä½œç±»å‹ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>251</code></td><td><code>ioprio_set</code></td><td><code>int ioprio_set(int which, int who, int ioprio);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è¿›ç¨‹ã€è¿›ç¨‹ç»„æˆ–ç”¨æˆ·çš„ I&#x2F;O è°ƒåº¦ä¼˜å…ˆçº§ã€‚<code>ioprio</code> æŒ‡å®šæ–°çš„ä¼˜å…ˆçº§å€¼ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>252</code></td><td><code>ioprio_get</code></td><td><code>int ioprio_get(int which, int who);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è¿›ç¨‹ã€è¿›ç¨‹ç»„æˆ–ç”¨æˆ·çš„ I&#x2F;O è°ƒåº¦ä¼˜å…ˆçº§ã€‚è¿”å›å€¼ä¸ºä¼˜å…ˆçº§å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>253</code></td><td><code>inotify_init</code></td><td><code>int inotify_init(void);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆå§‹åŒ–ä¸€ä¸ª <code>inotify</code> å®ä¾‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚<code>inotify</code> å®ä¾‹ç”¨äºç›‘è§†æ–‡ä»¶ç³»ç»Ÿçš„äº‹ä»¶ã€‚è¿”å›å€¼ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>254</code></td><td><code>inotify_add_watch</code></td><td><code>int inotify_add_watch(int fd, const char *pathname, uint32_t mask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘ <code>inotify</code> å®ä¾‹æ·»åŠ ä¸€ä¸ªç›‘è§†ã€‚<code>fd</code> æ˜¯ <code>inotify</code> å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>pathname</code> æŒ‡å®šè¦ç›‘è§†çš„æ–‡ä»¶ï¼Œ<code>mask</code> æŒ‡å®šè¦ç›‘è§†çš„äº‹ä»¶ç±»å‹ã€‚æˆåŠŸè¿”å›ç›‘è§†æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>255</code></td><td><code>inotify_rm_watch</code></td><td><code>int inotify_rm_watch(int fd, int wd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä» <code>inotify</code> å®ä¾‹ä¸­ç§»é™¤ä¸€ä¸ªç›‘è§†ã€‚<code>fd</code> æ˜¯ <code>inotify</code> å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>wd</code> æ˜¯è¦ç§»é™¤çš„ç›‘è§†æè¿°ç¬¦ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>256</code></td><td><code>migrate_pages</code></td><td><code>long migrate_pages(int pid, unsigned long maxnode, const unsigned long *old_nodes, const unsigned long *new_nodes);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æŒ‡å®šè¿›ç¨‹çš„å†…å­˜é¡µé¢ä»ä¸€ç»„ NUMA èŠ‚ç‚¹è¿ç§»åˆ°å¦ä¸€ç»„ã€‚<code>old_nodes</code> å’Œ <code>new_nodes</code> åˆ†åˆ«æŒ‡å®šæºå’Œç›®æ ‡èŠ‚ç‚¹ã€‚æˆåŠŸè¿”å›è¿ç§»çš„é¡µé¢æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>257</code></td><td><code>openat</code></td><td><code>int openat(int dirfd, const char *pathname, int flags, ...);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>open</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨æ–‡ä»¶è·¯å¾„ä¸­å­˜åœ¨ç¬¦å·é“¾æ¥æ”»å‡»ã€‚æˆåŠŸè¿”å›æ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>258</code></td><td><code>mkdirat</code></td><td><code>int mkdirat(int dirfd, const char *pathname, mode_t mode);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>mkdir</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>259</code></td><td><code>mknodat</code></td><td><code>int mknodat(int dirfd, const char *pathname, mode_t mode, dev_t dev);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>mknod</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>260</code></td><td><code>fchownat</code></td><td><code>int fchownat(int dirfd, const char *pathname, uid_t owner, gid_t group, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>chown</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ï¼Œå¹¶æ”¯æŒé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>AT_EMPTY_PATH</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>261</code></td><td><code>futimesat</code></td><td><code>int futimesat(int dirfd, const char *pathname, const struct timeval times[2]);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>utimes</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>262</code></td><td><code>newfstatat</code></td><td><code>int newfstatat(int dirfd, const char *pathname, struct stat *statbuf, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>fstatat</code> çš„ä¸€ä¸ªç‰ˆæœ¬ã€‚å®ƒè·å–æŒ‡å®šæ–‡ä»¶çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶æ”¯æŒé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>AT_SYMLINK_NOFOLLOW</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>263</code></td><td><code>unlinkat</code></td><td><code>int unlinkat(int dirfd, const char *pathname, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>unlink</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚<code>flags</code> å‚æ•°å¯ç”¨äºæŒ‡å®šæ˜¯åˆ é™¤æ–‡ä»¶è¿˜æ˜¯ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>264</code></td><td><code>renameat</code></td><td><code>int renameat(int olddirfd, const char *oldpath, int newdirfd, const char *newpath);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>rename</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨ä¸¤ä¸ªä¸åŒçš„ç›®å½•ä¸­è¿›è¡Œé‡å‘½åæ“ä½œã€‚<code>olddirfd</code> å’Œ <code>newdirfd</code> åˆ†åˆ«æŒ‡å®šæºå’Œç›®æ ‡ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>265</code></td><td><code>linkat</code></td><td><code>int linkat(int olddirfd, const char *oldpath, int newdirfd, const char *newpath, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>link</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨ä¸¤ä¸ªä¸åŒçš„ç›®å½•ä¸­åˆ›å»ºç¡¬é“¾æ¥ã€‚<code>flags</code> å‚æ•°å¯ç”¨äºæ§åˆ¶ç¬¦å·é“¾æ¥çš„è¡Œä¸ºã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>266</code></td><td><code>symlinkat</code></td><td><code>int symlinkat(const char *target, int newdirfd, const char *linkpath);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>symlink</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨æŒ‡å®šçš„ç›®å½•ä¸­åˆ›å»ºç¬¦å·é“¾æ¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>267</code></td><td><code>readlinkat</code></td><td><code>ssize_t readlinkat(int dirfd, const char *pathname, char *buf, size_t bufsiz);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>readlink</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚è¿”å›å€¼ä¸ºè¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>268</code></td><td><code>fchmodat</code></td><td><code>int fchmodat(int dirfd, const char *pathname, mode_t mode, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>chmod</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>269</code></td><td><code>faccessat</code></td><td><code>int faccessat(int dirfd, const char *pathname, int mode, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>access</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>270</code></td><td><code>pselect6</code></td><td><code>int pselect6(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, const struct timespec *timeout, const sigset_t *sigmask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>select</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åŸå­æ€§åœ°æ”¹å˜ä¿¡å·æ©ç å’Œç­‰å¾…æ–‡ä»¶æè¿°ç¬¦äº‹ä»¶ã€‚<code>timeout</code> å‚æ•°ä»¥çº³ç§’ä¸ºå•ä½ã€‚è¿”å›å€¼ä¸ºå°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦æ€»æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>271</code></td><td><code>ppoll</code></td><td><code>int ppoll(struct pollfd *fds, nfds_t nfds, const struct timespec *tmo_p, const sigset_t *sigmask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>poll</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åŸå­æ€§åœ°æ”¹å˜ä¿¡å·æ©ç å’Œç­‰å¾…æ–‡ä»¶æè¿°ç¬¦äº‹ä»¶ã€‚<code>tmo_p</code> å‚æ•°ä»¥çº³ç§’ä¸ºå•ä½ã€‚è¿”å›å€¼ä¸ºå°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦æ€»æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>272</code></td><td><code>unshare</code></td><td><code>int unshare(int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†è°ƒç”¨è¿›ç¨‹ä»å…¶çˆ¶è¿›ç¨‹çš„å…±äº«èµ„æºä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»è€Œåˆ›å»ºæ–°çš„å‘½åç©ºé—´ã€‚<code>flags</code> å‚æ•°æŒ‡å®šè¦åˆ†ç¦»çš„èµ„æºç±»å‹ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€PID æˆ–ç½‘ç»œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>273</code></td><td><code>set_robust_list</code></td><td><code>int set_robust_list(struct robust_list_head *head, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¸ºè°ƒç”¨è¿›ç¨‹è®¾ç½®ä¸€ä¸ªå¥å£®çš„äº’æ–¥é”åˆ—è¡¨ã€‚è¯¥åˆ—è¡¨ç”¨äºåœ¨è¿›ç¨‹å´©æºƒæ—¶è‡ªåŠ¨é‡Šæ”¾äº’æ–¥é”ï¼Œä»è€Œé˜²æ­¢æ­»é”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>274</code></td><td><code>get_robust_list</code></td><td><code>int get_robust_list(int pid, struct robust_list_head **head_ptr, size_t *len_ptr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æŒ‡å®šè¿›ç¨‹çš„å¥å£®äº’æ–¥é”åˆ—è¡¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>275</code></td><td><code>splice</code></td><td><code>ssize_t splice(int fd_in, loff_t *off_in, int fd_out, loff_t *off_out, size_t len, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ç§»åŠ¨æ•°æ®ï¼Œæ— éœ€é€šè¿‡ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºã€‚å®ƒé€šè¿‡å†…æ ¸ç¼“å†²åŒºè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œæä¾›äº†éå¸¸é«˜æ•ˆçš„é›¶æ‹·è´ I&#x2F;Oã€‚æˆåŠŸè¿”å›ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>276</code></td><td><code>tee</code></td><td><code>ssize_t tee(int fd_in, int fd_out, size_t len, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´å¤åˆ¶æ•°æ®ï¼Œæ— éœ€é€šè¿‡ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºã€‚å®ƒä» <code>fd_in</code> å¤åˆ¶ <code>len</code> å­—èŠ‚æ•°æ®åˆ° <code>fd_out</code>ï¼ŒåŒæ—¶ä¿æŒ <code>fd_in</code> ä¸Šçš„æ•°æ®ä¸å˜ã€‚æˆåŠŸè¿”å›å¤åˆ¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>277</code></td><td><code>sync_file_range</code></td><td><code>int sync_file_range(int fd, off64_t offset, off64_t nbytes, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æ–‡ä»¶çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼ˆåœ¨æŒ‡å®šèŒƒå›´å†…ï¼‰åŒæ­¥åˆ°ç£ç›˜ã€‚å®ƒæä¾›äº†æ¯” <code>fsync</code> æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œå¯ä»¥åªåŒæ­¥æ–‡ä»¶çš„éƒ¨åˆ†åŒºåŸŸã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>278</code></td><td><code>vmsplice</code></td><td><code>ssize_t vmsplice(int fd, const struct iovec *iov, unsigned long nr_segs, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºä¸­çš„æ•°æ®ç§»åŠ¨åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œå¹¶å°†å…¶é“¾æ¥åˆ°æ–‡ä»¶æè¿°ç¬¦ã€‚å®ƒå…è®¸é«˜æ•ˆåœ°å°†å¤šä¸ªä¸è¿ç»­çš„å†…å­˜åŒºåŸŸä¼ è¾“åˆ°æ–‡ä»¶æˆ–å¥—æ¥å­—ã€‚æˆåŠŸè¿”å›ä¼ è¾“çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>279</code></td><td><code>move_pages</code></td><td><code>long move_pages(int pid, unsigned long nr_pages, const void **pages, const int *nodes, int *status, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æŒ‡å®šè¿›ç¨‹çš„å†…å­˜é¡µé¢ç§»åŠ¨åˆ°æŒ‡å®šçš„ NUMA èŠ‚ç‚¹ã€‚è¿™å¯ä»¥ç”¨äºä¼˜åŒ– NUMA æ¶æ„ä¸Šçš„å†…å­˜è®¿é—®ã€‚æˆåŠŸè¿”å›ç§»åŠ¨çš„é¡µé¢æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>280</code></td><td><code>utimensat</code></td><td><code>int utimensat(int dirfd, const char *pathname, const struct timespec times[2], int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>utimes</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ï¼Œå¹¶ä¸”æ”¯æŒçº³ç§’ç²¾åº¦ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>281</code></td><td><code>epoll_pwait</code></td><td><code>int epoll_pwait(int epfd, struct epoll_event *events, int maxevents, int timeout, const sigset_t *sigmask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>epoll_wait</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åŸå­æ€§åœ°æ”¹å˜ä¿¡å·æ©ç å¹¶ç­‰å¾…äº‹ä»¶ã€‚è¿™å¯¹äºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å®‰å…¨åœ°å¤„ç†ä¿¡å·éå¸¸æœ‰ç”¨ã€‚è¿”å›å€¼ä¸ºå°±ç»ªäº‹ä»¶çš„æ•°é‡ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>282</code></td><td><code>signalfd</code></td><td><code>int signalfd(int fd, const sigset_t *mask, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œç”¨äºæ¥æ”¶ä¿¡å·ã€‚å½“æŒ‡å®šä¿¡å·å‘é€åˆ°è¿›ç¨‹æ—¶ï¼Œä¿¡å·ä¿¡æ¯å°†ä»¥ <code>signalfd_siginfo</code> ç»“æ„ä½“çš„å½¢å¼å†™å…¥æ­¤æ–‡ä»¶æè¿°ç¬¦ã€‚è¿”å›å€¼ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>283</code></td><td><code>timerfd_create</code></td><td><code>int timerfd_create(int clockid, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¯¥æè¿°ç¬¦å¯ç”¨äºæ¥æ”¶è®¡æ—¶å™¨åˆ°æœŸäº‹ä»¶ã€‚<code>clockid</code> æŒ‡å®šæ—¶é’Ÿç±»å‹ï¼Œ<code>flags</code> æä¾›é€‰é¡¹ã€‚è¿”å›å€¼ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>284</code></td><td><code>eventfd</code></td><td><code>int eventfd(unsigned int initval, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä½œä¸ºäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚å®ƒå¯ä»¥ç”¨äºçº¿ç¨‹æˆ–è¿›ç¨‹é—´çš„åŒæ­¥ã€‚è¿”å›å€¼ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>285</code></td><td><code>fallocate</code></td><td><code>int fallocate(int fd, int mode, off_t offset, off_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé¢„å…ˆåˆ†é…ä¸€ä¸ªæ–‡ä»¶çš„ç£ç›˜ç©ºé—´ã€‚å®ƒç¡®ä¿æ–‡ä»¶æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œè€Œæ— éœ€å®é™…å†™å…¥æ•°æ®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>286</code></td><td><code>timerfd_settime</code></td><td><code>int timerfd_settime(int fd, int flags, const struct itimerspec *new_value, struct itimerspec *old_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–ä¿®æ”¹ <code>timerfd</code> æ–‡ä»¶æè¿°ç¬¦çš„è®¡æ—¶å™¨ã€‚<code>new_value</code> æŒ‡å®šæ–°çš„åˆ°æœŸæ—¶é—´å’Œé—´éš”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>287</code></td><td><code>timerfd_gettime</code></td><td><code>int timerfd_gettime(int fd, struct itimerspec *curr_value);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å– <code>timerfd</code> æ–‡ä»¶æè¿°ç¬¦çš„è®¡æ—¶å™¨å½“å‰å€¼ã€‚<code>curr_value</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨å‰©ä½™æ—¶é—´å’Œé—´éš”ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>288</code></td><td><code>accept4</code></td><td><code>int accept4(int sockfd, struct sockaddr *addr, socklen_t *addrlen, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>accept</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨æ¥å—è¿æ¥æ—¶æŒ‡å®šé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>SOCK_NONBLOCK</code> æˆ– <code>SOCK_CLOEXEC</code>ã€‚æˆåŠŸè¿”å›æ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>289</code></td><td><code>signalfd4</code></td><td><code>int signalfd4(int fd, const sigset_t *mask, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>signalfd</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªé¢å¤–çš„æ ‡å¿—å‚æ•°ï¼Œä¾‹å¦‚ <code>SFD_CLOEXEC</code>ã€‚</td></tr><tr><td><code>290</code></td><td><code>eventfd2</code></td><td><code>int eventfd2(unsigned int initval, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>eventfd</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªé¢å¤–çš„æ ‡å¿—å‚æ•°ï¼Œä¾‹å¦‚ <code>EFD_CLOEXEC</code>ã€‚</td></tr><tr><td><code>291</code></td><td><code>epoll_create1</code></td><td><code>int epoll_create1(int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>epoll_create</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸æŒ‡å®šé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>EPOLL_CLOEXEC</code>ã€‚è¿”å›ä¸€ä¸ª epoll å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>292</code></td><td><code>dup3</code></td><td><code>int dup3(int oldfd, int newfd, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>dup2</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸æŒ‡å®šé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>O_CLOEXEC</code>ã€‚æˆåŠŸè¿”å› <code>newfd</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>293</code></td><td><code>pipe2</code></td><td><code>int pipe2(int pipefd[2], int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>pipe</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸æŒ‡å®šé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>O_CLOEXEC</code> æˆ– <code>O_NONBLOCK</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>294</code></td><td><code>inotify_init1</code></td><td><code>int inotify_init1(int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>inotify_init</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸æŒ‡å®šé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>IN_CLOEXEC</code> æˆ– <code>IN_NONBLOCK</code>ã€‚è¿”å›ä¸€ä¸ª <code>inotify</code> å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>295</code></td><td><code>preadv</code></td><td><code>ssize_t preadv(int fd, const struct iovec *iov, int iovcnt, off_t offset);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>readv</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨æŒ‡å®šåç§»é‡ <code>offset</code> å¤„è¯»å–æ•°æ®ï¼Œè€Œæ— éœ€æ”¹å˜æ–‡ä»¶æè¿°ç¬¦çš„å½“å‰ä½ç½®ã€‚è¿”å›å€¼ä¸ºè¯»å–çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>296</code></td><td><code>pwritev</code></td><td><code>ssize_t pwritev(int fd, const struct iovec *iov, int iovcnt, off_t offset);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>writev</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨æŒ‡å®šåç§»é‡ <code>offset</code> å¤„å†™å…¥æ•°æ®ï¼Œè€Œæ— éœ€æ”¹å˜æ–‡ä»¶æè¿°ç¬¦çš„å½“å‰ä½ç½®ã€‚è¿”å›å€¼ä¸ºå†™å…¥çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>297</code></td><td><code>rt_tgsigqueueinfo</code></td><td><code>int rt_tgsigqueueinfo(int tgid, int tid, int sig, siginfo_t *uinfo);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>rt_sigqueueinfo</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—çº¿ç¨‹ç»„ ID <code>tgid</code>ï¼Œä»è€Œç¡®ä¿ä¿¡å·å‘é€åˆ°æ­£ç¡®çš„çº¿ç¨‹ç»„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>298</code></td><td><code>perf_event_open</code></td><td><code>int perf_event_open(struct perf_event_attr *attr, pid_t pid, int cpu, int group_fd, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºå’Œæ‰“å¼€ä¸€ä¸ªæ€§èƒ½ç›‘æ§äº‹ä»¶ã€‚å®ƒç”¨äºåˆ†æ CPU æ€§èƒ½è®¡æ•°å™¨ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>299</code></td><td><code>recvmmsg</code></td><td><code>int recvmmsg(int sockfd, struct mmsghdr *msgvec, unsigned int vlen, unsigned int flags, struct timespec *timeout);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å¥—æ¥å­—æ¥æ”¶å¤šæ¡æ¶ˆæ¯ã€‚å®ƒæ¯”å¾ªç¯è°ƒç”¨ <code>recvmsg</code> æ›´é«˜æ•ˆï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ¥æ”¶å¤šæ¡æ¶ˆæ¯ã€‚è¿”å›å€¼ä¸ºæ¥æ”¶çš„æ¶ˆæ¯æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>300</code></td><td><code>fanotify_init</code></td><td><code>int fanotify_init(unsigned int flags, unsigned int event_f_flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆå§‹åŒ–ä¸€ä¸ª <code>fanotify</code> å®ä¾‹ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚<code>fanotify</code> å®ä¾‹ç”¨äºç›‘è§†æ–‡ä»¶ç³»ç»Ÿçš„äº‹ä»¶å’Œè®¿é—®æƒé™ã€‚è¿”å›å€¼ä¸ºæ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>301</code></td><td><code>fanotify_mark</code></td><td><code>int fanotify_mark(int fanotify_fd, unsigned int flags, uint64_t mask, int dfd, const char *pathname);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘ <code>fanotify</code> å®ä¾‹æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤ä¸€ä¸ªç›‘è§†ã€‚å®ƒæŒ‡å®šè¦ç›‘è§†çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>302</code></td><td><code>prlimit64</code></td><td><code>int prlimit64(pid_t pid, int resource, const struct rlimit64 *new_limit, struct rlimit64 *old_limit);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æˆ–è®¾ç½®è¿›ç¨‹çš„èµ„æºé™åˆ¶ã€‚å®ƒæ˜¯ <code>setrlimit</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ”¯æŒ 64 ä½é™åˆ¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>303</code></td><td><code>name_to_handle_at</code></td><td><code>int name_to_handle_at(int dirfd, const char *pathname, struct file_handle *handle, int *mount_id, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶å¥æŸ„ã€‚æ–‡ä»¶å¥æŸ„å¯ä»¥åœ¨æ–‡ä»¶è¢«é‡å‘½åæˆ–ç§»åŠ¨åä»ç„¶ç”¨äºå¼•ç”¨è¯¥æ–‡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>304</code></td><td><code>open_by_handle_at</code></td><td><code>int open_by_handle_at(int mount_fd, struct file_handle *handle, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé€šè¿‡æ–‡ä»¶å¥æŸ„æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚è¿™ä½¿å¾—å³ä½¿æ–‡ä»¶è¢«é‡å‘½åæˆ–ç§»åŠ¨ï¼Œä¹Ÿå¯ä»¥æ‰“å¼€å®ƒã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>305</code></td><td><code>clock_adjtime</code></td><td><code>int clock_adjtime(clockid_t clkid, struct timex *buf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè°ƒæ•´æŒ‡å®šæ—¶é’Ÿçš„æ—¶é—´ã€‚å®ƒæ¯” <code>adjtimex</code> æ›´é€šç”¨ï¼Œæ”¯æŒå¤šç§æ—¶é’Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>306</code></td><td><code>syncfs</code></td><td><code>int syncfs(int fd);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†æŒ‡å®šæ–‡ä»¶æè¿°ç¬¦æ‰€å±çš„æ–‡ä»¶ç³»ç»Ÿçš„æ‰€æœ‰è„æ•°æ®åŒæ­¥åˆ°ç£ç›˜ã€‚å®ƒæ¯” <code>sync</code> æ›´ç»†ç²’åº¦ï¼ŒåªåŒæ­¥ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>307</code></td><td><code>sendmmsg</code></td><td><code>int sendmmsg(int sockfd, struct mmsghdr *msgvec, unsigned int vlen, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘å¥—æ¥å­—å‘é€å¤šæ¡æ¶ˆæ¯ã€‚å®ƒæ¯”å¾ªç¯è°ƒç”¨ <code>sendmsg</code> æ›´é«˜æ•ˆï¼Œå¯ä»¥ä¸€æ¬¡æ€§å‘é€å¤šæ¡æ¶ˆæ¯ã€‚æˆåŠŸè¿”å›å‘é€çš„æ¶ˆæ¯æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>308</code></td><td><code>setns</code></td><td><code>int setns(int fd, int nstype);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†è°ƒç”¨è¿›ç¨‹ç§»åŠ¨åˆ°æŒ‡å®šçš„å‘½åç©ºé—´ã€‚<code>fd</code> æ˜¯ä¸€ä¸ªå¼•ç”¨å‘½åç©ºé—´çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>nstype</code> æŒ‡å®šå‘½åç©ºé—´çš„ç±»å‹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>309</code></td><td><code>getcpu</code></td><td><code>int getcpu(unsigned *cpu, unsigned *node, struct getcpu_cache *tcache);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è°ƒç”¨çº¿ç¨‹å½“å‰æ­£åœ¨è¿è¡Œçš„ CPU ç¼–å·å’Œ NUMA èŠ‚ç‚¹ç¼–å·ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>310</code></td><td><code>process_vm_readv</code></td><td><code>ssize_t process_vm_readv(pid_t pid, const struct iovec *local_iov, unsigned long liovcnt, const struct iovec *remote_iov, unsigned long riovcnt, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å¦ä¸€ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´è¯»å–æ•°æ®ã€‚å®ƒå°†ç›®æ ‡è¿›ç¨‹çš„å¤šä¸ªä¸è¿ç»­å†…å­˜åŒºåŸŸçš„æ•°æ®è¯»å–åˆ°è°ƒç”¨è¿›ç¨‹çš„å¤šä¸ªä¸è¿ç»­å†…å­˜åŒºåŸŸã€‚æˆåŠŸè¿”å›è¯»å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>311</code></td><td><code>process_vm_writev</code></td><td><code>ssize_t process_vm_writev(pid_t pid, const struct iovec *local_iov, unsigned long liovcnt, const struct iovec *remote_iov, unsigned long riovcnt, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘å¦ä¸€ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´å†™å…¥æ•°æ®ã€‚å®ƒå°†è°ƒç”¨è¿›ç¨‹çš„å¤šä¸ªä¸è¿ç»­å†…å­˜åŒºåŸŸçš„æ•°æ®å†™å…¥ç›®æ ‡è¿›ç¨‹çš„å¤šä¸ªä¸è¿ç»­å†…å­˜åŒºåŸŸã€‚æˆåŠŸè¿”å›å†™å…¥çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>312</code></td><td><code>kcmp</code></td><td><code>int kcmp(pid_t pid1, pid_t pid2, int type, unsigned long idx1, unsigned long idx2);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ¯”è¾ƒä¸¤ä¸ªè¿›ç¨‹çš„å†…æ ¸èµ„æºã€‚<code>type</code> æŒ‡å®šè¦æ¯”è¾ƒçš„èµ„æºç±»å‹ï¼Œä¾‹å¦‚æ–‡ä»¶æè¿°ç¬¦è¡¨æˆ–è™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚æˆåŠŸè¿”å› <code>0</code> æˆ– <code>1</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>313</code></td><td><code>finit_module</code></td><td><code>int finit_module(int fd, const char *param_values, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å·²æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦åŠ è½½ä¸€ä¸ªå†…æ ¸æ¨¡å—ã€‚<code>fd</code> æ˜¯æ¨¡å—æ–‡ä»¶çš„æè¿°ç¬¦ï¼Œ<code>param_values</code> æ˜¯æ¨¡å—å‚æ•°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>314</code></td><td><code>sched_setattr</code></td><td><code>int sched_setattr(pid_t pid, const struct sched_attr *attr, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥å’Œå‚æ•°ã€‚å®ƒæ¯” <code>sched_setscheduler</code> æ›´é€šç”¨ï¼Œæ”¯æŒæ›´çµæ´»çš„è°ƒåº¦ç­–ç•¥ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>315</code></td><td><code>sched_getattr</code></td><td><code>int sched_getattr(pid_t pid, struct sched_attr *attr, unsigned int size, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–è¿›ç¨‹çš„è°ƒåº¦ç­–ç•¥å’Œå‚æ•°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>316</code></td><td><code>renameat2</code></td><td><code>int renameat2(int olddirfd, const char *oldpath, int newdirfd, const char *newpath, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>renameat</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>RENAME_NOREPLACE</code>ï¼ˆå¦‚æœç›®æ ‡æ–‡ä»¶å­˜åœ¨åˆ™ä¸æ›¿æ¢ï¼‰ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>317</code></td><td><code>seccomp</code></td><td><code>int seccomp(unsigned int operation, unsigned int flags, const char *args);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–è·å–å®‰å…¨è®¡ç®—æ¨¡å¼ï¼ˆseccompï¼‰çŠ¶æ€ã€‚å®ƒé™åˆ¶äº†è¿›ç¨‹å¯ä»¥è°ƒç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»è€Œå¢å¼ºå®‰å…¨æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>318</code></td><td><code>getrandom</code></td><td><code>ssize_t getrandom(void *buf, size_t buflen, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»å†…æ ¸çš„åŠ å¯†å®‰å…¨ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ä¸­è·å–éšæœºå­—èŠ‚ã€‚<code>buf</code> ç”¨äºå­˜å‚¨éšæœºæ•°æ®ï¼Œ<code>buflen</code> æŒ‡å®šé•¿åº¦ã€‚æˆåŠŸè¿”å›è·å–çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>319</code></td><td><code>memfd_create</code></td><td><code>int memfd_create(const char *name, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªå†…å­˜æ–‡ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¯¥æ–‡ä»¶åªå­˜åœ¨äºå†…å­˜ä¸­ï¼Œå¯ä»¥è¢«å…¶ä»–è¿›ç¨‹è®¿é—®ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>320</code></td><td><code>kexec_file_load</code></td><td><code>long kexec_file_load(int kernel_fd, int initrd_fd, unsigned long cmdline_len, const char *cmdline_ptr, unsigned long flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»æ–‡ä»¶æè¿°ç¬¦åŠ è½½ä¸€ä¸ªå†…æ ¸é•œåƒï¼Œä»¥ä¾¿åœ¨ä¸é‡å¯ç‰©ç†æœºå™¨çš„æƒ…å†µä¸‹å¯åŠ¨å®ƒã€‚å®ƒæ¯” <code>kexec_load</code> æ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥å¼•ç”¨æ–‡ä»¶ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>321</code></td><td><code>bpf</code></td><td><code>int bpf(int cmd, union bpf_attr *attr, unsigned int size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ“ä½œ BPFï¼ˆBerkeley Packet Filterï¼‰ç¨‹åºå’Œæ˜ å°„ã€‚å®ƒå…è®¸åœ¨å†…æ ¸ä¸­æ‰§è¡Œé«˜æ•ˆçš„ã€æ²™ç›’åŒ–çš„ç¨‹åºï¼Œç”¨äºç½‘ç»œè¿‡æ»¤ã€è·Ÿè¸ªç­‰ã€‚æˆåŠŸè¿”å›å–å†³äº <code>cmd</code> çš„å€¼ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>322</code></td><td><code>execveat</code></td><td><code>int execveat(int dirfd, const char *pathname, char *const argv[], char *const envp[], int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>execve</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ¥å—ä¸€ä¸ªç›®å½•æ–‡ä»¶æè¿°ç¬¦ <code>dirfd</code> ä½œä¸ºç›¸å¯¹è·¯å¾„çš„èµ·ç‚¹ï¼Œå¹¶æ”¯æŒé¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>AT_EMPTY_PATH</code>ã€‚æˆåŠŸæ—¶æ°¸ä¸è¿”å›ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>323</code></td><td><code>userfaultfd</code></td><td><code>int userfaultfd(int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªç”¨æˆ·ç©ºé—´é¡µé¢é”™è¯¯å¤„ç†ç¨‹åºçš„æ–‡ä»¶æè¿°ç¬¦ã€‚å®ƒå…è®¸ç”¨æˆ·ç©ºé—´çš„åº”ç”¨ç¨‹åºå¤„ç†ç”±è‡ªèº«æˆ–å¦ä¸€ä¸ªè¿›ç¨‹äº§ç”Ÿçš„é¡µé¢é”™è¯¯ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>324</code></td><td><code>membarrier</code></td><td><code>int membarrier(int cmd, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨æ‰€æœ‰çº¿ç¨‹ä¸Šæä¾›ä¸€ä¸ªå†…å­˜å±éšœï¼Œä»¥ç¡®ä¿æ‰€æœ‰ CPU çš„å†…å­˜è§†å›¾åŒæ­¥ã€‚è¿™å¯¹äºè·¨çº¿ç¨‹æˆ–è·¨è¿›ç¨‹çš„å†…å­˜ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>325</code></td><td><code>mlock2</code></td><td><code>int mlock2(const void *addr, size_t len, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>mlock</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>MLOCK_ONFAULT</code>ï¼Œå¯ä»¥å»¶è¿Ÿé”å®šï¼Œç›´åˆ°è®¿é—®åˆ°è¯¥é¡µé¢ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>326</code></td><td><code>copy_file_range</code></td><td><code>ssize_t copy_file_range(int fd_in, loff_t *off_in, int fd_out, loff_t *off_out, size_t len, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´å¤åˆ¶æ•°æ®ï¼Œæ— éœ€é€šè¿‡ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºã€‚å®ƒé€šè¿‡å†…æ ¸è¿›è¡Œé›¶æ‹·è´å¤åˆ¶ï¼Œæä¾›äº†éå¸¸é«˜æ•ˆçš„æ–‡ä»¶å¤åˆ¶ã€‚æˆåŠŸè¿”å›å¤åˆ¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>327</code></td><td><code>preadv2</code></td><td><code>ssize_t preadv2(int fd, const struct iovec *iov, unsigned long iovcnt, off_t offset, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>preadv</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>RWF_HIPRI</code>ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰æˆ– <code>RWF_APPEND</code>ã€‚æˆåŠŸè¿”å›è¯»å–çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>328</code></td><td><code>pwritev2</code></td><td><code>ssize_t pwritev2(int fd, const struct iovec *iov, unsigned long iovcnt, off_t offset, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>pwritev</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>RWF_HIPRI</code>ã€‚æˆåŠŸè¿”å›å†™å…¥çš„æ€»å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>329</code></td><td><code>pkey_mprotect</code></td><td><code>int pkey_mprotect(void *addr, size_t len, int prot, int pkey);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>mprotect</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸ä½¿ç”¨å†…å­˜ä¿æŠ¤é”®ï¼ˆ<code>pkey</code>ï¼‰æ¥æ§åˆ¶å†…å­˜è®¿é—®ã€‚è¿™æä¾›äº†æ›´ç»†ç²’åº¦çš„å†…å­˜ä¿æŠ¤ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>330</code></td><td><code>pkey_alloc</code></td><td><code>int pkey_alloc(unsigned int flags, unsigned int access_rights);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ†é…ä¸€ä¸ªæœªä½¿ç”¨çš„å†…å­˜ä¿æŠ¤é”®ã€‚<code>flags</code> å’Œ <code>access_rights</code> æŒ‡å®šé”®çš„å±æ€§ã€‚æˆåŠŸè¿”å›æ–°çš„ä¿æŠ¤é”®ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>331</code></td><td><code>pkey_free</code></td><td><code>int pkey_free(int pkey);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé‡Šæ”¾ä¸€ä¸ªå†…å­˜ä¿æŠ¤é”®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>332</code></td><td><code>statx</code></td><td><code>int statx(int dirfd, const char *pathname, int flags, unsigned int mask, struct statx *statxbuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>stat</code> çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†æ›´å¤šçš„æ–‡ä»¶ä¿¡æ¯ï¼Œå¹¶å…è®¸åœ¨å•ä¸ªè°ƒç”¨ä¸­è·å–å¤šç§å±æ€§ã€‚<code>mask</code> æŒ‡å®šè¦è·å–çš„å±æ€§ï¼Œ<code>statxbuf</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨ç»“æœã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>333</code></td><td><code>io_pgetevents</code></td><td><code>int io_pgetevents(aio_context_t ctx_id, long min_nr, long nr, struct io_event *events, struct timespec *timeout, const sigset_t *sigmask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>io_getevents</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åŸå­æ€§åœ°æ”¹å˜ä¿¡å·æ©ç å¹¶æ£€ç´¢äº‹ä»¶ã€‚è¿™å¯¹äºå¤„ç†ä¿¡å·å’Œå¼‚æ­¥ I&#x2F;O äº‹ä»¶éå¸¸æœ‰ç”¨ã€‚è¿”å›å€¼ä¸ºè·å–çš„äº‹ä»¶æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>334</code></td><td><code>rseq</code></td><td><code>int rseq(struct rseq *rseq, uint32_t rseq_len, int flags, uint32_t sig);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ³¨å†Œæˆ–å–æ¶ˆä¸€ä¸ª <code>rseq</code>ï¼ˆå¯é‡å¯åºåˆ—ï¼‰ç»“æ„ã€‚<code>rseq</code> æ˜¯ä¸€ç§ç”¨äºå®ç°é«˜æ•ˆç”¨æˆ·ç©ºé—´åŸå­æ“ä½œçš„æœºåˆ¶ï¼Œç‰¹åˆ«æ˜¯åœ¨ NUMA ç³»ç»Ÿä¸Šã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>335</code></td><td><code>uretprobe</code></td><td><code>int uretprobe(int type, int arg);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåœ¨ç”¨æˆ·ç©ºé—´çš„å‡½æ•°è¿”å›æ—¶è®¾ç½®æ¢é’ˆã€‚æ­¤è°ƒç”¨å·²è¿‡æ—¶ï¼Œæ¨èä½¿ç”¨ <code>bpf</code>ã€‚</td></tr><tr><td><code>424</code></td><td><code>pidfd_send_signal</code></td><td><code>int pidfd_send_signal(int pidfd, int sig, siginfo_t *info, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘ç”±æ–‡ä»¶æè¿°ç¬¦ <code>pidfd</code> æŒ‡å®šçš„è¿›ç¨‹å‘é€ä¿¡å·ã€‚<code>pidfd</code> æä¾›äº†æ¯”ä¼ ç»Ÿ PID æ›´å¥å£®çš„è¿›ç¨‹å¼•ç”¨æ–¹å¼ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>425</code></td><td><code>io_uring_setup</code></td><td><code>int io_uring_setup(unsigned int entries, struct io_uring_params *params);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºå’Œåˆå§‹åŒ–ä¸€ä¸ª <code>io_uring</code> å®ä¾‹ã€‚<code>entries</code> æŒ‡å®šé˜Ÿåˆ—ä¸­çš„æ¡ç›®æ•°ï¼Œ<code>params</code> æä¾›äº†é¢å¤–çš„å‚æ•°ã€‚<code>io_uring</code> æ˜¯ä¸€ç§é«˜æ€§èƒ½å¼‚æ­¥ I&#x2F;O æ¥å£ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>426</code></td><td><code>io_uring_enter</code></td><td><code>int io_uring_enter(int fd, unsigned int to_submit, unsigned int min_complete, unsigned int flags, sigset_t *sig);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæäº¤ <code>io_uring</code> å®ä¾‹ä¸­çš„è¯·æ±‚ï¼Œå¹¶ç­‰å¾…å·²å®Œæˆçš„è¯·æ±‚ã€‚å®ƒå…è®¸åº”ç”¨ç¨‹åºå°†è¯·æ±‚æ’é˜Ÿå¹¶å¼‚æ­¥åœ°å¤„ç†ç»“æœã€‚æˆåŠŸè¿”å›æäº¤çš„è¯·æ±‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>427</code></td><td><code>io_uring_register</code></td><td><code>int io_uring_register(int fd, unsigned int opcode, const void *arg, unsigned int nr_args);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ³¨å†Œ <code>io_uring</code> å®ä¾‹ä¸­çš„æ–‡ä»¶æè¿°ç¬¦æˆ–ç¼“å†²åŒºï¼Œä»¥æé«˜æ€§èƒ½ã€‚å®ƒå…è®¸å†…æ ¸å¯¹èµ„æºè¿›è¡Œé¢„å¤„ç†ï¼Œä»è€Œå‡å°‘åç»­çš„å¼€é”€ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>428</code></td><td><code>open_tree</code></td><td><code>int open_tree(int dirfd, const char *pathname, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•å­æ ‘çš„å¥æŸ„ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¿™ä½¿å¾—åœ¨ä¸ä½¿ç”¨ <code>chroot</code> çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¹æ–‡ä»¶æ ‘è¿›è¡Œæ“ä½œã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>429</code></td><td><code>move_mount</code></td><td><code>int move_mount(int from_dirfd, const char *from_pathname, int to_dirfd, const char *to_pathname, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºç§»åŠ¨ä¸€ä¸ªæŒ‚è½½ç‚¹ã€‚å®ƒå°†ä¸€ä¸ªæŒ‚è½½ç‚¹ä»ä¸€ä¸ªä½ç½®ç§»åŠ¨åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œè€Œæ— éœ€å¸è½½å’Œé‡æ–°æŒ‚è½½ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>430</code></td><td><code>fsopen</code></td><td><code>int fsopen(const char *fsname, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿå®ä¾‹ã€‚å®ƒè¿”å›ä¸€ä¸ªç”¨äºé…ç½®è¯¥æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶æè¿°ç¬¦ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>431</code></td><td><code>fsconfig</code></td><td><code>int fsconfig(int fd, unsigned int cmd, const char *key, const void *value, int aux);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé…ç½®ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå®ä¾‹ã€‚<code>fd</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿå®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>cmd</code> æŒ‡å®šæ“ä½œç±»å‹ï¼Œå¦‚è®¾ç½®é€‰é¡¹æˆ–æäº¤é…ç½®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>432</code></td><td><code>fsmount</code></td><td><code>int fsmount(int fs_fd, unsigned int flags, unsigned int ms_flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæŒ‚è½½ä¸€ä¸ªå·²é…ç½®çš„æ–‡ä»¶ç³»ç»Ÿå®ä¾‹ã€‚<code>fs_fd</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿå®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>flags</code> æä¾›æŒ‚è½½é€‰é¡¹ã€‚æˆåŠŸè¿”å›æŒ‚è½½çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>433</code></td><td><code>fspick</code></td><td><code>int fspick(int dirfd, const char *path, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»æ–‡ä»¶æ ‘ä¸­é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¿™å¯ä»¥ç”¨äºåœ¨ä¸è¿›è¡Œç¬¦å·é“¾æ¥éå†çš„æƒ…å†µä¸‹è·å–æ–‡ä»¶å¥æŸ„ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>434</code></td><td><code>pidfd_open</code></td><td><code>int pidfd_open(pid_t pid, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºæ‰“å¼€ä¸€ä¸ªè¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ã€‚<code>pid</code> æŒ‡å®šç›®æ ‡è¿›ç¨‹ã€‚<code>pidfd</code> å¯ä»¥ç”¨äºå‘è¯¥è¿›ç¨‹å‘é€ä¿¡å·æˆ–æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå³ä½¿è¿›ç¨‹çš„ PID å‘ç”Ÿå˜åŒ–ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>435</code></td><td><code>clone3</code></td><td><code>int clone3(struct clone_args *cl_args, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>clone</code> çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“æ¥ä¼ é€’å‚æ•°ï¼Œä»è€Œæä¾›äº†æ›´å¥½çš„å¯æ‰©å±•æ€§ã€‚å®ƒç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å­è¿›ç¨‹æˆ–çº¿ç¨‹ã€‚æˆåŠŸè¿”å›å­è¿›ç¨‹çš„ PIDï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>436</code></td><td><code>close_range</code></td><td><code>int close_range(unsigned int first, unsigned int last, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå…³é—­æŒ‡å®šèŒƒå›´å†…çš„æ‰€æœ‰æ–‡ä»¶æè¿°ç¬¦ã€‚å®ƒæ¯”å¾ªç¯è°ƒç”¨ <code>close</code> æ›´é«˜æ•ˆï¼Œå¹¶ä¸”æ˜¯åŸå­æ€§çš„ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>437</code></td><td><code>openat2</code></td><td><code>int openat2(int dirfd, const char *pathname, struct open_how *how, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>openat</code> çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“æ¥ä¼ é€’å‚æ•°ï¼Œä»è€Œæä¾›äº†æ›´çµæ´»çš„æ‰“å¼€é€‰é¡¹ï¼Œå¦‚å¯¹ç¬¦å·é“¾æ¥çš„æ›´ç²¾ç»†æ§åˆ¶ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>438</code></td><td><code>pidfd_getfd</code></td><td><code>int pidfd_getfd(int pidfd, int fd, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä»ç”± <code>pidfd</code> æŒ‡å®šçš„è¿›ç¨‹ä¸­è·å–ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„å‰¯æœ¬ã€‚æˆåŠŸè¿”å›æ–°çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>439</code></td><td><code>faccessat2</code></td><td><code>int faccessat2(int dirfd, const char *pathname, int mode, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>faccessat</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>AT_EACCESS</code>ï¼Œç”¨äºæ ¹æ®æœ‰æ•ˆ UID&#x2F;GID æ£€æŸ¥æƒé™ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>440</code></td><td><code>process_madvise</code></td><td><code>int process_madvise(int pidfd, const struct iovec *iov, size_t iovcnt, int advice, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹å¦ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜åŒºåŸŸæä¾›å»ºè®®ã€‚<code>pidfd</code> å¼•ç”¨ç›®æ ‡è¿›ç¨‹ï¼Œ<code>iov</code> æè¿°å†…å­˜åŒºåŸŸï¼Œ<code>advice</code> æä¾›å»ºè®®ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>441</code></td><td><code>epoll_pwait2</code></td><td><code>int epoll_pwait2(int epfd, struct epoll_event *events, int maxevents, const struct timespec *timeout, const sigset_t *sigmask);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>epoll_pwait</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒä½¿ç”¨ <code>timespec</code> ç»“æ„ä½“æ¥æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼Œä»è€Œæ”¯æŒæ›´é«˜çš„ç²¾åº¦ã€‚è¿”å›å€¼ä¸ºå°±ç»ªäº‹ä»¶çš„æ•°é‡ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>442</code></td><td><code>mount_setattr</code></td><td><code>int mount_setattr(int dirfd, const char *pathname, unsigned int flags, struct mount_attr *uattr, size_t size);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®æˆ–ä¿®æ”¹ä¸€ä¸ªæŒ‚è½½ç‚¹çš„å±æ€§ã€‚å®ƒæ¯” <code>mount</code> æ›´ç»†ç²’åº¦ï¼Œå¯ä»¥å•ç‹¬ä¿®æ”¹æŒ‚è½½å±æ€§ï¼Œå¦‚åªè¯»æˆ–ä¸å¯æ‰§è¡Œã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>443</code></td><td><code>quotactl_fd</code></td><td><code>int quotactl_fd(unsigned int fd, unsigned int cmd, qid_t id, void *addr);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>quotactl</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒé€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ¥å¼•ç”¨æ–‡ä»¶ç³»ç»Ÿã€‚è¿™å¯ä»¥é¿å…è·¯å¾„åè§£æçš„æ½œåœ¨é—®é¢˜ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>444</code></td><td><code>landlock_create_ruleset</code></td><td><code>int landlock_create_ruleset(struct landlock_ruleset_attr *attr, size_t size, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Landlock</code> è§„åˆ™é›†ã€‚<code>Landlock</code> æ˜¯ä¸€ç§ç”¨äºé™åˆ¶è¿›ç¨‹æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™çš„å®‰å…¨æœºåˆ¶ã€‚æˆåŠŸè¿”å›è§„åˆ™é›†çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>445</code></td><td><code>landlock_add_rule</code></td><td><code>int landlock_add_rule(int ruleset_fd, enum landlock_rule_type type, const void *attr, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå‘ä¸€ä¸ª <code>Landlock</code> è§„åˆ™é›†æ·»åŠ è§„åˆ™ã€‚<code>ruleset_fd</code> æ˜¯è§„åˆ™é›†çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œ<code>type</code> æŒ‡å®šè§„åˆ™ç±»å‹ï¼Œ<code>attr</code> æä¾›äº†è§„åˆ™çš„è¯¦ç»†ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>446</code></td><td><code>landlock_restrict_self</code></td><td><code>int landlock_restrict_self(int ruleset_fd, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå°†ä¸€ä¸ª <code>Landlock</code> è§„åˆ™é›†åº”ç”¨åˆ°è°ƒç”¨è¿›ç¨‹ã€‚è¿™ä¼šé™åˆ¶è¿›ç¨‹çš„æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™ï¼Œä¸€æ—¦åº”ç”¨ï¼Œè§„åˆ™é›†å°±æ— æ³•è¢«ä¿®æ”¹ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>447</code></td><td><code>memfd_secret</code></td><td><code>int memfd_secret(unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ›å»ºä¸€ä¸ªç§˜å¯†çš„å†…å­˜æ–‡ä»¶ï¼Œå®ƒæ— æ³•è¢«å…¶ä»–è¿›ç¨‹è®¿é—®ï¼Œå³ä½¿æ˜¯å…·æœ‰é«˜æƒé™çš„è¿›ç¨‹ã€‚è¿™å¯¹äºå­˜å‚¨æ•æ„Ÿæ•°æ®éå¸¸æœ‰ç”¨ã€‚æˆåŠŸè¿”å›æ–‡ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>448</code></td><td><code>process_mrelease</code></td><td><code>int process_mrelease(int pidfd, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºé‡Šæ”¾æŒ‡å®šè¿›ç¨‹çš„èµ„æºï¼Œä½†ä¸ä¼šç»ˆæ­¢è¿›ç¨‹ã€‚<code>pidfd</code> å¼•ç”¨ç›®æ ‡è¿›ç¨‹ã€‚è¿™å¯ä»¥ç”¨äºåœ¨ä¸ç­‰å¾…è¿›ç¨‹å®Œå…¨é€€å‡ºæ—¶å›æ”¶èµ„æºã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>449</code></td><td><code>futex_waitv</code></td><td><code>int futex_waitv(struct futex_waitv *waitv, unsigned int nr_futexes, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>futex</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨ä¸€ä¸ªåŸå­æ“ä½œä¸­ç­‰å¾…å¤šä¸ª futexã€‚è¿™å¯¹äºå®ç°å¤æ‚çš„åŒæ­¥åŸè¯­éå¸¸æœ‰ç”¨ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>450</code></td><td><code>set_mempolicy_home_node</code></td><td><code>int set_mempolicy_home_node(unsigned int start, unsigned int len, unsigned int node);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®ä¸€ä¸ªè¿›ç¨‹çš„â€œå®¶â€NUMA èŠ‚ç‚¹ï¼Œå¹¶å°†å…¶å†…å­˜é¡µç»‘å®šåˆ°è¯¥èŠ‚ç‚¹ã€‚æ­¤è°ƒç”¨å·²è¿‡æ—¶ï¼Œæ¨èä½¿ç”¨ <code>mbind</code>ã€‚</td></tr><tr><td><code>451</code></td><td><code>cachestat</code></td><td><code>int cachestat(int fd, const char *path, const struct statx *stx, unsigned int flags, struct cachestat *result);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–æ–‡ä»¶é¡µé¢ç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯ã€‚<code>fd</code> å’Œ <code>path</code> æŒ‡å®šæ–‡ä»¶ï¼Œ<code>result</code> ç»“æ„ä½“ç”¨äºå­˜å‚¨ç¼“å­˜å‘½ä¸­ã€ä¸¢å¤±ç­‰ä¿¡æ¯ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>452</code></td><td><code>fchmodat2</code></td><td><code>int fchmodat2(int dirfd, const char *pathname, mode_t mode, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>fchmodat</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæä¾›äº†é¢å¤–çš„æ ‡å¿—ï¼Œå¦‚ <code>AT_SYMLINK_NOFOLLOW</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>453</code></td><td><code>map_shadow_stack</code></td><td><code>unsigned long map_shadow_stack(unsigned long addr, unsigned long size, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºä¸ºè¿›ç¨‹åˆ›å»ºä¸€ä¸ªå½±å­æ ˆã€‚å½±å­æ ˆæ˜¯ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œç”¨äºä¿æŠ¤å‡½æ•°è¿”å›åœ°å€ä¸è¢«ç¼“å†²åŒºæº¢å‡ºç­‰æ”»å‡»ç¯¡æ”¹ã€‚æˆåŠŸè¿”å›å½±å­æ ˆçš„åœ°å€ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>454</code></td><td><code>futex_wake</code></td><td><code>int futex_wake(int *uaddr, int nr_wake);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>futex</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸“é—¨ç”¨äºå”¤é†’åœ¨æŒ‡å®š <code>uaddr</code> ä¸Šç­‰å¾…çš„çº¿ç¨‹ã€‚<code>nr_wake</code> æŒ‡å®šè¦å”¤é†’çš„æœ€å¤§çº¿ç¨‹æ•°ã€‚æˆåŠŸè¿”å›å”¤é†’çš„çº¿ç¨‹æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>455</code></td><td><code>futex_wait</code></td><td><code>int futex_wait(int *uaddr, int val);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>futex</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸“é—¨ç”¨äºç­‰å¾…ã€‚å®ƒåœ¨ <code>uaddr</code> ä¸Šç­‰å¾…ï¼Œç›´åˆ°å…¶å€¼ä¸ç­‰äº <code>val</code>ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>456</code></td><td><code>futex_requeue</code></td><td><code>int futex_requeue(int *uaddr, int nr_wake, int *uaddr2, int nr_requeue);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨æ˜¯ <code>futex</code> çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸åœ¨å•ä¸ªåŸå­æ“ä½œä¸­å”¤é†’ä¸€ä¸ª futex ä¸Šçš„çº¿ç¨‹ï¼Œå¹¶å°†å…¶ä½™çº¿ç¨‹é‡æ–°æ’é˜Ÿåˆ°å¦ä¸€ä¸ª futex ä¸Šã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>457</code></td><td><code>statmount</code></td><td><code>int statmount(const char *pathname, struct statmount *statbuf);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–ä¸€ä¸ªæŒ‚è½½ç‚¹çš„çŠ¶æ€ä¿¡æ¯ã€‚æ­¤è°ƒç”¨å·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>458</code></td><td><code>listmount</code></td><td><code>int listmount(const char *pathname, void *buf, size_t bufsize);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ—å‡ºä¸€ä¸ªæŒ‚è½½ç‚¹ä¸‹çš„æ‰€æœ‰å­æŒ‚è½½ç‚¹ã€‚æ­¤è°ƒç”¨å·²è¿‡æ—¶ã€‚</td></tr><tr><td><code>459</code></td><td><code>lsm_get_self_attr</code></td><td><code>int lsm_get_self_attr(const char *attr, void *value, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè·å–å½“å‰è¿›ç¨‹çš„ Linux å®‰å…¨æ¨¡å—ï¼ˆLSMï¼‰å±æ€§ã€‚<code>attr</code> æŒ‡å®šå±æ€§åç§°ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>460</code></td><td><code>lsm_set_self_attr</code></td><td><code>int lsm_set_self_attr(const char *attr, const void *value, size_t len, int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºè®¾ç½®å½“å‰è¿›ç¨‹çš„ Linux å®‰å…¨æ¨¡å—ï¼ˆLSMï¼‰å±æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>461</code></td><td><code>lsm_list_modules</code></td><td><code>int lsm_list_modules(void *buf, size_t len);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºåˆ—å‡ºæ‰€æœ‰å·²å¯ç”¨çš„ Linux å®‰å…¨æ¨¡å—ï¼ˆLSMï¼‰ã€‚<code>buf</code> ç”¨äºå­˜å‚¨æ¨¡å—åç§°åˆ—è¡¨ã€‚æˆåŠŸè¿”å›åˆ—è¡¨çš„å¤§å°ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr><tr><td><code>462</code></td><td><code>mseal</code></td><td><code>int mseal(void *addr, size_t len, unsigned int flags);</code></td><td>æ­¤ç³»ç»Ÿè°ƒç”¨ç”¨äºå¯¹ä¸€ä¸ªå†…å­˜æ˜ å°„åŒºåŸŸè¿›è¡Œå¯†å°ã€‚ä¸€æ—¦å¯†å°ï¼Œè¯¥åŒºåŸŸçš„æŸäº›å±æ€§ï¼ˆå¦‚å¯å†™æ€§ï¼‰å°±æ— æ³•å†æ›´æ”¹ï¼Œä»è€Œå¢å¼ºå®‰å…¨æ€§ã€‚æˆåŠŸè¿”å› <code>0</code>ï¼Œå¤±è´¥è¿”å› <code>-1</code>ã€‚</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;è¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è°ƒç”¨å·å­˜æ”¾åœ¨ &lt;code&gt;%rax&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‰å…­ä¸ªå‚æ•°ä¾æ¬¡åœ¨ &lt;code&gt;%rdi&lt;/code&gt;, &lt;code&gt;%rsi&lt;/code&gt;, &lt;code&gt;%rdx&lt;/cod</summary>
      
    
    
    
    
    <category term="Linux" scheme="https://redstone6835.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hello worldï¼</title>
    <link href="https://redstone6835.github.io/2025/11/12/Hello-world%EF%BC%81/"/>
    <id>https://redstone6835.github.io/2025/11/12/Hello-world%EF%BC%81/</id>
    <published>2025-11-12T06:57:12.000Z</published>
    <updated>2025-11-15T18:11:19.647Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><p>è¿™æ˜¯ <strong>Markdown æ¸²æŸ“æµ‹è¯•æ–‡æ¡£</strong>ï¼Œç”¨äºéªŒè¯ï¼š</p><ul><li>æ™®é€šæ–‡æœ¬æ˜¯å¦æ˜¾ç¤ºæ­£å¸¸</li><li>å„ç§è¯­æ³•ï¼ˆæ ‡é¢˜ã€åˆ—è¡¨ã€é“¾æ¥ã€å›¾ç‰‡ã€ä»£ç ã€è¡¨æ ¼ç­‰ï¼‰</li><li>æ˜¯å¦æ”¯æŒæ•°å­¦å…¬å¼ï¼ˆéœ€å¯ç”¨ <code>hexo-renderer-markdown-it</code> + <code>markdown-it-katex</code> æˆ– <code>mathjax</code>ï¼‰</li></ul><hr><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><h3 id="1-æ–‡æœ¬æ ¼å¼"><a href="#1-æ–‡æœ¬æ ¼å¼" class="headerlink" title="1. æ–‡æœ¬æ ¼å¼"></a>1. æ–‡æœ¬æ ¼å¼</h3><p>æ™®é€šæ–‡å­—<br><strong>åŠ ç²—æ–‡å­—</strong><br><em>æ–œä½“æ–‡å­—</em><br>~åˆ é™¤çº¿æ–‡å­—~~<br>&#x3D;&#x3D;é«˜äº®æ–‡å­—&#x3D;&#x3D;ï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰</p><blockquote><p>è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨åŒºå—ï¼Œå¯ä»¥ç”¨äºå¼ºè°ƒä¸€å¥è¯ã€‚</p></blockquote><hr><h3 id="2-æ— åºä¸æœ‰åºåˆ—è¡¨"><a href="#2-æ— åºä¸æœ‰åºåˆ—è¡¨" class="headerlink" title="2. æ— åºä¸æœ‰åºåˆ—è¡¨"></a>2. æ— åºä¸æœ‰åºåˆ—è¡¨</h3><h4 id="æ— åºåˆ—è¡¨"><a href="#æ— åºåˆ—è¡¨" class="headerlink" title="æ— åºåˆ—è¡¨"></a>æ— åºåˆ—è¡¨</h4><ul><li>è‹¹æœ ğŸ</li><li>é¦™è•‰ ğŸŒ</li><li>è¥¿ç“œ ğŸ‰</li></ul><h4 id="æœ‰åºåˆ—è¡¨"><a href="#æœ‰åºåˆ—è¡¨" class="headerlink" title="æœ‰åºåˆ—è¡¨"></a>æœ‰åºåˆ—è¡¨</h4><ol><li>ç¬¬ä¸€é¡¹</li><li>ç¬¬äºŒé¡¹</li><li>ç¬¬ä¸‰é¡¹</li></ol><hr><h3 id="3-ä»£ç å—ä¸è¯­æ³•é«˜äº®"><a href="#3-ä»£ç å—ä¸è¯­æ³•é«˜äº®" class="headerlink" title="3. ä»£ç å—ä¸è¯­æ³•é«˜äº®"></a>3. ä»£ç å—ä¸è¯­æ³•é«˜äº®</h3><h4 id="è¡Œå†…ä»£ç "><a href="#è¡Œå†…ä»£ç " class="headerlink" title="è¡Œå†…ä»£ç "></a>è¡Œå†…ä»£ç </h4><p>åœ¨è¡Œå†…å¯ä»¥ä½¿ç”¨åå¼•å·ï¼š<code>printf(&quot;Hello World&quot;);</code></p><h4 id="å¤šè¡Œä»£ç "><a href="#å¤šè¡Œä»£ç " class="headerlink" title="å¤šè¡Œä»£ç "></a>å¤šè¡Œä»£ç </h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Hello Hexo Markdown!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-è¡¨æ ¼"><a href="#4-è¡¨æ ¼" class="headerlink" title="4. è¡¨æ ¼"></a>4. è¡¨æ ¼</h3><table><thead><tr><th>å§“å</th><th>å¹´é¾„</th><th>çˆ±å¥½</th></tr></thead><tbody><tr><td>å°æ˜</td><td>18</td><td>ç¯®çƒ</td></tr><tr><td>å°çº¢</td><td>20</td><td>é˜…è¯»</td></tr><tr><td>å°åˆš</td><td>22</td><td>ç¼–ç¨‹</td></tr></tbody></table><hr><h3 id="5-é“¾æ¥ä¸å›¾ç‰‡"><a href="#5-é“¾æ¥ä¸å›¾ç‰‡" class="headerlink" title="5. é“¾æ¥ä¸å›¾ç‰‡"></a>5. é“¾æ¥ä¸å›¾ç‰‡</h3><p><a href="https://hexo.io/">è®¿é—® Hexo å®˜ç½‘</a></p><p><img src="https://picsum.photos/600/200" alt="ç¤ºä¾‹å›¾ç‰‡"></p><hr><h3 id="6-æ•°å­¦å…¬å¼"><a href="#6-æ•°å­¦å…¬å¼" class="headerlink" title="6. æ•°å­¦å…¬å¼"></a>6. æ•°å­¦å…¬å¼</h3><h4 id="è¡Œå†…å…¬å¼"><a href="#è¡Œå†…å…¬å¼" class="headerlink" title="è¡Œå†…å…¬å¼"></a>è¡Œå†…å…¬å¼</h4><p>è¿™æ˜¯è¡Œå†…å…¬å¼ï¼š$E &#x3D; mc^2$ã€‚</p><h4 id="ç‹¬ç«‹å…¬å¼ï¼ˆå—çº§å…¬å¼ï¼‰"><a href="#ç‹¬ç«‹å…¬å¼ï¼ˆå—çº§å…¬å¼ï¼‰" class="headerlink" title="ç‹¬ç«‹å…¬å¼ï¼ˆå—çº§å…¬å¼ï¼‰"></a>ç‹¬ç«‹å…¬å¼ï¼ˆå—çº§å…¬å¼ï¼‰</h4><p>$$<br>\int_{0}^{\infty} e^{-x^2} dx &#x3D; \frac{\sqrt{\pi}}{2}<br>$$</p><p>$$<br>a^2 + b^2 &#x3D; c^2<br>$$</p><blockquote><p>âš ï¸ æ³¨æ„ï¼šè¦æ˜¾ç¤ºæ•°å­¦å…¬å¼ï¼Œä½ éœ€è¦å¯ç”¨ <strong>MathJax</strong> æˆ– <strong>KaTeX</strong>ã€‚<br>ä¾‹å¦‚åœ¨ <code>_config.yml</code>ï¼ˆæˆ–ä¸»é¢˜é…ç½®ï¼‰ä¸­å¼€å¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">engine:</span> <span class="string">mathjax</span></span><br></pre></td></tr></table></figure></blockquote><hr><h3 id="7-å¼•ç”¨ä¸æç¤ºæ¡†ï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰"><a href="#7-å¼•ç”¨ä¸æç¤ºæ¡†ï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰" class="headerlink" title="7. å¼•ç”¨ä¸æç¤ºæ¡†ï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰"></a>7. å¼•ç”¨ä¸æç¤ºæ¡†ï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰</h3><blockquote><p>ğŸ’¡ æç¤ºï¼šHexo å¯ä»¥ç”¨æ¥å†™æŠ€æœ¯ç¬”è®°ã€æ•°å­¦åšå®¢ã€è¯»ä¹¦ç¬”è®°ç­‰ã€‚</p></blockquote><blockquote><p>âš ï¸ è­¦å‘Šï¼šç”Ÿæˆé™æ€æ–‡ä»¶åè®°å¾—æ‰§è¡Œ <code>hexo clean &amp;&amp; hexo g</code>ã€‚</p></blockquote><hr><h3 id="8-åˆ†éš”çº¿ä¸è„šæ³¨"><a href="#8-åˆ†éš”çº¿ä¸è„šæ³¨" class="headerlink" title="8. åˆ†éš”çº¿ä¸è„šæ³¨"></a>8. åˆ†éš”çº¿ä¸è„šæ³¨</h3><hr><p>è¿™æ˜¯ä¸€ä¸ªè„šæ³¨ç¤ºä¾‹<a href="%E8%BF%99%E6%98%AF%E8%84%9A%E6%B3%A8%E7%9A%84%E5%86%85%E5%AE%B9%E3%80%82">^1</a>ã€‚</p><hr><h3 id="9-åµŒå…¥-HTMLï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰"><a href="#9-åµŒå…¥-HTMLï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰" class="headerlink" title="9. åµŒå…¥ HTMLï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰"></a>9. åµŒå…¥ HTMLï¼ˆéƒ¨åˆ†ä¸»é¢˜æ”¯æŒï¼‰</h3><p align="center">  <b>è¿™æ˜¯åµŒå…¥çš„ HTML ç¤ºä¾‹</b><br>  <i>å¯ä»¥ç”¨äºå±…ä¸­å†…å®¹æˆ–è‡ªå®šä¹‰æ ·å¼</i></p><hr><h3 id="âœ…-æ€»ç»“"><a href="#âœ…-æ€»ç»“" class="headerlink" title="âœ… æ€»ç»“"></a>âœ… æ€»ç»“</h3><p>è¿™ç¯‡æ–‡ç« å±•ç¤ºäº†ä»¥ä¸‹å†…å®¹ï¼š</p><table><thead><tr><th>åŠŸèƒ½</th><th>æ˜¯å¦æµ‹è¯•</th></tr></thead><tbody><tr><td>æ–‡æœ¬æ ¼å¼</td><td>âœ…</td></tr><tr><td>åˆ—è¡¨</td><td>âœ…</td></tr><tr><td>ä»£ç é«˜äº®</td><td>âœ…</td></tr><tr><td>å›¾ç‰‡ä¸é“¾æ¥</td><td>âœ…</td></tr><tr><td>è¡¨æ ¼</td><td>âœ…</td></tr><tr><td>æ•°å­¦å…¬å¼</td><td>âœ…</td></tr><tr><td>HTML</td><td>âœ…</td></tr></tbody></table><p>æ­å–œ ğŸ‰<br>å¦‚æœä½ çš„é¡µé¢æ¸²æŸ“æ­£ç¡®ï¼Œè¯´æ˜ Hexo çš„ Markdown è§£æå™¨é…ç½®æ˜¯æ­£å¸¸çš„ï¼</p><hr>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸€çº§æ ‡é¢˜&quot;&gt;&lt;a href=&quot;#ä¸€çº§æ ‡é¢˜&quot; class=&quot;headerlink&quot; title=&quot;ä¸€çº§æ ‡é¢˜&quot;&gt;&lt;/a&gt;ä¸€çº§æ ‡é¢˜&lt;/h1&gt;&lt;p&gt;è¿™æ˜¯ &lt;strong&gt;Markdown æ¸²æŸ“æµ‹è¯•æ–‡æ¡£&lt;/strong&gt;ï¼Œç”¨äºéªŒè¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ™®é€šæ–‡æœ¬æ˜¯å¦æ˜¾</summary>
      
    
    
    
    
  </entry>
  
</feed>
